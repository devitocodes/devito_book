<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Finite Difference Computing with PDEs - A Modern Software Approach">
<meta name="keywords" content="vibration ODE,oscillations,mechanical vibrations,period (of oscillations),frequency (of oscillations),Hz (unit),mesh finite differences,mesh function,centered difference,finite differences centered,vectorization,test function,pytest,nose,verification hand calculations,unit testing,verification polynomial solutions,verification convergence rates,slope marker (in convergence plots),making movies,animation,WebM (video format),Ogg (video format),MP4 (video format),Flash (video format),video formats,HTML5 video tag,error global,stability criterion,phase plane plot,mechanical energy,energy principle,forward-backward Euler-Cromer scheme,Euler-Cromer scheme,symplectic scheme,Stoermer-Verlet algorithm,staggered mesh,staggered Euler-Cromer scheme,alternating mesh,nonlinear restoring force,nonlinear spring,forced vibrations,geometric mean,averaging geometric,DOF (degree of freedom),resonance,waves on a string,wave equation 1D,wave equation 1D, finite difference method,mesh finite differences,stencil 1D wave equation,mesh function,wave equation 1D, implementation,callback function,verification polynomial solution,nose,pytest,unit testing,test function,closure,vectorization,parallelism,scalar code,vectorization,array computing,array slices,slice,lambda function (Python),Neumann conditions,Dirichlet conditions,homogeneous Neumann conditions,homogeneous Dirichlet conditions,boundary conditions Neumann,boundary conditions Dirichlet,stencil Neumann boundary,index set notation,geometric mean,arithmetic mean,harmonic average,averaging geometric,averaging arithmetic,averaging harmonic,radiation condition,open boundary condition,boundary condition open (radiation),periodic boundary conditions,boundary conditions periodic,wave equation 1D, analytical properties,Fourier series,Fourier transform,discrete Fourier transform,wave equation 1D, exact numerical solution,Courant number,stability criterion,wave equation 1D, stability,wave equation 2D, implementation,index set notation,3D visualization,visualization of 2D scalar fields,Gnuplot,Mayavi,diffusion equation 1D,heat equation,diffusion coefficient,diffusion equation diffusion coefficient,diffusion equation stationary solution,stationary solution,Laplace equation,diffusion equation  1D, explicit scheme,diffusion equation  1D, initial boundary value problem,diffusion equation  1D, initial condition,diffusion equation  1D, boundary condition,diffusion equation source term,explicit discretization methods,diffusion equation  1D, Forward Euler scheme,domain,mesh points,mesh function,forward difference approximation,central difference approximation,diffusion equation  1D, discrete equations,diffusion equation  1D, Fourier number,diffusion equation  1D, mesh Fourier number,dimensionless number,diffusion equation  1D, implementation (FE),diffusion equation  1D, verification (FE),diffusion equation  1D, numerical experiments,diffusion equation  1D, implicit schemes,diffusion equation  1D, verification (BE),diffusion equation  1D, tridiagonal matrix,diffusion equation  1D, Crank-Nicolson scheme,diffusion equation  1D, verification (CN),diffusion equation  1D, theta rule,amplification factor,diffusion coefficient non-constant,diffusion equation  1D, Implementation,diffusion equation stationary solution,diffusion coefficient  piecewise constant,diffusion equation  implementation,diffusion equation axi-symmetric diffusion,diffusion equation spherically-symmetric diffusion,diffusion equation 2D,diffusion equation 2D, numbering of mesh points,diffusion equation 2D, sparse matrix,diffusion equation 2D, banded matrix,diffusion equation 2D, implementation,diffusion equation 2D, verification (exact num. sol.),diffusion equation 2D, verification (conv. rates),diffusion equation 2D, implementation (sparse),Jacobi method,relaxation,Gauss-Seidel method,SOR method,red-black numbering,LU factorization,Cholesky factorization,conjugate gradient method,preconditioning,random walk,vectorization,seed (random numbers),verification,diffusion limit of random walk,interrupt a program by Ctrl+c,stochastic difference equation,stochastic ODE,Fokker-Planck equation,Wiener process,energy estimates (diffusion),Richardson iteration,preconditioning,upwind difference,linearization explicit time integration,linearization,Picard iteration,successive substitutions,fixed-point iteration,linearization Picard iteration,linearization successive substitutions,linearization fixed-point iteration,stopping criteria (nonlinear problems),single Picard iteration technique,relaxation (nonlinear equations),stopping criteria (nonlinear problems),continuation method,operator splitting,splitting ODEs,fractional step methods,Strang splitting,continuation method,truncation error general,finite differences backward,truncation error Backward Euler scheme,finite differences forward,truncation error Forward Euler scheme,finite differences centered,truncation error Crank-Nicolson scheme,truncation error table of formulas,decay ODE,correction terms,truncation error correction terms,verification,Cython,declaration of variables in Cython,C extension module,wrapper code,Fortran subroutine,row-major ordering,column-major ordering,Fortran array storage,C/Python array storage">

<title>Finite Difference Computing with PDEs - A Modern Software Approach</title>

<!-- Bootstrap style: bootswatch_readable -->
<link href="http://netdna.bootstrapcdn.com/bootswatch/3.1.1/readable/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }

/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}

/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:64px;      /* fixed header height for style bootswatch_readable */
  margin:-64px 0 0; /* negative fixed header height */
}
</style>



<!-- Tools for embedded Bokeh plots -->
<link rel="stylesheet"
      href="http://cdn.pydata.org/bokeh/release/bokeh-0.9.0.min.css"
      type="text/css" />
<script type="text/javascript"
	src="http://cdn.pydata.org/bokeh/release/bokeh-0.9.0.min.js">
</script>
<script type="text/javascript">
  Bokeh.set_log_level("info");
</script>


</head>

<!-- tocinfo
{'highest level': 0,
 'sections': [('Table of contents',
               0,
               'table_of_contents',
               'table_of_contents'),
              (u'Preface', 0, u'ch:preface', u'ch:preface'),
              (u'Why finite differences?', 3, None, '___sec1'),
              (u'Simplify, understand, generalize', 3, None, '___sec2'),
              (u'Constructive mathematics', 3, None, '___sec3'),
              (u'All nuts and bolts', 3, None, '___sec4'),
              (u'Python as programming language', 3, None, '___sec5'),
              (u'Program verification', 3, None, '___sec6'),
              (u'Vectorized code', 3, None, '___sec7'),
              (u'Analysis via exact solutions of discrete equations',
               3,
               None,
               '___sec8'),
              (u'Code-inspired mathematical notation', 3, None, '___sec9'),
              (u'Limited scope', 3, None, '___sec10'),
              (u'Focus on wave phenomena', 3, None, '___sec11'),
              (u'Independent chapters', 3, None, '___sec12'),
              (u'Supplementary materials', 3, None, '___sec13'),
              (u'Acknowledgments', 3, None, '___sec14'),
              (u'Vibration ODEs', 0, u'ch:vib', u'ch:vib'),
              (u'Finite difference discretization',
               1,
               u'vib:model1',
               u'vib:model1'),
              (u'A basic model for vibrations', 2, None, '___sec17'),
              (u'A centered finite difference scheme',
               2,
               u'vib:ode1:fdm',
               u'vib:ode1:fdm'),
              (u'Step 1: Discretizing the domain', 3, None, '___sec19'),
              (u'Step 2: Fulfilling the equation at discrete time points',
               3,
               None,
               '___sec20'),
              (u'Step 3: Replacing derivatives by finite differences',
               3,
               None,
               '___sec21'),
              (u'Step 4: Formulating a recursive algorithm',
               3,
               None,
               '___sec22'),
              (u'Computing the first step', 3, None, '___sec23'),
              (u'The computational algorithm', 3, None, '___sec24'),
              (u'Operator notation', 3, None, '___sec25'),
              (u'Implementation', 1, u'vib:impl1', u'vib:impl1'),
              (u'Making a solver function',
               2,
               u'vib:impl1:solver',
               u'vib:impl1:solver'),
              (u'Computing $u^{\\prime}$', 3, None, '___sec28'),
              (u'Verification', 2, u'vib:ode1:verify', u'vib:ode1:verify'),
              (u'Manual calculation', 3, None, '___sec30'),
              (u'Testing very simple polynomial solutions',
               3,
               None,
               '___sec31'),
              (u'Checking convergence rates', 3, None, '___sec32'),
              (u'Visualizing convergence rates with slope markers',
               3,
               None,
               '___sec33'),
              (u'Scaled model', 2, None, '___sec34'),
              (u'Visualization of long time simulations',
               1,
               u'vib:ode1:longseries',
               u'vib:ode1:longseries'),
              (u'Using a moving plot window', 2, None, '___sec36'),
              (u'Making animations', 2, u'vib:ode1:anim', u'vib:ode1:anim'),
              (u'Producing standard video formats', 3, None, '___sec38'),
              (u'Playing PNG files in a web browser', 3, None, '___sec39'),
              (u'Making animated GIF files', 3, None, '___sec40'),
              (u'Using Bokeh to compare graphs', 2, None, '___sec41'),
              (u'Using a line-by-line ascii plotter', 2, None, '___sec42'),
              (u'Empirical analysis of the solution',
               2,
               u'vib:ode1:empirical',
               u'vib:ode1:empirical'),
              (u'Analysis of the numerical scheme',
               1,
               u'vib:ode1:analysis',
               u'vib:ode1:analysis'),
              (u'Deriving a solution of the numerical scheme',
               2,
               u'vib:ode1:analysis:solderiv',
               u'vib:ode1:analysis:solderiv'),
              (u'The error in the numerical frequency',
               2,
               u'vib:ode1:analysis:numfreq',
               u'vib:ode1:analysis:numfreq'),
              (u'Empirical convergence rates and adjusted $\\omega$',
               2,
               None,
               '___sec47'),
              (u'Exact discrete solution',
               2,
               u'vib:ode1:analysis:sol',
               u'vib:ode1:analysis:sol'),
              (u'Convergence',
               2,
               u'vib:ode1:analysis:conv',
               u'vib:ode1:analysis:conv'),
              (u'The global error', 2, None, '___sec50'),
              (u'Stability', 2, None, '___sec51'),
              (u'About the accuracy at the stability limit',
               2,
               None,
               '___sec52'),
              (u'Alternative schemes based on 1st-order equations',
               1,
               u'vib:model2x2',
               u'vib:model2x2'),
              (u'The Forward Euler scheme', 2, None, '___sec54'),
              (u'The Backward Euler scheme', 2, None, '___sec55'),
              (u'The Crank-Nicolson scheme',
               2,
               u'vib:undamped:CN',
               u'vib:undamped:CN'),
              (u'Comparison of schemes',
               2,
               u'vib:model2x2:compare',
               u'vib:model2x2:compare'),
              (u'Runge-Kutta methods', 2, None, '___sec58'),
              (u'Analysis of the Forward Euler scheme', 2, None, '___sec59'),
              (u'Energy considerations',
               1,
               u'vib:model1:energy',
               u'vib:model1:energy'),
              (u'Derivation of the energy expression',
               2,
               u'vib:model1:energy:expr',
               u'vib:model1:energy:expr'),
              (u'Energy of the exact solution', 3, None, '___sec62'),
              (u'Growth of energy in the Forward Euler scheme',
               3,
               None,
               '___sec63'),
              (u'An error measure based on energy',
               2,
               u'vib:model1:energy:measure',
               u'vib:model1:energy:measure'),
              (u'The Euler-Cromer method',
               1,
               u'vib:model2x2:EulerCromer',
               u'vib:model2x2:EulerCromer'),
              (u'Forward-backward discretization', 2, None, '___sec66'),
              (u'Equivalence with the scheme for the second-order ODE',
               2,
               u'vib:model2x2:EulerCromer:equiv',
               u'vib:model2x2:EulerCromer:equiv'),
              (u'Implementation',
               2,
               u'vib:model2x2:EulerCromer:impl',
               u'vib:model2x2:EulerCromer:impl'),
              (u'Solver function', 3, None, '___sec69'),
              (u'Verification', 3, None, '___sec70'),
              (u'Using Odespy', 3, None, '___sec71'),
              (u'Convergence rates', 3, None, '___sec72'),
              (u'The Stoermer-Verlet algorithm',
               2,
               u'vib:model2x2:StormerVerlet',
               u'vib:model2x2:StormerVerlet'),
              (u'Staggered mesh', 1, None, '___sec74'),
              (u'The Euler-Cromer scheme on a staggered mesh',
               2,
               u'vib:model2x2:staggered',
               u'vib:model2x2:staggered'),
              (u'Implementation of the scheme on a staggered mesh',
               2,
               None,
               '___sec76'),
              (u'Implementation with integer indices', 3, None, '___sec77'),
              (u'Implementation with half-integer indices',
               3,
               None,
               '___sec78'),
              (u'Exercises and Problems', 1, None, '___sec79'),
              (u'Problem 1.1: Use linear/quadratic functions for verification',
               2,
               u'vib:exer:undamped:verify:linquad',
               u'vib:exer:undamped:verify:linquad'),
              (u'Exercise 1.2: Show linear growth of the phase with time',
               2,
               u'vib:exer:phase:err:growth',
               u'vib:exer:phase:err:growth'),
              (u'Exercise 1.3: Improve the accuracy by adjusting the frequency',
               2,
               u'vib:exer:w:adjust',
               u'vib:exer:w:adjust'),
              (u'Exercise 1.4: See if adaptive methods improve the phase error',
               2,
               u'vib:exer:undamped:adaptive',
               u'vib:exer:undamped:adaptive'),
              (u'Exercise 1.5: Use a Taylor polynomial to compute $u^1$',
               2,
               u'vib:exer:step4b:alt',
               u'vib:exer:step4b:alt'),
              (u'Problem 1.6: Derive and investigate the velocity Verlet method',
               2,
               None,
               '___sec85'),
              (u'Problem 1.7: Find the minimal resolution of an oscillatory function',
               2,
               u'vib:exer:wdt:limit',
               u'vib:exer:wdt:limit'),
              (u'Exercise 1.8: Visualize the accuracy of finite differences for a cosine function',
               2,
               u'vib:exer:fd:exp:plot',
               u'vib:exer:fd:exp:plot'),
              (u'Exercise 1.9: Verify convergence rates of the error in energy',
               2,
               u'vib:exer:energy:convrate',
               u'vib:exer:energy:convrate'),
              (u'Exercise 1.10: Use linear/quadratic functions for verification',
               2,
               u'vib:exer:verify:gen:linear',
               u'vib:exer:verify:gen:linear'),
              (u'Exercise 1.11: Use an exact discrete solution for verification',
               2,
               u'vib:exer:discrete:omega',
               u'vib:exer:discrete:omega'),
              (u'Exercise 1.12: Use analytical solution for convergence rate tests',
               2,
               u'vib:exer:conv:rate',
               u'vib:exer:conv:rate'),
              (u'Exercise 1.13: Investigate the amplitude errors of many solvers',
               2,
               u'vib:exer:undamped:odespy',
               u'vib:exer:undamped:odespy'),
              (u'Problem 1.14: Minimize memory usage of a simple vibration solver',
               2,
               u'vib:exer:memsave0',
               u'vib:exer:memsave0'),
              (u'Problem 1.15: Minimize memory usage of a general vibration solver',
               2,
               u'vib:exer:memsave',
               u'vib:exer:memsave'),
              (u'Exercise 1.16: Implement the Euler-Cromer scheme for the generalized model',
               2,
               u'vib:exer:EC_vs_centered',
               u'vib:exer:EC_vs_centered'),
              (u'Problem 1.17: Interpret $[D_tD_t u]^n$ as a forward-backward difference',
               2,
               u'vib:exer:DtDt:asDtpDtm',
               u'vib:exer:DtDt:asDtpDtm'),
              (u'Exercise 1.18: Analysis of the Euler-Cromer scheme',
               2,
               u'vib:exer:EulerCromer:analysis',
               u'vib:exer:EulerCromer:analysis'),
              (u'Generalization: damping, nonlinearities, and excitation',
               1,
               u'vib:model2',
               u'vib:model2'),
              (u'A centered scheme for linear damping',
               2,
               u'vib:ode2:fdm:flin',
               u'vib:ode2:fdm:flin'),
              (u'A centered scheme for quadratic damping',
               2,
               u'vib:ode2:fdm:fquad',
               u'vib:ode2:fdm:fquad'),
              (u'A forward-backward discretization of the quadratic damping term',
               2,
               None,
               '___sec101'),
              (u'Implementation', 2, u'vib:ode2:solver', u'vib:ode2:solver'),
              (u'Verification', 2, u'vib:ode2:verify', u'vib:ode2:verify'),
              (u'Constant solution', 3, None, '___sec104'),
              (u'Linear solution', 3, None, '___sec105'),
              (u'Quadratic solution', 3, None, '___sec106'),
              (u'Catching bugs', 3, None, '___sec107'),
              (u'Visualization', 2, u'vib:ode2:viz', u'vib:ode2:viz'),
              (u'User interface', 2, u'vib:ode2:ui', u'vib:ode2:ui'),
              (u'The Euler-Cromer scheme for the generalized model',
               2,
               u'vib:ode2:EulerCromer',
               u'vib:ode2:EulerCromer'),
              (u'The Stoermer-Verlet algorithm for the generalized model',
               2,
               u'vib:model2x2:gen:StormerVerlet',
               u'vib:model2x2:gen:StormerVerlet'),
              (u'A staggered Euler-Cromer scheme for a generalized model',
               2,
               u'vib:ode2:staggered',
               u'vib:ode2:staggered'),
              (u'The PEFRL 4th-order accurate algorithm',
               2,
               u'vib:ode2:PEFRL',
               u'vib:ode2:PEFRL'),
              (u'Exercises and Problems', 1, None, '___sec114'),
              (u'Exercise 1.19: Implement the solver via classes',
               2,
               u'vib:exer:gen:class',
               u'vib:exer:gen:class'),
              (u'Problem 1.20: Use a backward difference for the damping term',
               2,
               u'vib:exer:quad:damping:bw',
               u'vib:exer:quad:damping:bw'),
              (u'Exercise 1.21: Use the forward-backward scheme with quadratic damping',
               2,
               u'vib:exer:quad:damping:fwbw',
               u'vib:exer:quad:damping:fwbw'),
              (u'Applications of vibration models',
               1,
               u'vib:app',
               u'vib:app'),
              (u'Oscillating mass attached to a spring',
               2,
               u'vib:app:mass_spring',
               u'vib:app:mass_spring'),
              (u'Scaling', 3, None, '___sec120'),
              (u'The physics', 3, None, '___sec121'),
              (u'General mechanical vibrating system',
               2,
               u'vib:app:mass_gen',
               u'vib:app:mass_gen'),
              (u'Scaling', 3, None, '___sec123'),
              (u'A sliding mass attached to a spring',
               2,
               u'vib:app:mass_sliding',
               u'vib:app:mass_sliding'),
              (u'A jumping washing machine',
               2,
               u'vib:app:washmach',
               u'vib:app:washmach'),
              (u'Motion of a pendulum',
               2,
               u'vib:app:pendulum',
               u'vib:app:pendulum'),
              (u'Simple pendulum', 3, None, '___sec127'),
              (u'Physical pendulum', 3, None, '___sec128'),
              (u'Dynamic free body diagram during pendulum motion',
               2,
               u'vib:app:pendulum_bodydia',
               u'vib:app:pendulum_bodydia'),
              (u'Writing the solver', 3, None, '___sec130'),
              (u'Drawing the free body diagram', 3, None, '___sec131'),
              (u'Making the animated free body diagram',
               3,
               None,
               '___sec132'),
              (u'Motion of an elastic pendulum',
               2,
               u'vib:app:pendulum_elastic',
               u'vib:app:pendulum_elastic'),
              (u'Remarks about an elastic vs a non-elastic pendulum',
               3,
               None,
               '___sec134'),
              (u'Initial conditions', 3, None, '___sec135'),
              (u'The complete ODE problem', 3, None, '___sec136'),
              (u'Scaling', 3, None, '___sec137'),
              (u'Remark on the non-elastic limit', 3, None, '___sec138'),
              (u'Vehicle on a bumpy road',
               2,
               u'vib:app:bumpy',
               u'vib:app:bumpy'),
              (u'Bouncing ball',
               2,
               u'vib:app:bouncing_ball',
               u'vib:app:bouncing_ball'),
              (u'Two-body gravitational problem',
               2,
               u'vib:app:gravitation',
               u'vib:app:gravitation'),
              (u'The governing equations', 3, None, '___sec142'),
              (u'Scaling', 3, None, '___sec143'),
              (u'Solution in a special case: planet orbiting a star',
               3,
               None,
               '___sec144'),
              (u'Electric circuits', 2, None, '___sec145'),
              (u'Exercises', 1, None, '___sec146'),
              (u'Exercise 1.22: Simulate resonance',
               2,
               u'vib:exer:resonance',
               u'vib:exer:resonance'),
              (u'Exercise 1.23: Simulate oscillations of a sliding box',
               2,
               u'vib:exer:sliding_box',
               u'vib:exer:sliding_box'),
              (u'Exercise 1.24: Simulate a bouncing ball',
               2,
               u'vib:exer:bouncing:ball',
               u'vib:exer:bouncing:ball'),
              (u'Exercise 1.25: Simulate a simple pendulum',
               2,
               u'vib:exer:pendulum_simple',
               u'vib:exer:pendulum_simple'),
              (u'Exercise 1.26: Simulate an elastic pendulum',
               2,
               u'vib:exer:pendulum_elastic',
               u'vib:exer:pendulum_elastic'),
              (u'Exercise 1.27: Simulate an elastic pendulum with air resistance',
               2,
               u'vib:exer:pendulum_elastic_drag',
               u'vib:exer:pendulum_elastic_drag'),
              (u'Remarks', 3, None, '___sec153'),
              (u'Exercise 1.28: Implement the PEFRL algorithm',
               2,
               u'vib:exer:gen:PEFRL',
               u'vib:exer:gen:PEFRL'),
              (u'Remarks', 3, None, '___sec155'),
              (u'Wave equations', 0, u'ch:wave', u'ch:wave'),
              (u'Simulation of waves on a string',
               1,
               u'wave:string',
               u'wave:string'),
              (u'Discretizing the domain',
               2,
               u'wave:string:mesh',
               u'wave:string:mesh'),
              (u'Uniform meshes', 3, None, '___sec159'),
              (u'The discrete solution',
               2,
               u'wave:string:numerical:sol',
               u'wave:string:numerical:sol'),
              (u'Fulfilling the equation at the mesh points',
               2,
               u'wave:string:samplingPDE',
               u'wave:string:samplingPDE'),
              (u'Replacing derivatives by finite differences',
               2,
               u'wave:string:fd',
               u'wave:string:fd'),
              (u'Algebraic version of the PDE', 3, None, '___sec163'),
              (u'Interpretation of the equation as a stencil',
               3,
               None,
               '___sec164'),
              (u'Algebraic version of the initial conditions',
               3,
               None,
               '___sec165'),
              (u'Formulating a recursive algorithm',
               2,
               u'wave:string:alg',
               u'wave:string:alg'),
              (u'Sketch of an implementation',
               2,
               u'wave:string:impl',
               u'wave:string:impl'),
              (u'Verification', 1, None, '___sec168'),
              (u'A slightly generalized model problem',
               2,
               u'wave:pde2:fd',
               u'wave:pde2:fd'),
              (u'Using an analytical solution of physical significance',
               2,
               u'wave:pde2:fd:standing:waves',
               u'wave:pde2:fd:standing:waves'),
              (u'Manufactured solution and estimation of convergence rates',
               2,
               u'wave:pde2:fd:MMS',
               u'wave:pde2:fd:MMS'),
              (u'Specifying the solution and computing corresponding data',
               3,
               None,
               '___sec172'),
              (u'Defining a single discretization parameter',
               3,
               None,
               '___sec173'),
              (u'Computing errors', 3, None, '___sec174'),
              (u'Computing rates', 3, None, '___sec175'),
              (u'Constructing an exact solution of the discrete equations',
               2,
               u'wave:pde2:fd:verify:quadratic',
               u'wave:pde2:fd:verify:quadratic'),
              (u'Implementation', 1, u'wave:pde1:impl', u'wave:pde1:impl'),
              (u'Callback function for user-specific actions',
               2,
               u'wave:pde1:impl:useraction',
               u'wave:pde1:impl:useraction'),
              (u'The solver function',
               2,
               u'wave:pde1:impl:solver',
               u'wave:pde1:impl:solver'),
              (u'Verification: exact quadratic solution',
               2,
               u'wave:pde1:impl:verify:quadratic',
               u'wave:pde1:impl:verify:quadratic'),
              (u'Verification: convergence rates',
               2,
               u'wave:pde1:impl:verify:rate',
               u'wave:pde1:impl:verify:rate'),
              (u'Visualization: animating the solution',
               2,
               u'wave:pde1:impl:animate',
               u'wave:pde1:impl:animate'),
              (u'Function for administering the simulation',
               3,
               None,
               '___sec183'),
              (u'Dissection of the code', 3, None, '___sec184'),
              (u'Making movie files', 3, None, '___sec185'),
              (u'Skipping frames for animation speed', 3, None, '___sec186'),
              (u'Running a case',
               2,
               u'wave:pde1:guitar:data',
               u'wave:pde1:guitar:data'),
              (u'Working with a scaled PDE model', 2, None, '___sec188'),
              (u'Vectorization',
               1,
               u'wave:pde1:impl:vec',
               u'wave:pde1:impl:vec'),
              (u'Operations on slices of arrays',
               2,
               u'wave:pde1:impl:vec:slices:basics',
               u'wave:pde1:impl:vec:slices:basics'),
              (u'Finite difference schemes expressed as slices',
               2,
               u'wave:pde1:impl:vec:slices:fdm',
               u'wave:pde1:impl:vec:slices:fdm'),
              (u'Verification',
               2,
               u'wave:pde1:impl:vec:verify:quadratic',
               u'wave:pde1:impl:vec:verify:quadratic'),
              (u'Efficiency measurements', 2, None, '___sec193'),
              (u'Solution 1', 3, None, '___sec194'),
              (u'Solution 2', 3, None, '___sec195'),
              (u'Efficiency experiments', 3, None, '___sec196'),
              (u'Remark on the updating of arrays',
               2,
               u'wave:pde1:impl:ref:switch',
               u'wave:pde1:impl:ref:switch'),
              (u'Exercises', 1, None, '___sec198'),
              (u'Exercise 2.1: Simulate a standing wave',
               2,
               u'wave:exer:standingwave',
               u'wave:exer:standingwave'),
              (u'Remarks', 3, None, '___sec200'),
              (u'Exercise 2.2: Add storage of solution in a user action function',
               2,
               u'wave:exer:store:list',
               u'wave:exer:store:list'),
              (u'Exercise 2.3: Use a class for the user action function',
               2,
               u'wave:exer:store:list:class',
               u'wave:exer:store:list:class'),
              (u'Exercise 2.4: Compare several Courant numbers in one movie',
               2,
               u'wave:exer:multiple:C',
               u'wave:exer:multiple:C'),
              (u'Exercise 2.5: Implementing the solver function as a generator',
               2,
               u'wave:exer:useraction:generator',
               u'wave:exer:useraction:generator'),
              (u'Project 2.6: Calculus with 1D mesh functions',
               2,
               u'wave:exer:mesh1D:calculus',
               u'wave:exer:mesh1D:calculus'),
              (u'Generalization: reflecting boundaries',
               1,
               u'wave:pde2:Neumann',
               u'wave:pde2:Neumann'),
              (u'Neumann boundary condition',
               2,
               u'wave:pde2:Neumann:bc',
               u'wave:pde2:Neumann:bc'),
              (u'Discretization of derivatives at the boundary',
               2,
               u'wave:pde2:Neumann:discr',
               u'wave:pde2:Neumann:discr'),
              (u'Implementation of Neumann conditions',
               2,
               u'wave:pde2:Neumann:impl',
               u'wave:pde2:Neumann:impl'),
              (u'Index set notation', 2, u'wave:indexset', u'wave:indexset'),
              (u'Verifying the implementation of Neumann conditions',
               2,
               u'wave:pde1:verify',
               u'wave:pde1:verify'),
              (u'Alternative implementation via ghost cells',
               2,
               u'wave:pde1:Neumann:ghost',
               u'wave:pde1:Neumann:ghost'),
              (u'Idea', 3, None, '___sec213'),
              (u'Implementation', 3, None, '___sec214'),
              (u'Generalization: variable wave velocity',
               1,
               u'wave:pde2:var:c',
               u'wave:pde2:var:c'),
              (u'The model PDE with a variable coefficient',
               2,
               None,
               '___sec216'),
              (u'Discretizing the variable coefficient',
               2,
               u'wave:pde2:var:c:ideas',
               u'wave:pde2:var:c:ideas'),
              (u'Computing the coefficient between mesh points',
               2,
               u'wave:pde2:var:c:means',
               u'wave:pde2:var:c:means'),
              (u'How a variable coefficient affects the stability',
               2,
               u'wave:pde2:var:c:stability',
               u'wave:pde2:var:c:stability'),
              (u'Neumann condition and a variable coefficient',
               2,
               u'wave:pde2:var:c:Neumann',
               u'wave:pde2:var:c:Neumann'),
              (u'Implementation of variable coefficients',
               2,
               u'wave:pde2:var:c:impl',
               u'wave:pde2:var:c:impl'),
              (u'A more general PDE model with variable coefficients',
               2,
               None,
               '___sec222'),
              (u'Generalization: damping', 2, None, '___sec223'),
              (u'Building a general 1D wave equation solver',
               1,
               u'wave:pde2:software',
               u'wave:pde2:software'),
              (u'User action function as a class', 2, None, '___sec225'),
              (u'The code', 3, None, '___sec226'),
              (u'Dissection', 3, None, '___sec227'),
              (u'Pulse propagation in two media', 2, None, '___sec228'),
              (u'Exercises', 1, None, '___sec229'),
              (u'Exercise 2.7: Find the analytical solution to a damped wave equation',
               2,
               u'wave:exer:standingwave:damped:uex',
               u'wave:exer:standingwave:damped:uex'),
              (u'Problem 2.8: Explore symmetry boundary conditions',
               2,
               u'wave:exer:symmetry:bc',
               u'wave:exer:symmetry:bc'),
              (u'Exercise 2.9: Send pulse waves through a layered medium',
               2,
               u'wave:app:exer:pulse1D',
               u'wave:app:exer:pulse1D'),
              (u'Exercise 2.10: Explain why numerical noise occurs',
               2,
               u'wave:app:exer:pulse1D:analysis',
               u'wave:app:exer:pulse1D:analysis'),
              (u'Exercise 2.11: Investigate harmonic averaging in a 1D model',
               2,
               u'wave:app:exer:pulse1D:harmonic',
               u'wave:app:exer:pulse1D:harmonic'),
              (u'Problem 2.12: Implement open boundary conditions',
               2,
               u'wave:app:exer:radiationBC',
               u'wave:app:exer:radiationBC'),
              (u'Remarks', 3, None, '___sec236'),
              (u'Exercise 2.13: Implement periodic boundary conditions',
               2,
               u'wave:exer:periodic',
               u'wave:exer:periodic'),
              (u'Exercise 2.14: Compare discretizations of a Neumann condition',
               2,
               None,
               '___sec238'),
              (u'Exercise 2.15: Verification by a cubic polynomial in space',
               2,
               u'wave:fd2:exer:verify:cubic',
               u'wave:fd2:exer:verify:cubic'),
              (u'Analysis of the difference equations',
               1,
               u'wave:pde1:analysis',
               u'wave:pde1:analysis'),
              (u'Properties of the solution of the wave equation',
               2,
               u'wave:pde1:properties',
               u'wave:pde1:properties'),
              (u'More precise definition of Fourier representations',
               2,
               u'wave:pde1:Fourier',
               u'wave:pde1:Fourier'),
              (u'Stability',
               2,
               u'wave:pde1:stability',
               u'wave:pde1:stability'),
              (u'Preliminary results', 3, None, '___sec244'),
              (u'Numerical wave propagation', 3, None, '___sec245'),
              (u'Numerical dispersion relation',
               2,
               u'wave:pde1:num:dispersion',
               u'wave:pde1:num:dispersion'),
              (u'Extending the analysis to 2D and 3D',
               2,
               u'wave:pde1:analysis:2D3D',
               u'wave:pde1:analysis:2D3D'),
              (u'Finite difference methods for 2D and 3D wave equations',
               1,
               u'wave:2D3D',
               u'wave:2D3D'),
              (u'Multi-dimensional wave equations',
               2,
               u'wave:2D3D:models',
               u'wave:2D3D:models'),
              (u'Mesh', 2, u'wave:2D3D:mesh', u'wave:2D3D:mesh'),
              (u'Discretization',
               2,
               u'wave:2D3D:discretization',
               u'wave:2D3D:discretization'),
              (u'Discretizing the PDEs', 3, None, '___sec252'),
              (u'Handling boundary conditions where $u$ is known',
               3,
               None,
               '___sec253'),
              (u'Discretizing the Neumann condition', 3, None, '___sec254'),
              (u'Implementation', 1, u'wave:2D3D:impl', u'wave:2D3D:impl'),
              (u'Scalar computations',
               2,
               u'wave2D3D:impl:scalar',
               u'wave2D3D:impl:scalar'),
              (u'Domain and mesh', 3, None, '___sec257'),
              (u'Solution arrays', 3, None, '___sec258'),
              (u'Index sets', 3, None, '___sec259'),
              (u'Computing the solution', 3, None, '___sec260'),
              (u'Vectorized computations',
               2,
               u'wave2D3D:impl:vectorized',
               u'wave2D3D:impl:vectorized'),
              (u'Verification',
               2,
               u'wave2D3D:impl:verify',
               u'wave2D3D:impl:verify'),
              (u'Testing a quadratic solution', 3, None, '___sec263'),
              (u'Visualization', 2, None, '___sec264'),
              (u'Matplotlib', 3, None, '___sec265'),
              (u'Gnuplot', 3, None, '___sec266'),
              (u'Mayavi', 3, None, '___sec267'),
              (u'Exercises', 1, None, '___sec268'),
              (u'Exercise 2.16: Check that a solution fulfills the discrete model',
               2,
               u'wave:exer:quadratic:2D',
               u'wave:exer:quadratic:2D'),
              (u'Project 2.17: Calculus with 2D mesh functions',
               2,
               u'wave:exer:mesh3D:calculus',
               u'wave:exer:mesh3D:calculus'),
              (u'Exercise 2.18: Implement Neumann conditions in 2D',
               2,
               u'wave:app:exer:wave2D:Neumann',
               u'wave:app:exer:wave2D:Neumann'),
              (u'Exercise 2.19: Test the efficiency of compiled loops in 3D',
               2,
               u'wave:exer:3D:f77:cy:efficiency',
               u'wave:exer:3D:f77:cy:efficiency'),
              (u'Applications of wave equations',
               1,
               u'wave:app',
               u'wave:app'),
              (u'Waves on a string',
               2,
               u'wave:app:string',
               u'wave:app:string'),
              (u'Damping', 3, None, '___sec275'),
              (u'External forcing', 3, None, '___sec276'),
              (u'Modeling the tension via springs', 3, None, '___sec277'),
              (u'Elastic waves in a rod',
               2,
               u'wave:app:elastic:rod',
               u'wave:app:elastic:rod'),
              (u'Waves on a membrane',
               2,
               u'wave:app:membrane',
               u'wave:app:membrane'),
              (u'The acoustic model for seismic waves',
               2,
               u'wave:app:acoustic:seismic',
               u'wave:app:acoustic:seismic'),
              (u'Anisotropy', 3, None, '___sec281'),
              (u'Sound waves in liquids and gases',
               2,
               u'wave:app:sound',
               u'wave:app:sound'),
              (u'Spherical waves',
               2,
               u'wave:app:spherical',
               u'wave:app:spherical'),
              (u'The linear shallow water equations',
               2,
               u'wave:app:sw:2D',
               u'wave:app:sw:2D'),
              (u'Wind drag on the surface', 3, None, '___sec285'),
              (u'Bottom drag', 3, None, '___sec286'),
              (u"Effect of the Earth's rotation", 3, None, '___sec287'),
              (u'Waves in blood vessels',
               2,
               u'wave:app:blood',
               u'wave:app:blood'),
              (u'Electromagnetic waves',
               2,
               u'wave:app:light',
               u'wave:app:light'),
              (u'Exercises', 1, u'wave:app:exer', u'wave:app:exer'),
              (u'Exercise 2.20: Simulate waves on a non-homogeneous string',
               2,
               u'wave:app:exer:string:discont',
               u'wave:app:exer:string:discont'),
              (u'Exercise 2.21: Simulate damped waves on a string',
               2,
               u'wave:app:exer:string:damping',
               u'wave:app:exer:string:damping'),
              (u'Exercise 2.22: Simulate elastic waves in a rod',
               2,
               u'wave:app:exer:rod',
               u'wave:app:exer:rod'),
              (u'Exercise 2.23: Simulate spherical waves',
               2,
               u'wave:app:exer:spherical',
               u'wave:app:exer:spherical'),
              (u'Problem 2.24: Earthquake-generated tsunami over a subsea hill',
               2,
               u'wave:app:exer:tsunami1D:hill',
               u'wave:app:exer:tsunami1D:hill'),
              (u'Problem 2.25: Earthquake-generated tsunami over a 3D hill',
               2,
               u'wave:app:exer:tsunami2D:hill',
               u'wave:app:exer:tsunami2D:hill'),
              (u'Problem 2.26: Investigate Mayavi for visualization',
               2,
               u'wave:app:exer:tsunami:hill:viz:matplotlib',
               u'wave:app:exer:tsunami:hill:viz:matplotlib'),
              (u'Problem 2.27: Investigate visualization packages',
               2,
               u'wave:app:exer:tsunami:hill:viz:packages',
               u'wave:app:exer:tsunami:hill:viz:packages'),
              (u'Problem 2.28: Implement loops in compiled languages',
               2,
               u'wave:app:exer:tsunami2D:hill:compiled',
               u'wave:app:exer:tsunami2D:hill:compiled'),
              (u'Exercise 2.29: Simulate seismic waves in 2D',
               2,
               u'wave:app:exer:seismic2D',
               u'wave:app:exer:seismic2D'),
              (u'Project 2.30: Model 3D acoustic waves in a room',
               2,
               u'wave:app:exer:acoustics',
               u'wave:app:exer:acoustics'),
              (u'Project 2.31: Solve a 1D transport equation',
               2,
               u'wave:app:exer:advec1D',
               u'wave:app:exer:advec1D'),
              (u'Problem 2.32: General analytical solution of a 1D damped wave equation',
               2,
               u'wave:app:exer:anal:damped:wave1D',
               u'wave:app:exer:anal:damped:wave1D'),
              (u'Problem 2.33: General analytical solution of a 2D damped wave equation',
               2,
               u'wave:app:exer:anal:damped:wave2D',
               u'wave:app:exer:anal:damped:wave2D'),
              (u'Diffusion equations', 0, u'ch:diffu', u'ch:diffu'),
              (u'An explicit method for the 1D diffusion equation',
               1,
               u'diffu:pde1:FEsec',
               u'diffu:pde1:FEsec'),
              (u'The initial-boundary value problem for 1D diffusion',
               2,
               None,
               '___sec307'),
              (u'Forward Euler scheme',
               2,
               u'diffu:pde1:FE',
               u'diffu:pde1:FE'),
              (u'Implementation',
               2,
               u'diffu:pde1:FE:code',
               u'diffu:pde1:FE:code'),
              (u'Verification',
               2,
               u'diffu:pde1:FE:verify',
               u'diffu:pde1:FE:verify'),
              (u'Exact solution of discrete equations',
               3,
               u'diffu:pde1:FE:verify:exact',
               u'diffu:pde1:FE:verify:exact'),
              (u'Checking convergence rates',
               3,
               u'diffu:pde1:FE:verify:convrates',
               u'diffu:pde1:FE:verify:convrates'),
              (u'Numerical experiments',
               2,
               u'diffu:pde1:FE:experiments',
               u'diffu:pde1:FE:experiments'),
              (u'Implicit methods for the 1D diffusion equation',
               1,
               u'diffu:pde1:implicit',
               u'diffu:pde1:implicit'),
              (u'Backward Euler scheme',
               2,
               u'diffu:pde1:BE',
               u'diffu:pde1:BE'),
              (u'Sparse matrix implementation',
               2,
               u'diffu:pde1:impl:sparse',
               u'diffu:pde1:impl:sparse'),
              (u'Crank-Nicolson scheme',
               2,
               u'diffu:pde1:CN',
               u'diffu:pde1:CN'),
              (u'The unifying $\\theta$ rule',
               2,
               u'diffu:pde1:theta',
               u'diffu:pde1:theta'),
              (u'Experiments',
               2,
               u'diffu:pde1:theta:experiments',
               u'diffu:pde1:theta:experiments'),
              (u'The Laplace and Poisson equation', 2, None, '___sec320'),
              (u'Analysis of schemes for the diffusion equation',
               1,
               u'diffu:pde1:analysis',
               u'diffu:pde1:analysis'),
              (u'Properties of the solution',
               2,
               u'diffu:pde1:analysis:uex',
               u'diffu:pde1:analysis:uex'),
              (u'Similarity solution', 3, None, '___sec323'),
              (u'Solution for a Gaussian pulse', 3, None, '___sec324'),
              (u'Solution for a sine component', 3, None, '___sec325'),
              (u'Analysis of discrete equations', 2, None, '___sec326'),
              (u'Analysis of the finite difference schemes',
               2,
               u'diffu:pde1:analysis:details',
               u'diffu:pde1:analysis:details'),
              (u'Stability', 3, None, '___sec328'),
              (u'Accuracy', 3, None, '___sec329'),
              (u'Truncation error', 3, None, '___sec330'),
              (u'Analysis of the Forward Euler scheme',
               2,
               u'diffu:pde1:analysis:FE',
               u'diffu:pde1:analysis:FE'),
              (u'Stability', 3, None, '___sec332'),
              (u'Accuracy', 3, None, '___sec333'),
              (u'Truncation error', 3, None, '___sec334'),
              (u'Analysis of the Backward Euler scheme',
               2,
               u'diffu:pde1:analysis:BE',
               u'diffu:pde1:analysis:BE'),
              (u'Stability', 3, None, '___sec336'),
              (u'Truncation error', 3, None, '___sec337'),
              (u'Analysis of the Crank-Nicolson scheme',
               2,
               u'diffu:pde1:analysis:CN',
               u'diffu:pde1:analysis:CN'),
              (u'Stability', 3, None, '___sec339'),
              (u'Truncation error', 3, None, '___sec340'),
              (u'Analysis of the Leapfrog scheme',
               2,
               u'diffu:pde1:analysis:leapfrog',
               u'diffu:pde1:analysis:leapfrog'),
              (u'Summary of accuracy of amplification factors',
               2,
               None,
               '___sec342'),
              (u'Analysis of the 2D diffusion equation',
               2,
               u'diffu:2D:analysis',
               u'diffu:2D:analysis'),
              (u'The Forward Euler scheme', 3, None, '___sec344'),
              (u'The Backward Euler scheme', 3, None, '___sec345'),
              (u'The Crank-Nicolson scheme', 3, None, '___sec346'),
              (u'Explanation of numerical artifacts', 2, None, '___sec347'),
              (u'Exercises', 1, None, '___sec348'),
              (u'Exercise 3.1: Explore symmetry in a 1D problem',
               2,
               u'diffu:exer:1D:gaussian:symmetric',
               u'diffu:exer:1D:gaussian:symmetric'),
              (u'Exercise 3.2: Investigate approximation errors from a $u_x=0$ boundary condition',
               2,
               u'diffu:exer:1D:ux:onesided',
               u'diffu:exer:1D:ux:onesided'),
              (u'Exercise 3.3: Experiment with open boundary conditions in 1D',
               2,
               u'diffu:exer:1D:openBC',
               u'diffu:exer:1D:openBC'),
              (u'Exercise 3.4: Simulate a diffused Gaussian peak in 2D/3D',
               2,
               None,
               '___sec352'),
              (u'Exercise 3.5: Examine stability of a diffusion model with a source term',
               2,
               u'diffu:exer:uterm',
               u'diffu:exer:uterm'),
              (u'Diffusion in heterogeneous media',
               1,
               u'diffu:varcoeff',
               u'diffu:varcoeff'),
              (u'Discretization',
               2,
               u'diffu:varcoeff:discr',
               u'diffu:varcoeff:discr'),
              (u'Implementation',
               2,
               u'diffu:varcoeff:impl',
               u'diffu:varcoeff:impl'),
              (u'Stationary solution',
               2,
               u'diffu:varcoeff:stationary',
               u'diffu:varcoeff:stationary'),
              (u'Piecewise constant medium',
               2,
               u'diffu:varcoeff:piecewise',
               u'diffu:varcoeff:piecewise'),
              (u'Implementation of diffusion in a piecewise constant medium',
               2,
               u'diffu:varcoeff:impl:piecewise',
               u'diffu:varcoeff:impl:piecewise'),
              (u'Axi-symmetric diffusion',
               2,
               u'diffu:fd2:radial',
               u'diffu:fd2:radial'),
              (u'Spherically-symmetric diffusion',
               2,
               u'diffu:fd2:spherical',
               u'diffu:fd2:spherical'),
              (u'Discretization in spherical coordinates',
               3,
               None,
               '___sec362'),
              (u'Discretization in Cartesian coordinates',
               3,
               None,
               '___sec363'),
              (u'Diffusion in 2D', 1, u'diffu:2D', u'diffu:2D'),
              (u'Discretization', 2, u'diffu:2D:discr', u'diffu:2D:discr'),
              (u'Numbering of mesh points versus equations and unknowns',
               2,
               u'diffu:2D:numbering',
               u'diffu:2D:numbering'),
              (u'Algorithm for setting up the coefficient matrix',
               2,
               u'diffu:2D:alg',
               u'diffu:2D:alg'),
              (u'Implementation with a dense coefficient matrix',
               2,
               u'diffu:2D:impl:dense',
               u'diffu:2D:impl:dense'),
              (u'Verification: exact numerical solution',
               2,
               u'diffu:2D:verify',
               u'diffu:2D:verify'),
              (u'Verification: convergence rates',
               2,
               u'diffu:2D:convrate',
               u'diffu:2D:convrate'),
              (u'Implementation with a sparse coefficient matrix',
               2,
               u'diffu:2D:impl:sparse',
               u'diffu:2D:impl:sparse'),
              (u'Understanding the diagonals', 3, None, '___sec372'),
              (u'Filling the diagonals', 3, None, '___sec373'),
              (u'Filling the right-hand side; scalar version',
               3,
               None,
               '___sec374'),
              (u'Filling the right-hand side; vectorized version',
               3,
               None,
               '___sec375'),
              (u'Verification', 3, None, '___sec376'),
              (u'The Jacobi iterative method', 2, None, '___sec377'),
              (u'Numerical scheme and linear system', 3, None, '___sec378'),
              (u'Iterations', 3, None, '___sec379'),
              (u'Initial guess', 3, None, '___sec380'),
              (u'Relaxation', 3, None, '___sec381'),
              (u'Stopping criteria', 3, None, '___sec382'),
              (u'Code-friendly notation', 3, None, '___sec383'),
              (u'Generalization of the scheme', 3, None, '___sec384'),
              (u'Implementation of the Jacobi method',
               2,
               u'diffu:2D:Jacobi:impl',
               u'diffu:2D:Jacobi:impl'),
              (u'Test problem: diffusion of a sine hill',
               2,
               u'diffu:2D:Jacobi:impl:hill',
               u'diffu:2D:Jacobi:impl:hill'),
              (u'The relaxed Jacobi method and its relation to the Forward Euler method',
               2,
               u'diffu:2D:Jacobi_vs_FE',
               u'diffu:2D:Jacobi_vs_FE'),
              (u'The Gauss-Seidel and SOR methods',
               2,
               u'diffu:2D:SOR',
               u'diffu:2D:SOR'),
              (u'Scalar implementation of the SOR method',
               2,
               u'diffu:2D:SOR:impl:scalar',
               u'diffu:2D:SOR:impl:scalar'),
              (u'Vectorized implementation of the SOR method',
               2,
               u'diffu:2D:SOR:impl:vectorized',
               u'diffu:2D:SOR:impl:vectorized'),
              (u'Direct versus iterative methods',
               2,
               u'diffu:2D:direct_vs_iter',
               u'diffu:2D:direct_vs_iter'),
              (u'Direct methods', 3, None, '___sec392'),
              (u'Iterative methods', 3, None, '___sec393'),
              (u'The Conjugate gradient method',
               2,
               u'diffu:2D:CG',
               u'diffu:2D:CG'),
              (u'What is the recommended method for solving linear systems?',
               2,
               None,
               '___sec395'),
              (u'Random walk', 1, u'diffu:randomwalk', u'diffu:randomwalk'),
              (u'Random walk in 1D',
               2,
               u'diffu:randomwalk:1D',
               u'diffu:randomwalk:1D'),
              (u'Statistical considerations',
               2,
               u'diffu:randomwalk:1D:EVar',
               u'diffu:randomwalk:1D:EVar'),
              (u'Playing around with some code',
               2,
               u'diffu:randomwalk:1D:code1',
               u'diffu:randomwalk:1D:code1'),
              (u'Scalar code', 3, None, '___sec400'),
              (u'Vectorized code', 3, None, '___sec401'),
              (u'Fixing the random sequence', 3, None, '___sec402'),
              (u'Verification', 3, None, '___sec403'),
              (u'Equivalence with diffusion',
               2,
               u'diffu:randomwalk:1D:pde',
               u'diffu:randomwalk:1D:pde'),
              (u'Implementation of multiple walks', 2, None, '___sec405'),
              (u'Scalar version', 3, None, '___sec406'),
              (u'Vectorized version', 3, None, '___sec407'),
              (u'Improved vectorized version', 3, None, '___sec408'),
              (u'Remark on vectorized code and parallelization',
               3,
               None,
               '___sec409'),
              (u'Test function', 3, None, '___sec410'),
              (u'Demonstration of multiple walks', 2, None, '___sec411'),
              (u'Ascii visualization of 1D random walk',
               2,
               u'diffu:randomwalk:1D:avplotter',
               u'diffu:randomwalk:1D:avplotter'),
              (u'Random walk as a stochastic equation',
               2,
               u'diffu:randomwalk:1D:ode',
               u'diffu:randomwalk:1D:ode'),
              (u'Random walk in 2D', 2, None, '___sec414'),
              (u'Random walk in any number of space dimensions',
               2,
               None,
               '___sec415'),
              (u'Multiple random walks in any number of space dimensions',
               2,
               None,
               '___sec416'),
              (u'Scalar code', 3, None, '___sec417'),
              (u'Vectorized code', 3, None, '___sec418'),
              (u'Applications', 1, u'diffu:app', u'diffu:app'),
              (u'Diffusion of a substance',
               2,
               u'diffu:app:substance',
               u'diffu:app:substance'),
              (u'Heat conduction', 2, u'diffu:app:heat', u'diffu:app:heat'),
              (u'Porous media flow',
               2,
               u'diffu:app:porous',
               u'diffu:app:porous'),
              (u'Potential fluid flow', 2, None, '___sec423'),
              (u'Streamlines for 2D fluid flow', 2, None, '___sec424'),
              (u'The potential of an electric field', 2, None, '___sec425'),
              (u'Development of flow between two flat plates',
               2,
               u'diffu:app:Couette',
               u'diffu:app:Couette'),
              (u'Flow in a straight tube',
               2,
               u'diffu:app:pipeflow',
               u'diffu:app:pipeflow'),
              (u'Tribology: thin film fluid flow', 2, None, '___sec428'),
              (u'Propagation of electrical signals in the brain',
               2,
               None,
               '___sec429'),
              (u'Exercises', 1, None, '___sec430'),
              (u'Exercise 3.6: Stabilizing the Crank-Nicolson method by Rannacher time stepping',
               2,
               u'diffu:exer:CN:Rannacher',
               u'diffu:exer:CN:Rannacher'),
              (u'Project 3.7: Energy estimates for diffusion problems',
               2,
               u'diffu:exer:energy:estimates',
               u'diffu:exer:energy:estimates'),
              (u'Exercise 3.8: Splitting methods and preconditioning',
               2,
               u'diffu:exer:splitting_prec',
               u'diffu:exer:splitting_prec'),
              (u'Problem 3.9: Oscillating surface temperature of the earth',
               2,
               u'diffu:exer:earthosc',
               u'diffu:exer:earthosc'),
              (u'Problem 3.10: Oscillating and pulsating flow in tubes',
               2,
               u'diffu:exer:bloodflow',
               u'diffu:exer:bloodflow'),
              (u'Problem 3.11: Scaling a welding problem',
               2,
               u'diffu:exer:welding',
               u'diffu:exer:welding'),
              (u'Exercise 3.12: Implement a Forward Euler scheme for axi-symmetric diffusion',
               2,
               u'diffu:exer:axisymm',
               u'diffu:exer:axisymm'),
              (u'Advection-dominated equations',
               0,
               u'ch:convdiff',
               u'ch:convdiff'),
              (u'One-dimensional time-dependent advection equations',
               1,
               u'advec:1D',
               u'advec:1D'),
              (u'Simplest scheme: forward in time, centered in space',
               2,
               u'advec:1D:FTCS',
               u'advec:1D:FTCS'),
              (u'Method', 3, None, '___sec441'),
              (u'Implementation', 3, None, '___sec442'),
              (u'Test cases', 3, None, '___sec443'),
              (u'Bug?', 3, None, '___sec444'),
              (u'Analysis of the scheme',
               2,
               u'advec:1D:FTCS:anal',
               u'advec:1D:FTCS:anal'),
              (u'Leapfrog in time, centered differences in space',
               2,
               u'advec:1D:leapfrog',
               u'advec:1D:leapfrog'),
              (u'Method', 3, None, '___sec447'),
              (u'Implementation', 3, None, '___sec448'),
              (u'Running a test case', 3, None, '___sec449'),
              (u'Running more test cases', 3, None, '___sec450'),
              (u'Analysis', 3, None, '___sec451'),
              (u'Upwind differences in space',
               2,
               u'advec:1D:FTUP',
               u'advec:1D:FTUP'),
              (u'Periodic boundary conditions',
               2,
               u'advec:1D:periodic_BC',
               u'advec:1D:periodic_BC'),
              (u'Implementation', 2, None, '___sec454'),
              (u'Test condition', 3, None, '___sec455'),
              (u'The code', 3, None, '___sec456'),
              (u'Solving a specific problem', 3, None, '___sec457'),
              (u'A Crank-Nicolson discretization in time and centered differences in space',
               2,
               u'advec:1D:CN',
               u'advec:1D:CN'),
              (u'The Lax-Wendroff method',
               2,
               u'advec:1D:LaxW',
               u'advec:1D:LaxW'),
              (u'Analysis of dispersion relations',
               2,
               u'advec:1D:disprel',
               u'advec:1D:disprel'),
              (u'One-dimensional stationary advection-diffusion equation',
               1,
               u'advec:1D:stationary',
               u'advec:1D:stationary'),
              (u'A simple model problem',
               2,
               u'advec:1D:stationary:model',
               u'advec:1D:stationary:model'),
              (u'A centered finite difference scheme',
               2,
               u'advec:1D:stationary:fdm',
               u'advec:1D:stationary:fdm'),
              (u'Remedy: upwind finite difference scheme',
               2,
               u'advec:1D:stationary:upwind',
               u'advec:1D:stationary:upwind'),
              (u'Time-dependent convection-diffusion equations',
               1,
               None,
               '___sec465'),
              (u'Analytical insight', 3, None, '___sec466'),
              (u'Forward in time, centered in space scheme',
               2,
               None,
               '___sec467'),
              (u'Forward in time, upwind in space scheme',
               2,
               None,
               '___sec468'),
              (u'Two-dimensional advection-diffusion equations',
               1,
               u'advec:2D',
               u'advec:2D'),
              (u'Applications of advection equations',
               1,
               u'advec:app',
               u'advec:app'),
              (u'Transport of a substance',
               2,
               u'advec:app:mass',
               u'advec:app:mass'),
              (u'Transport of a heat',
               2,
               u'advec:app:heat',
               u'advec:app:heat'),
              (u'Exercises', 1, None, '___sec473'),
              (u'Exercise 4.1: Analyze 1D stationary convection-diffusion problem',
               2,
               u'advec:1D:stationary:exer:analysis1',
               u'advec:1D:stationary:exer:analysis1'),
              (u'Exercise 4.2: Interpret upwind difference as artificial diffusion',
               2,
               u'advec:1D:stationary:exer:analysis2',
               u'advec:1D:stationary:exer:analysis2'),
              (u'Nonlinear problems', 0, u'ch:nonlin', u'ch:nonlin'),
              (u'Introduction of basic concepts',
               1,
               u'nonlin:timediscrete:logistic',
               u'nonlin:timediscrete:logistic'),
              (u'Linear versus nonlinear equations', 2, None, '___sec478'),
              (u'Algebraic equations', 3, None, '___sec479'),
              (u'Differential equations', 3, None, '___sec480'),
              (u'A simple model problem', 2, None, '___sec481'),
              (u'Linearization by explicit time discretization',
               2,
               u'nonlin:timediscrete:logistic:FE',
               u'nonlin:timediscrete:logistic:FE'),
              (u'Exact solution of nonlinear algebraic equations',
               2,
               u'nonlin:timediscrete:logistic:roots',
               u'nonlin:timediscrete:logistic:roots'),
              (u'Linearization', 2, None, '___sec484'),
              (u'Picard iteration',
               2,
               u'nonlin:timediscrete:logistic:Picard',
               u'nonlin:timediscrete:logistic:Picard'),
              (u'Stopping criteria', 3, None, '___sec486'),
              (u'A single Picard iteration', 3, None, '___sec487'),
              (u'Linearization by a geometric mean',
               2,
               u'nonlin:timediscrete:logistic:geometric:mean',
               u'nonlin:timediscrete:logistic:geometric:mean'),
              (u"Newton's method",
               2,
               u'nonlin:timediscrete:logistic:Newton',
               u'nonlin:timediscrete:logistic:Newton'),
              (u'Relaxation',
               2,
               u'nonlin:timediscrete:logistic:relaxation',
               u'nonlin:timediscrete:logistic:relaxation'),
              (u'Implementation and experiments',
               2,
               u'nonlin:timediscrete:logistic:impl',
               u'nonlin:timediscrete:logistic:impl'),
              (u'Generalization to a general nonlinear ODE',
               2,
               u'nonlin:ode:generic',
               u'nonlin:ode:generic'),
              (u'Explicit time discretization', 3, None, '___sec493'),
              (u'Backward Euler discretization', 3, None, '___sec494'),
              (u'Crank-Nicolson discretization', 3, None, '___sec495'),
              (u'Systems of ODEs',
               2,
               u'nonlin:ode:generic:sys:pendulum',
               u'nonlin:ode:generic:sys:pendulum'),
              (u'Example', 3, None, '___sec497'),
              (u'Systems of nonlinear algebraic equations',
               1,
               u'nonlin:systems:alg',
               u'nonlin:systems:alg'),
              (u'Picard iteration',
               2,
               u'nonlin:systems:alg:Picard',
               u'nonlin:systems:alg:Picard'),
              (u"Newton's method",
               2,
               u'nonlin:systems:alg:Newton',
               u'nonlin:systems:alg:Newton'),
              (u'Stopping criteria',
               2,
               u'nonlin:systems:alg:terminate',
               u'nonlin:systems:alg:terminate'),
              (u'Example: A nonlinear ODE model from epidemiology',
               2,
               u'nonlin:systems:alg:SI',
               u'nonlin:systems:alg:SI'),
              (u'Implicit time discretization', 3, None, '___sec503'),
              (u'A Picard iteration', 3, None, '___sec504'),
              (u"Newton's method", 3, None, '___sec505'),
              (u'Linearization at the differential equation level',
               1,
               u'nonlin:pdelevel',
               u'nonlin:pdelevel'),
              (u'Explicit time integration',
               2,
               u'nonlin:pdelevel:explicit',
               u'nonlin:pdelevel:explicit'),
              (u'Backward Euler scheme and Picard iteration',
               2,
               u'nonlin:pdelevel:Picard',
               u'nonlin:pdelevel:Picard'),
              (u"Backward Euler scheme and Newton's method",
               2,
               u'nonlin:pdelevel:Newton',
               u'nonlin:pdelevel:Newton'),
              (u'Linearization via Taylor expansions', 3, None, '___sec510'),
              (u'Similarity with Picard iteration', 3, None, '___sec511'),
              (u'Implementation', 3, None, '___sec512'),
              (u'Derivation with alternative notation', 3, None, '___sec513'),
              (u'Crank-Nicolson discretization',
               2,
               u'nonlin:pdelevel:Picard:CN',
               u'nonlin:pdelevel:Picard:CN'),
              (u'1D stationary nonlinear differential equations',
               1,
               u'nonlin:alglevel:1D',
               u'nonlin:alglevel:1D'),
              (u'Finite difference discretization',
               2,
               u'nonlin:alglevel:1D:fd',
               u'nonlin:alglevel:1D:fd'),
              (u'Solution of algebraic equations', 2, None, '___sec517'),
              (u'The structure of the equation system', 3, None, '___sec518'),
              (u'Picard iteration', 3, None, '___sec519'),
              (u'Mesh with two cells', 3, None, '___sec520'),
              (u"Newton's method", 3, None, '___sec521'),
              (u'Multi-dimensional nonlinear PDE problems',
               1,
               None,
               '___sec522'),
              (u'Finite difference discretization',
               2,
               u'nonlin:alglevel:dD:fd',
               u'nonlin:alglevel:dD:fd'),
              (u'Picard iteration', 3, None, '___sec524'),
              (u"Newton's method", 3, None, '___sec525'),
              (u'Continuation methods', 2, None, '___sec526'),
              (u'Operator splitting methods',
               1,
               u'nonlin:splitting',
               u'nonlin:splitting'),
              (u'Ordinary operator splitting for ODEs',
               2,
               u'nonlin:splitting:ODE',
               u'nonlin:splitting:ODE'),
              (u'Strang splitting for ODEs',
               2,
               u'nonlin:splitting:ODE_Strang',
               u'nonlin:splitting:ODE_Strang'),
              (u'Example: Logistic growth',
               2,
               u'nonlin:splitting:logistic',
               u'nonlin:splitting:logistic'),
              (u'Splitting techniques', 3, None, '___sec531'),
              (u'Verbose implementation', 3, None, '___sec532'),
              (u'Compact implementation', 3, None, '___sec533'),
              (u'Results', 3, None, '___sec534'),
              (u'Reaction-diffusion equation',
               2,
               u'nonlin:splitting:RD',
               u'nonlin:splitting:RD'),
              (u'Example: Reaction-Diffusion with linear reaction term',
               2,
               u'nonlin:splitting:RD_linearR',
               u'nonlin:splitting:RD_linearR'),
              (u'Analysis of the splitting method', 2, None, '___sec537'),
              (u'Exercises', 1, u'nonlin:exer', u'nonlin:exer'),
              (u'Problem 5.1: Determine if equations are nonlinear or not',
               2,
               u'nonlin:exer:lin:vs:nonlin',
               u'nonlin:exer:lin:vs:nonlin'),
              (u'Problem 5.2: Derive and investigate a generalized logistic model',
               2,
               u'nonlin:exer:logistic:gen',
               u'nonlin:exer:logistic:gen'),
              (u"Problem 5.3: Experience the behavior of Newton's method",
               2,
               u'nonlin:exer:Newton:problems1',
               u'nonlin:exer:Newton:problems1'),
              (u'Exercise 5.4: Compute the Jacobian of a $2\\times 2$ system',
               2,
               u'nonlin:exer:vib:Jacobian',
               u'nonlin:exer:vib:Jacobian'),
              (u'Problem 5.5: Solve nonlinear equations arising from a vibration ODE',
               2,
               u'nonlin:exer:vib:geometric:mean',
               u'nonlin:exer:vib:geometric:mean'),
              (u'Exercise 5.6: Find the truncation error of arithmetic mean of products',
               2,
               u'nonlin:exer:products:arith:mean',
               u'nonlin:exer:products:arith:mean'),
              (u"Problem 5.7: Newton's method for linear problems",
               2,
               u'nonlin:exer:Newton:linear',
               u'nonlin:exer:Newton:linear'),
              (u'Problem 5.8: Discretize a 1D problem with a nonlinear coefficient',
               2,
               u'nonlin:exer:1D:1pu2:fem',
               u'nonlin:exer:1D:1pu2:fem'),
              (u'Problem 5.9: Linearize a 1D problem with a nonlinear coefficient',
               2,
               u'nonlin:exer:1D:1pu2:PicardNewton',
               u'nonlin:exer:1D:1pu2:PicardNewton'),
              (u'Problem 5.10: Finite differences for the 1D Bratu problem',
               2,
               u'nonlin:exer:1D:fu:discretize:fd',
               u'nonlin:exer:1D:fu:discretize:fd'),
              (u'Problem 5.11: Discretize a nonlinear 1D heat conduction PDE by finite differences',
               2,
               u'nonlin:exer:1D:heat:nonlinear:fdm',
               u'nonlin:exer:1D:heat:nonlinear:fdm'),
              (u'Problem 5.12: Differentiate a highly nonlinear term',
               2,
               u'nonlin:exer:grad:pow:term',
               u'nonlin:exer:grad:pow:term'),
              (u'Exercise 5.13: Crank-Nicolson for a nonlinear 3D diffusion equation',
               2,
               u'nonlin:exer:2D:heat:nonlinear:fd',
               u'nonlin:exer:2D:heat:nonlinear:fd'),
              (u'Problem 5.14: Find the sparsity of the Jacobian',
               2,
               u'nonlin:exer:sparsity:Jacobian',
               u'nonlin:exer:sparsity:Jacobian'),
              (u'Problem 5.15: Investigate a 1D problem with a continuation method',
               2,
               u'nonlin:exer:continuation:1DnNflow',
               u'nonlin:exer:continuation:1DnNflow'),
              (u'Appendix: Useful formulas',
               0,
               u'ch:formulas',
               u'ch:formulas'),
              (u'Finite difference operator notation',
               1,
               u'sec:form:fdop',
               u'sec:form:fdop'),
              (u'Truncation errors of finite difference approximations',
               1,
               u'sec:form:truncerr',
               u'sec:form:truncerr'),
              (u'Finite differences of exponential functions',
               1,
               u'sec:form:fdexp',
               u'sec:form:fdexp'),
              (u'Complex exponentials', 3, None, '___sec558'),
              (u'Real exponentials', 3, None, '___sec559'),
              (u'Finite differences of $t^n$',
               1,
               u'sec:form:fdtn',
               u'sec:form:fdtn'),
              (u'Software', 2, None, '___sec561'),
              (u'Appendix: Truncation error analysis',
               0,
               u'ch:trunc',
               u'ch:trunc'),
              (u'Overview of truncation error analysis',
               1,
               None,
               '___sec563'),
              (u'Abstract problem setting', 2, None, '___sec564'),
              (u'Error measures', 2, None, '___sec565'),
              (u'Truncation errors in finite difference formulas',
               1,
               u'trunc:finite:differences',
               u'trunc:finite:differences'),
              (u"Example: The backward difference for $u'(t)$",
               2,
               u'trunc:fd:backward',
               u'trunc:fd:backward'),
              (u"Example: The forward difference for $u'(t)$",
               2,
               u'trunc:fd:forward',
               u'trunc:fd:forward'),
              (u"Example: The central difference for $u'(t)$",
               2,
               u'trunc:fd:central',
               u'trunc:fd:central'),
              (u'Overview of leading-order error terms in finite difference formulas',
               2,
               u'trunc:table',
               u'trunc:table'),
              (u'Software for computing truncation errors',
               2,
               u'trunc:sympy',
               u'trunc:sympy'),
              (u'Exponential decay ODEs', 1, u'trunc:decay', u'trunc:decay'),
              (u'Forward Euler scheme',
               2,
               u'trunc:decay:FE',
               u'trunc:decay:FE'),
              (u'Crank-Nicolson scheme',
               2,
               u'trunc:decay:CN',
               u'trunc:decay:CN'),
              (u'The $\\theta$-rule',
               2,
               u'trunc:decay:theta',
               u'trunc:decay:theta'),
              (u'Using symbolic software',
               2,
               u'trunc:decay:software',
               u'trunc:decay:software'),
              (u'Empirical verification of the truncation error',
               2,
               u'trunc:decay:estimate:R',
               u'trunc:decay:estimate:R'),
              (u'Increasing the accuracy by adding correction terms',
               2,
               u'trunc:decay:corr',
               u'trunc:decay:corr'),
              (u'Extension to variable coefficients', 2, None, '___sec579'),
              (u'Exact solutions of the finite difference equations',
               2,
               None,
               '___sec580'),
              (u'Computing truncation errors in nonlinear problems',
               2,
               u'trunc:decay:gen',
               u'trunc:decay:gen'),
              (u'Vibration ODEs', 1, u'trunc:vib', u'trunc:vib'),
              (u'Linear model without damping',
               2,
               u'trunc:vib:undamped',
               u'trunc:vib:undamped'),
              (u'The truncation error of a centered finite difference scheme',
               3,
               None,
               '___sec584'),
              (u"The truncation error of approximating $u'(0)$",
               3,
               None,
               '___sec585'),
              (u'Truncation error of the equation for the first step',
               3,
               None,
               '___sec586'),
              (u'Computing correction terms', 3, None, '___sec587'),
              (u'Model with damping and nonlinearity',
               2,
               u'trunc:vib:gen',
               u'trunc:vib:gen'),
              (u'Extension to quadratic damping', 2, None, '___sec589'),
              (u'The general model formulated as first-order ODEs',
               2,
               u'trunc:vib:gen:staggered',
               u'trunc:vib:gen:staggered'),
              (u'A centered scheme on a staggered mesh',
               3,
               None,
               '___sec591'),
              (u'Wave equations', 1, None, '___sec592'),
              (u'Linear wave equation in 1D',
               2,
               u'trunc:wave:1D',
               u'trunc:wave:1D'),
              (u'Finding correction terms',
               2,
               u'trunc:wave:1D:corr',
               u'trunc:wave:1D:corr'),
              (u'Extension to variable coefficients',
               2,
               u'trunc:wave:1D:varcoeff',
               u'trunc:wave:1D:varcoeff'),
              (u'1D wave equation on a staggered mesh', 2, None, '___sec596'),
              (u'Linear wave equation in 2D/3D',
               2,
               u'trunc:wave:2D',
               u'trunc:wave:2D'),
              (u'Diffusion equations', 1, u'trunc:diffu', u'trunc:diffu'),
              (u'Linear diffusion equation in 1D',
               2,
               u'trunc:diffu:1D',
               u'trunc:diffu:1D'),
              (u'The Forward Euler scheme in time', 3, None, '___sec600'),
              (u'The Crank-Nicolson scheme in time', 3, None, '___sec601'),
              (u'Nonlinear diffusion equation in 1D', 2, None, '___sec602'),
              (u'Exercises', 1, None, '___sec603'),
              (u'Exercise B.1: Truncation error of a weighted mean',
               2,
               u'trunc:exer:theta:avg',
               u'trunc:exer:theta:avg'),
              (u'Exercise B.2: Simulate the error of a weighted mean',
               2,
               u'trunc:exer:theta:avg2',
               u'trunc:exer:theta:avg2'),
              (u'Exercise B.3: Verify a truncation error formula',
               2,
               u'trunc:exer:decay:bw2',
               u'trunc:exer:decay:bw2'),
              (u'Problem B.4: Truncation error of the Backward Euler scheme',
               2,
               u'trunc:exer:decay:BE',
               u'trunc:exer:decay:BE'),
              (u'Exercise B.5: Empirical estimation of truncation errors',
               2,
               u'trunc:exer:decay:estimate',
               u'trunc:exer:decay:estimate'),
              (u'Exercise B.6: Correction term for a Backward Euler scheme',
               2,
               u'trunc:exer:decay:corr:BE',
               u'trunc:exer:decay:corr:BE'),
              (u'Problem B.7: Verify the effect of correction terms',
               2,
               u'trunc:exer:decay:corr:verify',
               u'trunc:exer:decay:corr:verify'),
              (u'Problem B.8: Truncation error of the Crank-Nicolson scheme',
               2,
               u'trunc:exer:decay:varcoeff:CN',
               u'trunc:exer:decay:varcoeff:CN'),
              (u"Problem B.9: Truncation error of $u'=f(u,t)$",
               2,
               u'trunc:exer:decay:nonlin:BEFE',
               u'trunc:exer:decay:nonlin:BEFE'),
              (u'Exercise B.10: Truncation error of $[D_t D_tu]^n$',
               2,
               u'trunc:exer:DtDtu',
               u'trunc:exer:DtDtu'),
              (u"Exercise B.11: Investigate the impact of approximating $u'(0)$",
               2,
               u'trunc:exer:vib:ic:fw',
               u'trunc:exer:vib:ic:fw'),
              (u'Problem B.12: Investigate the accuracy of a simplified scheme',
               2,
               u'trunc:exer:vib:fbw',
               u'trunc:exer:vib:fbw'),
              (u'Appendix: Software engineering; wave equation model',
               0,
               u'ch:softeng2',
               u'ch:softeng2'),
              (u'A 1D wave equation simulator', 1, None, '___sec617'),
              (u'Mathematical model', 2, None, '___sec618'),
              (u'Numerical discretization', 2, None, '___sec619'),
              (u'A solver function', 2, None, '___sec620'),
              (u'Saving large arrays in files',
               1,
               u'softeng2:wave1D:filestorage',
               u'softeng2:wave1D:filestorage'),
              (u'Using `savez` to store arrays in files',
               2,
               u'softeng2:wave1D:filestorage:savez',
               u'softeng2:wave1D:filestorage:savez'),
              (u'Storing individual arrays', 3, None, '___sec623'),
              (u'Merging zip archives', 3, None, '___sec624'),
              (u'Reading arrays from zip archives', 3, None, '___sec625'),
              (u'Using `joblib` to store arrays in files',
               2,
               u'softeng2:wave1D:filestorage:joblib',
               u'softeng2:wave1D:filestorage:joblib'),
              (u'Using a hash to create a file or directory name',
               2,
               u'softeng2:wave1D:filestorage:hash',
               u'softeng2:wave1D:filestorage:hash'),
              (u'Software for the 1D wave equation', 1, None, '___sec628'),
              (u'Making hash strings from input data',
               2,
               u'softeng2:wave1D:filestorage:hashlib',
               u'softeng2:wave1D:filestorage:hashlib'),
              (u'Avoiding rerunning previously run cases',
               2,
               u'softeng2:wave1D:filestorage:norerun',
               u'softeng2:wave1D:filestorage:norerun'),
              (u'Verification', 2, None, '___sec631'),
              (u'Vanishing approximation error', 3, None, '___sec632'),
              (u'Convergence rates', 3, None, '___sec633'),
              (u'Programming the solver with classes', 1, None, '___sec634'),
              (u'Class Problem', 2, None, '___sec635'),
              (u'Class Mesh', 2, None, '___sec636'),
              (u'Class Function', 2, None, '___sec637'),
              (u'Class Solver', 2, None, '___sec638'),
              (u'Migrating loops to Cython',
               1,
               u'wave2D3D:impl:Cython',
               u'wave2D3D:impl:Cython'),
              (u'Declaring variables and annotating the code',
               2,
               None,
               '___sec640'),
              (u'Visual inspection of the C translation',
               2,
               None,
               '___sec641'),
              (u'Building the extension module', 2, None, '___sec642'),
              (u'Calling the Cython function from Python',
               2,
               None,
               '___sec643'),
              (u'Efficiency', 3, None, '___sec644'),
              (u'Migrating loops to Fortran', 1, None, '___sec645'),
              (u'The Fortran subroutine', 2, None, '___sec646'),
              (u'Building the Fortran module with f2py',
               2,
               None,
               '___sec647'),
              (u'How to avoid array copying', 2, None, '___sec648'),
              (u'Efficiency', 3, None, '___sec649'),
              (u'Migrating loops to C via Cython', 1, None, '___sec650'),
              (u'Translating index pairs to single indices',
               2,
               None,
               '___sec651'),
              (u'The complete C code', 2, None, '___sec652'),
              (u'The Cython interface file', 2, None, '___sec653'),
              (u'Building the extension module', 2, None, '___sec654'),
              (u'Efficiency', 3, None, '___sec655'),
              (u'Migrating loops to C via f2py', 1, None, '___sec656'),
              (u'Migrating loops to C++ via f2py', 2, None, '___sec657'),
              (u'Exercises', 1, None, '___sec658'),
              (u'Exercise C.1: Explore computational efficiency of numpy.sum versus built-in sum',
               2,
               u'softeng2:exer:sum',
               u'softeng2:exer:sum'),
              (u'Exercise C.2: Make an improved `numpy.savez` function',
               2,
               u'softeng2:exer:savez',
               u'softeng2:exer:savez'),
              (u'Exercise C.3: Visualize the impact of the Courant number',
               2,
               u'softeng2:exer:pulse1D:C',
               u'softeng2:exer:pulse1D:C'),
              (u'Exercise C.4: Visualize the impact of the resolution',
               2,
               u'softeng2:exer:pulse1D:Nx',
               u'softeng2:exer:pulse1D:Nx'),
              (u'References', 1, None, '___sec663')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\newcommand{\half}{\frac{1}{2}}
\newcommand{\halfi}{{1/2}}
\newcommand{\tp}{\thinspace .}
\newcommand{\uex}{{u_{\small\mbox{e}}}}
\newcommand{\uexd}[1]{{u_{\small\mbox{e}, #1}}}
\newcommand{\vex}{{v_{\small\mbox{e}}}}
\newcommand{\Aex}{{A_{\small\mbox{e}}}}
\newcommand{\E}[1]{\hbox{E}\lbrack #1 \rbrack}
\newcommand{\Var}[1]{\hbox{Var}\lbrack #1 \rbrack}
\newcommand{\xpoint}{\boldsymbol{x}}
\newcommand{\normalvec}{\boldsymbol{n}}
\newcommand{\Oof}[1]{\mathcal{O}(#1)}
\newcommand{\x}{\boldsymbol{x}}
\renewcommand{\u}{\boldsymbol{u}}
\renewcommand{\v}{\boldsymbol{v}}
\newcommand{\acc}{\boldsymbol{a}}
\newcommand{\rpos}{\boldsymbol{r}}
\newcommand{\e}{\boldsymbol{e}}
\newcommand{\f}{\boldsymbol{f}}
\newcommand{\F}{\boldsymbol{F}}
\newcommand{\stress}{\boldsymbol{\sigma}}
\newcommand{\I}{\boldsymbol{I}}
\newcommand{\T}{\boldsymbol{T}}
\newcommand{\q}{\boldsymbol{q}}
\newcommand{\g}{\boldsymbol{g}}
\newcommand{\dfc}{\alpha}  % diffusion coefficient
\newcommand{\ii}{\boldsymbol{i}}
\newcommand{\jj}{\boldsymbol{j}}
\newcommand{\kk}{\boldsymbol{k}}
\newcommand{\ir}{\boldsymbol{i}_r}
\newcommand{\ith}{\boldsymbol{i}_{\theta}}
\newcommand{\Ix}{\mathcal{I}_x}
\newcommand{\Iy}{\mathcal{I}_y}
\newcommand{\Iz}{\mathcal{I}_z}
\newcommand{\It}{\mathcal{I}_t}
\newcommand{\setb}[1]{#1^0}    % set begin
\newcommand{\sete}[1]{#1^{-1}} % set end
\newcommand{\setl}[1]{#1^-}
\newcommand{\setr}[1]{#1^+}
\newcommand{\seti}[1]{#1^i}
\newcommand{\stepzero}{*}
\newcommand{\stephalf}{***}
\newcommand{\stepone}{**}
\newcommand{\baspsi}{\psi}
\newcommand{\dx}{\, \mathrm{d}x}
\newcommand{\ds}{\, \mathrm{d}s}
\newcommand{\Real}{\mathbb{R}}
\newcommand{\Integer}{\mathbb{Z}}
$$




    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href=".trash82dee82e1274a586571086dca04d00308d3a0d86.html">Finite Difference Computing with PDEs - A Modern Software Approach</a>
  </div>

  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86002.html#table_of_contents" style="font-size: 80%;"><b>Table of contents</b></a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86001.html#ch:preface" style="font-size: 80%;"><b>Preface</b></a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86001.html#___sec1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Why finite differences?</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86001.html#___sec2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Simplify, understand, generalize</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86001.html#___sec3" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constructive mathematics</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86001.html#___sec4" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;All nuts and bolts</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86001.html#___sec5" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Python as programming language</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86001.html#___sec6" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Program verification</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86001.html#___sec7" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vectorized code</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86001.html#___sec8" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Analysis via exact solutions of discrete equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86001.html#___sec9" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Code-inspired mathematical notation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86001.html#___sec10" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Limited scope</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86001.html#___sec11" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Focus on wave phenomena</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86001.html#___sec12" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Independent chapters</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86001.html#___sec13" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Supplementary materials</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86001.html#___sec14" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Acknowledgments</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#ch:vib" style="font-size: 80%;"><b>Vibration ODEs</b></a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:model1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Finite difference discretization</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec17" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A basic model for vibrations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:ode1:fdm" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A centered finite difference scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec19" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Step 1: Discretizing the domain</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec20" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Step 2: Fulfilling the equation at discrete time points</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec21" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Step 3: Replacing derivatives by finite differences</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec22" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Step 4: Formulating a recursive algorithm</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec23" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Computing the first step</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec24" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The computational algorithm</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec25" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Operator notation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:impl1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Implementation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:impl1:solver" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Making a solver function</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec28" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Computing \( u^{\prime} \)</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:ode1:verify" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verification</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec30" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Manual calculation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec31" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Testing very simple polynomial solutions</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec32" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checking convergence rates</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec33" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Visualizing convergence rates with slope markers</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec34" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaled model</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:ode1:longseries" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Visualization of long time simulations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec36" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Using a moving plot window</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:ode1:anim" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Making animations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec38" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Producing standard video formats</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec39" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Playing PNG files in a web browser</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec40" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Making animated GIF files</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec41" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Using Bokeh to compare graphs</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec42" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Using a line-by-line ascii plotter</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:ode1:empirical" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Empirical analysis of the solution</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:ode1:analysis" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Analysis of the numerical scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:ode1:analysis:solderiv" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Deriving a solution of the numerical scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:ode1:analysis:numfreq" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The error in the numerical frequency</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec47" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Empirical convergence rates and adjusted \( \omega \)</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:ode1:analysis:sol" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exact discrete solution</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:ode1:analysis:conv" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Convergence</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec50" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The global error</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec51" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stability</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec52" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;About the accuracy at the stability limit</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:model2x2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Alternative schemes based on 1st-order equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec54" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Forward Euler scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec55" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Backward Euler scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:undamped:CN" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Crank-Nicolson scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:model2x2:compare" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Comparison of schemes</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec58" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Runge-Kutta methods</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec59" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Analysis of the Forward Euler scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:model1:energy" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Energy considerations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:model1:energy:expr" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Derivation of the energy expression</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec62" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Energy of the exact solution</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec63" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Growth of energy in the Forward Euler scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:model1:energy:measure" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;An error measure based on energy</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:model2x2:EulerCromer" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The Euler-Cromer method</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec66" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Forward-backward discretization</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:model2x2:EulerCromer:equiv" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Equivalence with the scheme for the second-order ODE</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:model2x2:EulerCromer:impl" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec69" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Solver function</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec70" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verification</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec71" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Using Odespy</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec72" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Convergence rates</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:model2x2:StormerVerlet" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Stoermer-Verlet algorithm</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec74" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Staggered mesh</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:model2x2:staggered" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Euler-Cromer scheme on a staggered mesh</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec76" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation of the scheme on a staggered mesh</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec77" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation with integer indices</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec78" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation with half-integer indices</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec79" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises and Problems</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:exer:undamped:verify:linquad" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 1.1: Use linear/quadratic functions for verification</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:exer:phase:err:growth" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 1.2: Show linear growth of the phase with time</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:exer:w:adjust" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 1.3: Improve the accuracy by adjusting the frequency</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:exer:undamped:adaptive" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 1.4: See if adaptive methods improve the phase error</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:exer:step4b:alt" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 1.5: Use a Taylor polynomial to compute \( u^1 \)</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec85" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 1.6: Derive and investigate the velocity Verlet method</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:exer:wdt:limit" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 1.7: Find the minimal resolution of an oscillatory function</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:exer:fd:exp:plot" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 1.8: Visualize the accuracy of finite differences for a cosine function</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:exer:energy:convrate" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 1.9: Verify convergence rates of the error in energy</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:exer:verify:gen:linear" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 1.10: Use linear/quadratic functions for verification</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:exer:discrete:omega" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 1.11: Use an exact discrete solution for verification</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:exer:conv:rate" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 1.12: Use analytical solution for convergence rate tests</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:exer:undamped:odespy" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 1.13: Investigate the amplitude errors of many solvers</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:exer:memsave0" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 1.14: Minimize memory usage of a simple vibration solver</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:exer:memsave" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 1.15: Minimize memory usage of a general vibration solver</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:exer:EC_vs_centered" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 1.16: Implement the Euler-Cromer scheme for the generalized model</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:exer:DtDt:asDtpDtm" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 1.17: Interpret \( [D_tD_t u]^n \) as a forward-backward difference</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#vib:exer:EulerCromer:analysis" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 1.18: Analysis of the Euler-Cromer scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#vib:model2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Generalization: damping, nonlinearities, and excitation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#vib:ode2:fdm:flin" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A centered scheme for linear damping</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#vib:ode2:fdm:fquad" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A centered scheme for quadratic damping</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec101" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A forward-backward discretization of the quadratic damping term</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#vib:ode2:solver" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#vib:ode2:verify" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verification</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec104" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constant solution</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec105" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Linear solution</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec106" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Quadratic solution</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec107" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Catching bugs</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#vib:ode2:viz" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Visualization</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#vib:ode2:ui" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;User interface</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#vib:ode2:EulerCromer" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Euler-Cromer scheme for the generalized model</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#vib:model2x2:gen:StormerVerlet" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Stoermer-Verlet algorithm for the generalized model</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#vib:ode2:staggered" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A staggered Euler-Cromer scheme for a generalized model</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#vib:ode2:PEFRL" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The PEFRL 4th-order accurate algorithm</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec114" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises and Problems</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#vib:exer:gen:class" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 1.19: Implement the solver via classes</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#vib:exer:quad:damping:bw" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 1.20: Use a backward difference for the damping term</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#vib:exer:quad:damping:fwbw" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 1.21: Use the forward-backward scheme with quadratic damping</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#vib:app" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Applications of vibration models</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#vib:app:mass_spring" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Oscillating mass attached to a spring</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec120" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec121" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The physics</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#vib:app:mass_gen" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;General mechanical vibrating system</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec123" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#vib:app:mass_sliding" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A sliding mass attached to a spring</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#vib:app:washmach" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A jumping washing machine</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#vib:app:pendulum" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Motion of a pendulum</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec127" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Simple pendulum</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec128" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Physical pendulum</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#vib:app:pendulum_bodydia" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dynamic free body diagram during pendulum motion</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec130" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Writing the solver</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec131" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Drawing the free body diagram</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec132" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Making the animated free body diagram</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#vib:app:pendulum_elastic" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Motion of an elastic pendulum</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec134" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks about an elastic vs a non-elastic pendulum</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec135" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Initial conditions</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec136" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The complete ODE problem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec137" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec138" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark on the non-elastic limit</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#vib:app:bumpy" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vehicle on a bumpy road</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#vib:app:bouncing_ball" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Bouncing ball</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#vib:app:gravitation" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Two-body gravitational problem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec142" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The governing equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec143" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec144" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Solution in a special case: planet orbiting a star</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec145" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Electric circuits</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec146" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#vib:exer:resonance" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 1.22: Simulate resonance</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#vib:exer:sliding_box" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 1.23: Simulate oscillations of a sliding box</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#vib:exer:bouncing:ball" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 1.24: Simulate a bouncing ball</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#vib:exer:pendulum_simple" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 1.25: Simulate a simple pendulum</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#vib:exer:pendulum_elastic" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 1.26: Simulate an elastic pendulum</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#vib:exer:pendulum_elastic_drag" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 1.27: Simulate an elastic pendulum with air resistance</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec153" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#vib:exer:gen:PEFRL" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 1.28: Implement the PEFRL algorithm</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec155" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#ch:wave" style="font-size: 80%;"><b>Wave equations</b></a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:string" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Simulation of waves on a string</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:string:mesh" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Discretizing the domain</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec159" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Uniform meshes</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:string:numerical:sol" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The discrete solution</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:string:samplingPDE" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Fulfilling the equation at the mesh points</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:string:fd" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Replacing derivatives by finite differences</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec163" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Algebraic version of the PDE</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec164" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Interpretation of the equation as a stencil</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec165" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Algebraic version of the initial conditions</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:string:alg" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Formulating a recursive algorithm</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:string:impl" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sketch of an implementation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec168" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Verification</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:pde2:fd" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A slightly generalized model problem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:pde2:fd:standing:waves" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Using an analytical solution of physical significance</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:pde2:fd:MMS" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Manufactured solution and estimation of convergence rates</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec172" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Specifying the solution and computing corresponding data</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec173" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Defining a single discretization parameter</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec174" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Computing errors</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec175" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Computing rates</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:pde2:fd:verify:quadratic" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constructing an exact solution of the discrete equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:pde1:impl" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Implementation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:pde1:impl:useraction" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Callback function for user-specific actions</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:pde1:impl:solver" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The solver function</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:pde1:impl:verify:quadratic" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verification: exact quadratic solution</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:pde1:impl:verify:rate" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verification: convergence rates</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:pde1:impl:animate" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Visualization: animating the solution</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec183" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Function for administering the simulation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec184" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dissection of the code</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec185" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Making movie files</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec186" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Skipping frames for animation speed</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:pde1:guitar:data" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Running a case</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec188" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Working with a scaled PDE model</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:pde1:impl:vec" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Vectorization</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:pde1:impl:vec:slices:basics" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Operations on slices of arrays</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:pde1:impl:vec:slices:fdm" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Finite difference schemes expressed as slices</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:pde1:impl:vec:verify:quadratic" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verification</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec193" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Efficiency measurements</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec194" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Solution 1</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec195" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Solution 2</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec196" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Efficiency experiments</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:pde1:impl:ref:switch" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark on the updating of arrays</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec198" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:exer:standingwave" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.1: Simulate a standing wave</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec200" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:exer:store:list" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.2: Add storage of solution in a user action function</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:exer:store:list:class" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.3: Use a class for the user action function</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:exer:multiple:C" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.4: Compare several Courant numbers in one movie</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:exer:useraction:generator" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.5: Implementing the solver function as a generator</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:exer:mesh1D:calculus" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Project 2.6: Calculus with 1D mesh functions</a></li>
     <!-- navigation toc: --> <li><a href="#wave:pde2:Neumann" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Generalization: reflecting boundaries</a></li>
     <!-- navigation toc: --> <li><a href="#wave:pde2:Neumann:bc" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Neumann boundary condition</a></li>
     <!-- navigation toc: --> <li><a href="#wave:pde2:Neumann:discr" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Discretization of derivatives at the boundary</a></li>
     <!-- navigation toc: --> <li><a href="#wave:pde2:Neumann:impl" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation of Neumann conditions</a></li>
     <!-- navigation toc: --> <li><a href="#wave:indexset" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Index set notation</a></li>
     <!-- navigation toc: --> <li><a href="#wave:pde1:verify" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verifying the implementation of Neumann conditions</a></li>
     <!-- navigation toc: --> <li><a href="#wave:pde1:Neumann:ghost" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alternative implementation via ghost cells</a></li>
     <!-- navigation toc: --> <li><a href="#___sec213" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Idea</a></li>
     <!-- navigation toc: --> <li><a href="#___sec214" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation</a></li>
     <!-- navigation toc: --> <li><a href="#wave:pde2:var:c" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Generalization: variable wave velocity</a></li>
     <!-- navigation toc: --> <li><a href="#___sec216" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The model PDE with a variable coefficient</a></li>
     <!-- navigation toc: --> <li><a href="#wave:pde2:var:c:ideas" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Discretizing the variable coefficient</a></li>
     <!-- navigation toc: --> <li><a href="#wave:pde2:var:c:means" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Computing the coefficient between mesh points</a></li>
     <!-- navigation toc: --> <li><a href="#wave:pde2:var:c:stability" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;How a variable coefficient affects the stability</a></li>
     <!-- navigation toc: --> <li><a href="#wave:pde2:var:c:Neumann" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Neumann condition and a variable coefficient</a></li>
     <!-- navigation toc: --> <li><a href="#wave:pde2:var:c:impl" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation of variable coefficients</a></li>
     <!-- navigation toc: --> <li><a href="#___sec222" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A more general PDE model with variable coefficients</a></li>
     <!-- navigation toc: --> <li><a href="#___sec223" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Generalization: damping</a></li>
     <!-- navigation toc: --> <li><a href="#wave:pde2:software" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Building a general 1D wave equation solver</a></li>
     <!-- navigation toc: --> <li><a href="#___sec225" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;User action function as a class</a></li>
     <!-- navigation toc: --> <li><a href="#___sec226" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The code</a></li>
     <!-- navigation toc: --> <li><a href="#___sec227" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dissection</a></li>
     <!-- navigation toc: --> <li><a href="#___sec228" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pulse propagation in two media</a></li>
     <!-- navigation toc: --> <li><a href="#___sec229" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises</a></li>
     <!-- navigation toc: --> <li><a href="#wave:exer:standingwave:damped:uex" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.7: Find the analytical solution to a damped wave equation</a></li>
     <!-- navigation toc: --> <li><a href="#wave:exer:symmetry:bc" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.8: Explore symmetry boundary conditions</a></li>
     <!-- navigation toc: --> <li><a href="#wave:app:exer:pulse1D" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.9: Send pulse waves through a layered medium</a></li>
     <!-- navigation toc: --> <li><a href="#wave:app:exer:pulse1D:analysis" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.10: Explain why numerical noise occurs</a></li>
     <!-- navigation toc: --> <li><a href="#wave:app:exer:pulse1D:harmonic" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.11: Investigate harmonic averaging in a 1D model</a></li>
     <!-- navigation toc: --> <li><a href="#wave:app:exer:radiationBC" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.12: Implement open boundary conditions</a></li>
     <!-- navigation toc: --> <li><a href="#___sec236" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="#wave:exer:periodic" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.13: Implement periodic boundary conditions</a></li>
     <!-- navigation toc: --> <li><a href="#___sec238" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.14: Compare discretizations of a Neumann condition</a></li>
     <!-- navigation toc: --> <li><a href="#wave:fd2:exer:verify:cubic" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.15: Verification by a cubic polynomial in space</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#wave:pde1:analysis" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Analysis of the difference equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#wave:pde1:properties" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Properties of the solution of the wave equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#wave:pde1:Fourier" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;More precise definition of Fourier representations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#wave:pde1:stability" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stability</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec244" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Preliminary results</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec245" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Numerical wave propagation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#wave:pde1:num:dispersion" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Numerical dispersion relation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#wave:pde1:analysis:2D3D" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Extending the analysis to 2D and 3D</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#wave:2D3D" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Finite difference methods for 2D and 3D wave equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#wave:2D3D:models" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Multi-dimensional wave equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#wave:2D3D:mesh" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mesh</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#wave:2D3D:discretization" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Discretization</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#___sec252" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Discretizing the PDEs</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#___sec253" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Handling boundary conditions where \( u \) is known</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#___sec254" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Discretizing the Neumann condition</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#wave:2D3D:impl" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Implementation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#wave2D3D:impl:scalar" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scalar computations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#___sec257" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Domain and mesh</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#___sec258" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Solution arrays</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#___sec259" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Index sets</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#___sec260" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Computing the solution</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#wave2D3D:impl:vectorized" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vectorized computations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#wave2D3D:impl:verify" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verification</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#___sec263" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Testing a quadratic solution</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#___sec264" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Visualization</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#___sec265" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Matplotlib</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#___sec266" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gnuplot</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#___sec267" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mayavi</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#___sec268" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#wave:exer:quadratic:2D" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.16: Check that a solution fulfills the discrete model</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#wave:exer:mesh3D:calculus" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Project 2.17: Calculus with 2D mesh functions</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#wave:app:exer:wave2D:Neumann" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.18: Implement Neumann conditions in 2D</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#wave:exer:3D:f77:cy:efficiency" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.19: Test the efficiency of compiled loops in 3D</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#wave:app" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Applications of wave equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#wave:app:string" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Waves on a string</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec275" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Damping</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec276" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;External forcing</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec277" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Modeling the tension via springs</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#wave:app:elastic:rod" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Elastic waves in a rod</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#wave:app:membrane" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Waves on a membrane</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#wave:app:acoustic:seismic" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The acoustic model for seismic waves</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec281" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Anisotropy</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#wave:app:sound" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sound waves in liquids and gases</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#wave:app:spherical" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Spherical waves</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#wave:app:sw:2D" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The linear shallow water equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec285" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Wind drag on the surface</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec286" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Bottom drag</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec287" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Effect of the Earth's rotation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#wave:app:blood" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Waves in blood vessels</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#wave:app:light" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Electromagnetic waves</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86011.html#wave:app:exer" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86011.html#wave:app:exer:string:discont" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.20: Simulate waves on a non-homogeneous string</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86011.html#wave:app:exer:string:damping" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.21: Simulate damped waves on a string</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86011.html#wave:app:exer:rod" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.22: Simulate elastic waves in a rod</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86011.html#wave:app:exer:spherical" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.23: Simulate spherical waves</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86011.html#wave:app:exer:tsunami1D:hill" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.24: Earthquake-generated tsunami over a subsea hill</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86011.html#wave:app:exer:tsunami2D:hill" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.25: Earthquake-generated tsunami over a 3D hill</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86011.html#wave:app:exer:tsunami:hill:viz:matplotlib" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.26: Investigate Mayavi for visualization</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86011.html#wave:app:exer:tsunami:hill:viz:packages" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.27: Investigate visualization packages</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86011.html#wave:app:exer:tsunami2D:hill:compiled" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.28: Implement loops in compiled languages</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86011.html#wave:app:exer:seismic2D" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.29: Simulate seismic waves in 2D</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86011.html#wave:app:exer:acoustics" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Project 2.30: Model 3D acoustic waves in a room</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86011.html#wave:app:exer:advec1D" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Project 2.31: Solve a 1D transport equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86011.html#wave:app:exer:anal:damped:wave1D" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.32: General analytical solution of a 1D damped wave equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86011.html#wave:app:exer:anal:damped:wave2D" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.33: General analytical solution of a 2D damped wave equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#ch:diffu" style="font-size: 80%;"><b>Diffusion equations</b></a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:pde1:FEsec" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;An explicit method for the 1D diffusion equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec307" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The initial-boundary value problem for 1D diffusion</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:pde1:FE" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Forward Euler scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:pde1:FE:code" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:pde1:FE:verify" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verification</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:pde1:FE:verify:exact" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exact solution of discrete equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:pde1:FE:verify:convrates" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checking convergence rates</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:pde1:FE:experiments" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Numerical experiments</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:pde1:implicit" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Implicit methods for the 1D diffusion equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:pde1:BE" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Backward Euler scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:pde1:impl:sparse" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sparse matrix implementation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:pde1:CN" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Crank-Nicolson scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:pde1:theta" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The unifying \( \theta \) rule</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:pde1:theta:experiments" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Experiments</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec320" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Laplace and Poisson equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:pde1:analysis" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Analysis of schemes for the diffusion equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:pde1:analysis:uex" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Properties of the solution</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec323" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Similarity solution</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec324" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Solution for a Gaussian pulse</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec325" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Solution for a sine component</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec326" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Analysis of discrete equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:pde1:analysis:details" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Analysis of the finite difference schemes</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec328" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stability</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec329" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Accuracy</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec330" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Truncation error</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:pde1:analysis:FE" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Analysis of the Forward Euler scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec332" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stability</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec333" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Accuracy</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec334" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Truncation error</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:pde1:analysis:BE" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Analysis of the Backward Euler scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec336" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stability</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec337" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Truncation error</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:pde1:analysis:CN" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Analysis of the Crank-Nicolson scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec339" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stability</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec340" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Truncation error</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:pde1:analysis:leapfrog" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Analysis of the Leapfrog scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec342" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Summary of accuracy of amplification factors</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:2D:analysis" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Analysis of the 2D diffusion equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec344" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Forward Euler scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec345" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Backward Euler scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec346" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Crank-Nicolson scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec347" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Explanation of numerical artifacts</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec348" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:exer:1D:gaussian:symmetric" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 3.1: Explore symmetry in a 1D problem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:exer:1D:ux:onesided" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 3.2: Investigate approximation errors from a \( u_x=0 \) boundary condition</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:exer:1D:openBC" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 3.3: Experiment with open boundary conditions in 1D</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec352" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 3.4: Simulate a diffused Gaussian peak in 2D/3D</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:exer:uterm" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 3.5: Examine stability of a diffusion model with a source term</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:varcoeff" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Diffusion in heterogeneous media</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:varcoeff:discr" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Discretization</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:varcoeff:impl" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:varcoeff:stationary" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stationary solution</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:varcoeff:piecewise" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Piecewise constant medium</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:varcoeff:impl:piecewise" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation of diffusion in a piecewise constant medium</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:fd2:radial" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Axi-symmetric diffusion</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:fd2:spherical" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Spherically-symmetric diffusion</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec362" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Discretization in spherical coordinates</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec363" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Discretization in Cartesian coordinates</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:2D" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Diffusion in 2D</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:2D:discr" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Discretization</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:2D:numbering" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Numbering of mesh points versus equations and unknowns</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:2D:alg" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Algorithm for setting up the coefficient matrix</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:2D:impl:dense" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation with a dense coefficient matrix</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:2D:verify" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verification: exact numerical solution</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:2D:convrate" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verification: convergence rates</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:2D:impl:sparse" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation with a sparse coefficient matrix</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec372" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Understanding the diagonals</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec373" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filling the diagonals</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec374" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filling the right-hand side; scalar version</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec375" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filling the right-hand side; vectorized version</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec376" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verification</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec377" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Jacobi iterative method</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec378" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Numerical scheme and linear system</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec379" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Iterations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec380" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Initial guess</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec381" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relaxation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec382" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stopping criteria</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec383" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Code-friendly notation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec384" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Generalization of the scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:2D:Jacobi:impl" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation of the Jacobi method</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:2D:Jacobi:impl:hill" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Test problem: diffusion of a sine hill</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:2D:Jacobi_vs_FE" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The relaxed Jacobi method and its relation to the Forward Euler method</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:2D:SOR" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Gauss-Seidel and SOR methods</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:2D:SOR:impl:scalar" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scalar implementation of the SOR method</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:2D:SOR:impl:vectorized" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vectorized implementation of the SOR method</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:2D:direct_vs_iter" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Direct versus iterative methods</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec392" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Direct methods</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec393" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Iterative methods</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:2D:CG" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Conjugate gradient method</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec395" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;What is the recommended method for solving linear systems?</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:randomwalk" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Random walk</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:randomwalk:1D" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Random walk in 1D</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:randomwalk:1D:EVar" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Statistical considerations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:randomwalk:1D:code1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Playing around with some code</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec400" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scalar code</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec401" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vectorized code</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec402" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Fixing the random sequence</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec403" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verification</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:randomwalk:1D:pde" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Equivalence with diffusion</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec405" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation of multiple walks</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec406" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scalar version</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec407" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vectorized version</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec408" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Improved vectorized version</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec409" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark on vectorized code and parallelization</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec410" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Test function</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec411" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Demonstration of multiple walks</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:randomwalk:1D:avplotter" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ascii visualization of 1D random walk</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:randomwalk:1D:ode" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Random walk as a stochastic equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec414" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Random walk in 2D</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec415" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Random walk in any number of space dimensions</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec416" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Multiple random walks in any number of space dimensions</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec417" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scalar code</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec418" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vectorized code</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:app" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Applications</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:app:substance" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Diffusion of a substance</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:app:heat" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Heat conduction</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:app:porous" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Porous media flow</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec423" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Potential fluid flow</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec424" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Streamlines for 2D fluid flow</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec425" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The potential of an electric field</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:app:Couette" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Development of flow between two flat plates</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:app:pipeflow" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Flow in a straight tube</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec428" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Tribology: thin film fluid flow</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec429" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Propagation of electrical signals in the brain</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#___sec430" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:exer:CN:Rannacher" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 3.6: Stabilizing the Crank-Nicolson method by Rannacher time stepping</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:exer:energy:estimates" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Project 3.7: Energy estimates for diffusion problems</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:exer:splitting_prec" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 3.8: Splitting methods and preconditioning</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:exer:earthosc" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 3.9: Oscillating surface temperature of the earth</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:exer:bloodflow" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 3.10: Oscillating and pulsating flow in tubes</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:exer:welding" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 3.11: Scaling a welding problem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86012.html#diffu:exer:axisymm" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 3.12: Implement a Forward Euler scheme for axi-symmetric diffusion</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#ch:convdiff" style="font-size: 80%;"><b>Advection-dominated equations</b></a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#advec:1D" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;One-dimensional time-dependent advection equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#advec:1D:FTCS" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Simplest scheme: forward in time, centered in space</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#___sec441" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Method</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#___sec442" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#___sec443" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Test cases</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#___sec444" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Bug?</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#advec:1D:FTCS:anal" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Analysis of the scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#advec:1D:leapfrog" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Leapfrog in time, centered differences in space</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#___sec447" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Method</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#___sec448" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#___sec449" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Running a test case</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#___sec450" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Running more test cases</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#___sec451" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Analysis</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#advec:1D:FTUP" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Upwind differences in space</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#advec:1D:periodic_BC" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Periodic boundary conditions</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#___sec454" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#___sec455" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Test condition</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#___sec456" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The code</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#___sec457" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Solving a specific problem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#advec:1D:CN" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A Crank-Nicolson discretization in time and centered differences in space</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#advec:1D:LaxW" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Lax-Wendroff method</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#advec:1D:disprel" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Analysis of dispersion relations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#advec:1D:stationary" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;One-dimensional stationary advection-diffusion equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#advec:1D:stationary:model" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A simple model problem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#advec:1D:stationary:fdm" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A centered finite difference scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#advec:1D:stationary:upwind" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remedy: upwind finite difference scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#___sec465" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Time-dependent convection-diffusion equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#___sec466" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Analytical insight</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#___sec467" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Forward in time, centered in space scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#___sec468" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Forward in time, upwind in space scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#advec:2D" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Two-dimensional advection-diffusion equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#advec:app" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Applications of advection equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#advec:app:mass" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Transport of a substance</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#advec:app:heat" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Transport of a heat</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#___sec473" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#advec:1D:stationary:exer:analysis1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 4.1: Analyze 1D stationary convection-diffusion problem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86013.html#advec:1D:stationary:exer:analysis2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 4.2: Interpret upwind difference as artificial diffusion</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86014.html#ch:nonlin" style="font-size: 80%;"><b>Nonlinear problems</b></a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86014.html#nonlin:timediscrete:logistic" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Introduction of basic concepts</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86014.html#___sec478" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Linear versus nonlinear equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86014.html#___sec479" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Algebraic equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86014.html#___sec480" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Differential equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86014.html#___sec481" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A simple model problem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86014.html#nonlin:timediscrete:logistic:FE" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Linearization by explicit time discretization</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86014.html#nonlin:timediscrete:logistic:roots" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exact solution of nonlinear algebraic equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86014.html#___sec484" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Linearization</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86014.html#nonlin:timediscrete:logistic:Picard" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Picard iteration</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86014.html#___sec486" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stopping criteria</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86014.html#___sec487" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A single Picard iteration</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86014.html#nonlin:timediscrete:logistic:geometric:mean" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Linearization by a geometric mean</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86014.html#nonlin:timediscrete:logistic:Newton" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Newton's method</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86014.html#nonlin:timediscrete:logistic:relaxation" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relaxation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86014.html#nonlin:timediscrete:logistic:impl" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation and experiments</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86014.html#nonlin:ode:generic" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Generalization to a general nonlinear ODE</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86014.html#___sec493" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Explicit time discretization</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86014.html#___sec494" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Backward Euler discretization</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86014.html#___sec495" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Crank-Nicolson discretization</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86014.html#nonlin:ode:generic:sys:pendulum" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Systems of ODEs</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86014.html#___sec497" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86015.html#nonlin:systems:alg" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Systems of nonlinear algebraic equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86015.html#nonlin:systems:alg:Picard" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Picard iteration</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86015.html#nonlin:systems:alg:Newton" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Newton's method</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86015.html#nonlin:systems:alg:terminate" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stopping criteria</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86015.html#nonlin:systems:alg:SI" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example: A nonlinear ODE model from epidemiology</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86015.html#___sec503" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implicit time discretization</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86015.html#___sec504" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A Picard iteration</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86015.html#___sec505" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Newton's method</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86016.html#nonlin:pdelevel" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Linearization at the differential equation level</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86016.html#nonlin:pdelevel:explicit" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Explicit time integration</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86016.html#nonlin:pdelevel:Picard" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Backward Euler scheme and Picard iteration</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86016.html#nonlin:pdelevel:Newton" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Backward Euler scheme and Newton's method</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86016.html#___sec510" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Linearization via Taylor expansions</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86016.html#___sec511" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Similarity with Picard iteration</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86016.html#___sec512" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86016.html#___sec513" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Derivation with alternative notation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86016.html#nonlin:pdelevel:Picard:CN" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Crank-Nicolson discretization</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86017.html#nonlin:alglevel:1D" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;1D stationary nonlinear differential equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86017.html#nonlin:alglevel:1D:fd" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Finite difference discretization</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86017.html#___sec517" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Solution of algebraic equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86017.html#___sec518" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The structure of the equation system</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86017.html#___sec519" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Picard iteration</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86017.html#___sec520" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mesh with two cells</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86017.html#___sec521" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Newton's method</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86018.html#___sec522" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Multi-dimensional nonlinear PDE problems</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86018.html#nonlin:alglevel:dD:fd" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Finite difference discretization</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86018.html#___sec524" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Picard iteration</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86018.html#___sec525" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Newton's method</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86018.html#___sec526" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Continuation methods</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86019.html#nonlin:splitting" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Operator splitting methods</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86019.html#nonlin:splitting:ODE" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ordinary operator splitting for ODEs</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86019.html#nonlin:splitting:ODE_Strang" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Strang splitting for ODEs</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86019.html#nonlin:splitting:logistic" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example: Logistic growth</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86019.html#___sec531" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Splitting techniques</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86019.html#___sec532" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verbose implementation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86019.html#___sec533" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Compact implementation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86019.html#___sec534" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Results</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86019.html#nonlin:splitting:RD" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reaction-diffusion equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86019.html#nonlin:splitting:RD_linearR" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example: Reaction-Diffusion with linear reaction term</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86019.html#___sec537" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Analysis of the splitting method</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86020.html#nonlin:exer" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86020.html#nonlin:exer:lin:vs:nonlin" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 5.1: Determine if equations are nonlinear or not</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86020.html#nonlin:exer:logistic:gen" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 5.2: Derive and investigate a generalized logistic model</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86020.html#nonlin:exer:Newton:problems1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 5.3: Experience the behavior of Newton's method</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86020.html#nonlin:exer:vib:Jacobian" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 5.4: Compute the Jacobian of a \( 2\times 2 \) system</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86020.html#nonlin:exer:vib:geometric:mean" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 5.5: Solve nonlinear equations arising from a vibration ODE</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86020.html#nonlin:exer:products:arith:mean" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 5.6: Find the truncation error of arithmetic mean of products</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86020.html#nonlin:exer:Newton:linear" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 5.7: Newton's method for linear problems</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86020.html#nonlin:exer:1D:1pu2:fem" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 5.8: Discretize a 1D problem with a nonlinear coefficient</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86020.html#nonlin:exer:1D:1pu2:PicardNewton" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 5.9: Linearize a 1D problem with a nonlinear coefficient</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86020.html#nonlin:exer:1D:fu:discretize:fd" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 5.10: Finite differences for the 1D Bratu problem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86020.html#nonlin:exer:1D:heat:nonlinear:fdm" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 5.11: Discretize a nonlinear 1D heat conduction PDE by finite differences</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86020.html#nonlin:exer:grad:pow:term" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 5.12: Differentiate a highly nonlinear term</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86020.html#nonlin:exer:2D:heat:nonlinear:fd" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 5.13: Crank-Nicolson for a nonlinear 3D diffusion equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86020.html#nonlin:exer:sparsity:Jacobian" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 5.14: Find the sparsity of the Jacobian</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86020.html#nonlin:exer:continuation:1DnNflow" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 5.15: Investigate a 1D problem with a continuation method</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86021.html#ch:formulas" style="font-size: 80%;"><b>Appendix: Useful formulas</b></a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86021.html#sec:form:fdop" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Finite difference operator notation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86021.html#sec:form:truncerr" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Truncation errors of finite difference approximations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86021.html#sec:form:fdexp" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Finite differences of exponential functions</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86021.html#___sec558" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Complex exponentials</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86021.html#___sec559" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Real exponentials</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86021.html#sec:form:fdtn" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Finite differences of \( t^n \)</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86021.html#___sec561" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86022.html#ch:trunc" style="font-size: 80%;"><b>Appendix: Truncation error analysis</b></a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86022.html#___sec563" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Overview of truncation error analysis</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86022.html#___sec564" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Abstract problem setting</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86022.html#___sec565" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error measures</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86022.html#trunc:finite:differences" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Truncation errors in finite difference formulas</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86022.html#trunc:fd:backward" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example: The backward difference for \( u'(t) \)</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86022.html#trunc:fd:forward" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example: The forward difference for \( u'(t) \)</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86022.html#trunc:fd:central" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example: The central difference for \( u'(t) \)</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86022.html#trunc:table" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Overview of leading-order error terms in finite difference formulas</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86022.html#trunc:sympy" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software for computing truncation errors</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86023.html#trunc:decay" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exponential decay ODEs</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86023.html#trunc:decay:FE" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Forward Euler scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86023.html#trunc:decay:CN" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Crank-Nicolson scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86023.html#trunc:decay:theta" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The \( \theta \)-rule</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86023.html#trunc:decay:software" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Using symbolic software</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86023.html#trunc:decay:estimate:R" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Empirical verification of the truncation error</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86023.html#trunc:decay:corr" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Increasing the accuracy by adding correction terms</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86023.html#___sec579" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Extension to variable coefficients</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86023.html#___sec580" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exact solutions of the finite difference equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86023.html#trunc:decay:gen" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Computing truncation errors in nonlinear problems</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86024.html#trunc:vib" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Vibration ODEs</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86024.html#trunc:vib:undamped" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Linear model without damping</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86024.html#___sec584" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The truncation error of a centered finite difference scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86024.html#___sec585" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The truncation error of approximating \( u'(0) \)</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86024.html#___sec586" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Truncation error of the equation for the first step</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86024.html#___sec587" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Computing correction terms</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86024.html#trunc:vib:gen" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Model with damping and nonlinearity</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86024.html#___sec589" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Extension to quadratic damping</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86024.html#trunc:vib:gen:staggered" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The general model formulated as first-order ODEs</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86024.html#___sec591" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A centered scheme on a staggered mesh</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86025.html#___sec592" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Wave equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86025.html#trunc:wave:1D" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Linear wave equation in 1D</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86025.html#trunc:wave:1D:corr" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Finding correction terms</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86025.html#trunc:wave:1D:varcoeff" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Extension to variable coefficients</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86025.html#___sec596" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1D wave equation on a staggered mesh</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86025.html#trunc:wave:2D" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Linear wave equation in 2D/3D</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86026.html#trunc:diffu" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Diffusion equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86026.html#trunc:diffu:1D" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Linear diffusion equation in 1D</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86026.html#___sec600" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Forward Euler scheme in time</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86026.html#___sec601" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Crank-Nicolson scheme in time</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86026.html#___sec602" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nonlinear diffusion equation in 1D</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86026.html#___sec603" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86026.html#trunc:exer:theta:avg" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise B.1: Truncation error of a weighted mean</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86026.html#trunc:exer:theta:avg2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise B.2: Simulate the error of a weighted mean</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86026.html#trunc:exer:decay:bw2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise B.3: Verify a truncation error formula</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86026.html#trunc:exer:decay:BE" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem B.4: Truncation error of the Backward Euler scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86026.html#trunc:exer:decay:estimate" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise B.5: Empirical estimation of truncation errors</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86026.html#trunc:exer:decay:corr:BE" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise B.6: Correction term for a Backward Euler scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86026.html#trunc:exer:decay:corr:verify" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem B.7: Verify the effect of correction terms</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86026.html#trunc:exer:decay:varcoeff:CN" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem B.8: Truncation error of the Crank-Nicolson scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86026.html#trunc:exer:decay:nonlin:BEFE" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem B.9: Truncation error of \( u'=f(u,t) \)</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86026.html#trunc:exer:DtDtu" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise B.10: Truncation error of \( [D_t D_tu]^n \)</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86026.html#trunc:exer:vib:ic:fw" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise B.11: Investigate the impact of approximating \( u'(0) \)</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86026.html#trunc:exer:vib:fbw" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem B.12: Investigate the accuracy of a simplified scheme</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#ch:softeng2" style="font-size: 80%;"><b>Appendix: Software engineering; wave equation model</b></a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec617" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;A 1D wave equation simulator</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec618" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mathematical model</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec619" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Numerical discretization</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec620" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A solver function</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#softeng2:wave1D:filestorage" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Saving large arrays in files</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#softeng2:wave1D:filestorage:savez" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Using <code>savez</code> to store arrays in files</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec623" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Storing individual arrays</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec624" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Merging zip archives</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec625" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reading arrays from zip archives</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#softeng2:wave1D:filestorage:joblib" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Using <code>joblib</code> to store arrays in files</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#softeng2:wave1D:filestorage:hash" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Using a hash to create a file or directory name</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec628" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Software for the 1D wave equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#softeng2:wave1D:filestorage:hashlib" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Making hash strings from input data</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#softeng2:wave1D:filestorage:norerun" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Avoiding rerunning previously run cases</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec631" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verification</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec632" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vanishing approximation error</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec633" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Convergence rates</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec634" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Programming the solver with classes</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec635" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Class Problem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec636" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Class Mesh</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec637" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Class Function</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec638" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Class Solver</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#wave2D3D:impl:Cython" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Migrating loops to Cython</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec640" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Declaring variables and annotating the code</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec641" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Visual inspection of the C translation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec642" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Building the extension module</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec643" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calling the Cython function from Python</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec644" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Efficiency</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec645" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Migrating loops to Fortran</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec646" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Fortran subroutine</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec647" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Building the Fortran module with f2py</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec648" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;How to avoid array copying</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec649" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Efficiency</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec650" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Migrating loops to C via Cython</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec651" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Translating index pairs to single indices</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec652" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The complete C code</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec653" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Cython interface file</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec654" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Building the extension module</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec655" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Efficiency</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec656" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Migrating loops to C via f2py</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec657" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Migrating loops to C++ via f2py</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#___sec658" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#softeng2:exer:sum" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise C.1: Explore computational efficiency of numpy.sum versus built-in sum</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#softeng2:exer:savez" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise C.2: Make an improved <code>numpy.savez</code> function</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#softeng2:exer:pulse1D:C" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise C.3: Visualize the impact of the Courant number</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#softeng2:exer:pulse1D:Nx" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise C.4: Visualize the impact of the resolution</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86028.html#___sec663" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;References</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0007"></a>
<!-- !split -->

<h1 id="wave:pde2:Neumann" class="anchor">Generalization: reflecting boundaries</h1>

<p>
The boundary condition \( u=0 \) in a wave equation reflects the wave, but
\( u \) changes sign at the boundary, while the condition \( u_x=0 \) reflects
the wave as a mirror and preserves the sign, see a <a href="http://tinyurl.com/pu5uyfn/pub/pub/wave/html/mov-wave/demo_BC_gaussian/index.html" target="_self">web page</a> or a
<a href="http://tinyurl.com/pu5uyfn/pub/pub/wave/html/mov-wave/demo_BC_gaussian/movie.flv" target="_self">movie file</a> for
demonstration.

<p>
Our next task is to explain how to implement the boundary
condition \( u_x=0 \), which is
more complicated to express numerically and also to implement than
a given value of \( u \).
We shall present two methods for implementing \( u_x=0 \)
in a finite difference scheme, one based on deriving a modified
stencil at the boundary, and another one based on extending the mesh
with ghost cells and ghost points.

<h2 id="wave:pde2:Neumann:bc" class="anchor">Neumann boundary condition</h2>

<p>
When a wave hits a boundary and is to be reflected back, one applies
the condition

$$
\begin{equation}
 \frac{\partial u}{\partial n} \equiv \normalvec\cdot\nabla u = 0
\tag{2.35}
\tp
\end{equation}
$$

The derivative \( \partial /\partial n \) is in the
outward normal direction from a general boundary.
For a 1D domain \( [0,L] \),
we have that

$$
\left.\frac{\partial}{\partial n}\right\vert_{x=L} =
\left.\frac{\partial}{\partial x}\right\vert_{x=L},\quad
\left.\frac{\partial}{\partial n}\right\vert_{x=0} = -
\left.\frac{\partial}{\partial x}\right\vert_{x=0}\tp
$$

<p>
<div class="alert alert-block alert-success alert-text-normal"><b>Boundary condition terminology.</b>
Boundary conditions
that specify the value of \( \partial u/\partial n \)
(or shorter \( u_n \)) are known as
<a href="http://en.wikipedia.org/wiki/Neumann_boundary_condition" target="_self">Neumann</a> conditions, while <a href="http://en.wikipedia.org/wiki/Dirichlet_conditions" target="_self">Dirichlet conditions</a>
refer to specifications of \( u \).
When the values are zero (\( \partial u/\partial n=0 \) or \( u=0 \)) we speak
about <em>homogeneous</em> Neumann or Dirichlet conditions.
</div>


<h2 id="wave:pde2:Neumann:discr" class="anchor">Discretization of derivatives at the boundary</h2>

<p>
How can we incorporate the condition <a href="#mjx-eqn-2.35">(2.35)</a>
in the finite difference scheme?  Since we have used central
differences in all the other approximations to derivatives in the
scheme, it is tempting to implement <a href="#mjx-eqn-2.35">(2.35)</a> at
\( x=0 \) and \( t=t_n \) by the difference

$$
\begin{equation}
[D_{2x} u]^n_0 = \frac{u_{-1}^n - u_n^n}{2\Delta x} = 0
\tp
\tag{2.36}
\end{equation}
$$

The problem is that \( u_{-1}^n \) is not a \( u \) value that is being
computed since the point is outside the mesh. However, if we combine
<a href="#mjx-eqn-2.36">(2.36)</a> with the scheme
<!-- <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#mjx-eqn-2.14">(2.14)</a> -->
for \( i=0 \),

$$
\begin{equation}
u^{n+1}_i = -u^{n-1}_i + 2u^n_i + C^2
\left(u^{n}_{i+1}-2u^{n}_{i} + u^{n}_{i-1}\right),
\tag{2.37}
\end{equation}
$$

we can eliminate the fictitious value \( u_{-1}^n \). We see that
\( u_{-1}^n=u_n^n \) from <a href="#mjx-eqn-2.36">(2.36)</a>, which
can be used in <a href="#mjx-eqn-2.37">(2.37)</a> to
arrive at a modified scheme for the boundary point \( u_0^{n+1} \):

$$
\begin{equation}
u^{n+1}_i = -u^{n-1}_i  + 2u^n_i + 2C^2
\left(u^{n}_{i+1}-u^{n}_{i}\right),\quad i=0 \tp   \tag{2.38}
\end{equation}
$$

Figure <a href="#wave:pde1:fig:Neumann:stencil">27</a> visualizes this equation
for computing \( u^3_0 \) in terms of \( u^2_0 \), \( u^1_0 \), and
\( u^2_1 \).

<p>
<center> <!-- figure label: --> <div id="wave:pde1:fig:Neumann:stencil"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 27:  Modified stencil at a boundary with a Neumann condition.  <!-- caption label: wave:pde1:fig:Neumann:stencil --> </p></center>
<p><img src="mov-wave/N_stencil_gpl/stencil_n_left.png" align="bottom" width=500></p>
</center>

<p>
Similarly, <a href="#mjx-eqn-2.35">(2.35)</a> applied at \( x=L \)
is discretized by a central difference

$$
\begin{equation}
\frac{u_{N_x+1}^n - u_{N_x-1}^n}{2\Delta x} = 0
\tp
\tag{2.39}
\end{equation}
$$

Combined with the scheme for \( i=N_x \) we get a modified scheme for
the boundary value \( u_{N_x}^{n+1} \):

$$
\begin{equation}
u^{n+1}_i = -u^{n-1}_i + 2u^n_i + 2C^2
\left(u^{n}_{i-1}-u^{n}_{i}\right),\quad i=N_x \tp   \tag{2.40}
\end{equation}
$$

<p>
The modification of the scheme at the boundary is also required for
the special formula for the first time step. How the stencil moves
through the mesh and is modified at the boundary can be illustrated by
an animation in a <a href="http://tinyurl.com/pu5uyfn/pub/pub/wave/html/mov-wave/N_stencil_gpl/index.html" target="_self">web page</a>
or a <a href="http://tinyurl.com/pu5uyfn/pub/pub/wave/html/mov-wave/N_stencil_gpl/movie.ogg" target="_self">movie file</a>.

<h2 id="wave:pde2:Neumann:impl" class="anchor">Implementation of Neumann conditions</h2>

<p>
We have seen in the preceding section
that the special formulas for the boundary points
arise from replacing \( u_{i-1}^n \) by \( u_{i+1}^n \) when computing
\( u_i^{n+1} \) from the stencil formula for \( i=0 \). Similarly, we
replace \( u_{i+1}^n \) by \( u_{i-1}^n \) in the stencil formula
for \( i=N_x \). This observation can conveniently
be used in the coding: we just work with the general stencil formula,
but write the code such that it is easy to replace <code>u[i-1]</code> by
<code>u[i+1]</code> and vice versa. This is achieved by
having the indices <code>i+1</code> and <code>i-1</code> as variables <code>ip1</code> (<code>i</code> plus 1)
and <code>im1</code> (<code>i</code> minus 1), respectively.
At the boundary we can easily define <code>im1=i+1</code> while we use
<code>im1=i-1</code> in the internal parts of the mesh. Here are the details
of the implementation (note that the updating formula for <code>u[i]</code>
is the general stencil formula):

<p>

<!-- code=text (!bc cod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>i = 0
ip1 = i+1
im1 = ip1  # i-1 -&gt; i+1
u[i] = u_n[i] + C2*(u_n[im1] - 2*u_n[i] + u_n[ip1])

i = Nx
im1 = i-1
ip1 = im1  # i+1 -&gt; i-1
u[i] = u_n[i] + C2*(u_n[im1] - 2*u_n[i] + u_n[ip1])
</pre></div>
<p>
We can in fact create one loop over both the internal and boundary
points and use only one updating formula:

<p>

<!-- code=text (!bc cod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>for i in range(0, Nx+1):
    ip1 = i+1 if i &lt; Nx else i-1
    im1 = i-1 if i &gt; 0  else i+1
    u[i] = u_n[i] + C2*(u_n[im1] - 2*u_n[i] + u_n[ip1])
</pre></div>
<p>
The program <a href="http://tinyurl.com/nu656p2/wave/wave1D/wave1D_n0.py" target="_self"><tt>wave1D_n0.py</tt></a>
contains a complete implementation of the 1D wave equation with
boundary conditions \( u_x = 0 \) at \( x=0 \) and \( x=L \).

<p>
It would be nice to modify the <code>test_quadratic</code> test case from the
<code>wave1D_u0.py</code> with Dirichlet conditions, described in the section <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:pde1:impl:vec:verify:quadratic">Verification</a>. However, the Neumann
conditions require the polynomial variation in the \( x \) direction to
be of third degree, which causes challenging problems when
designing a test where the numerical solution is known exactly.
<a href="#wave:fd2:exer:verify:cubic">Exercise 2.15: Verification by a cubic polynomial in space</a> outlines ideas and code
for this purpose. The only test in <code>wave1D_n0.py</code> is to start
with a plug wave at rest and see that the initial condition is
reached again perfectly after one period of motion, but such
a test requires \( C=1 \) (so the numerical solution coincides with
the exact solution of the PDE, see the section <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#wave:pde1:num:dispersion">Numerical dispersion relation</a>).

<h2 id="wave:indexset" class="anchor">Index set notation</h2>

<p>
To improve our mathematical writing and our implementations,
it is wise to introduce a special notation for index sets. This means
that we write
\( x_i \), followed by \( i\in\Ix \), instead of \( i=0,\ldots,N_x \).
Obviously, \( \Ix \) must be the index set \( \Ix =\{0,\ldots,N_x\} \), but it
is often advantageous to have a symbol for this set rather than
specifying all its elements (all the time, as we have done up to
now). This new notation saves writing and makes
specifications of algorithms and their implementation as computer code
simpler.

<p>
The first index in the set will be denoted \( \setb{\Ix} \)
and the last \( \sete{\Ix} \). When we need to skip the first element of
the set, we use \( \setr{\Ix} \) for the remaining subset
\( \setr{\Ix}=\{1,\ldots,N_x\} \). Similarly, if the last element is
to be dropped, we write \( \setl{\Ix}=\{0,\ldots,N_x-1\} \) for the
remaining indices.
All the
indices corresponding to inner grid points are specified by
\( \seti{\Ix}=\{1,\ldots,N_x-1\} \).  For the time domain we find it
natural to explicitly use 0 as the first index, so we will usually
write \( n=0 \) and \( t_0 \) rather than \( n=\It^0 \). We also avoid notation
like \( x_{\sete{\Ix}} \) and will instead use \( x_i \), \( i=\sete{\Ix} \).

<p>
The Python code associated with index sets applies the following
conventions:

<p>

<div class="row">
  <div class="col-xs-4">
    <table class="table table-striped table-hover table-condensed">
<thead>
<tr><td align="center"><b>    Notation    </b></td> <td align="center"><b>        Python       </b></td> </tr>
</thead>
<tbody>
<tr><td align="left">   \( \Ix \)           </td> <td align="left">   <code>Ix</code>          </td> </tr>
<tr><td align="left">   \( \setb{\Ix} \)    </td> <td align="left">   <code>Ix[0]</code>       </td> </tr>
<tr><td align="left">   \( \sete{\Ix} \)    </td> <td align="left">   <code>Ix[-1]</code>      </td> </tr>
<tr><td align="left">   \( \setl{\Ix} \)    </td> <td align="left">   <code>Ix[:-1]</code>     </td> </tr>
<tr><td align="left">   \( \setr{\Ix} \)    </td> <td align="left">   <code>Ix[1:]</code>      </td> </tr>
<tr><td align="left">   \( \seti{\Ix} \)    </td> <td align="left">   <code>Ix[1:-1]</code>    </td> </tr>
</tbody>
    </table>
  </div> <!-- col-xs-4 -->
</div> <!-- cell row -->
<p>
<div class="alert alert-block alert-success alert-text-normal"><b>Why index sets are useful.</b>
An important feature of the index set notation is that it
keeps our formulas and code independent of how
we count mesh points. For example, the notation \( i\in\Ix \) or \( i=\setb{\Ix} \)
remains the same whether \( \Ix \) is defined as above or as starting at 1,
i.e., \( \Ix=\{1,\ldots,Q\} \). Similarly, we can in the code define
<code>Ix=range(Nx+1)</code> or <code>Ix=range(1,Q)</code>, and expressions
like <code>Ix[0]</code> and <code>Ix[1:-1]</code> remain correct. One application where
the index set notation is convenient is
conversion of code from a language where arrays has base index 0 (e.g.,
Python and C) to languages where the base index is 1 (e.g., MATLAB and
Fortran). Another important application is implementation of
Neumann conditions via ghost points (see next section).
</div>


<p>
For the current problem setting in the \( x,t \) plane, we work with
the index sets

$$
\begin{equation}
\Ix = \{0,\ldots,N_x\},\quad \It = \{0,\ldots,N_t\},
\tag{2.41}
\end{equation}
$$

defined in Python as

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>Ix <span style="color: #666666">=</span> <span style="color: #008000">range</span>(<span style="color: #666666">0</span>, Nx<span style="color: #666666">+1</span>)
It <span style="color: #666666">=</span> <span style="color: #008000">range</span>(<span style="color: #666666">0</span>, Nt<span style="color: #666666">+1</span>)
</pre></div>
<p>
A finite difference scheme can with the index set notation be specified as

$$
\begin{align*}
u_i^{n+1} &= u^n_i - \half
C^2\left(u^{n}_{i+1}-2u^{n}_{i} + u^{n}_{i-1}\right),\quad,
i\in\seti{\Ix},\ n=0,\\ 
u^{n+1}_i &= -u^{n-1}_i  + 2u^n_i + C^2
\left(u^{n}_{i+1}-2u^{n}_{i}+u^{n}_{i-1}\right),
\quad i\in\seti{\Ix},\ n\in\seti{\It},\\ 
u_i^{n+1} &= 0,
\quad i=\setb{\Ix},\ n\in\setl{\It},\\ 
u_i^{n+1} &= 0,
\quad i=\sete{\Ix},\ n\in\setl{\It}\tp
\end{align*}
$$

The corresponding implementation becomes

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #408080; font-style: italic"># Initial condition</span>
<span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> Ix[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>]:
    u[i] <span style="color: #666666">=</span> u_n[i] <span style="color: #666666">-</span> <span style="color: #666666">0.5*</span>C2<span style="color: #666666">*</span>(u_n[i<span style="color: #666666">-1</span>] <span style="color: #666666">-</span> <span style="color: #666666">2*</span>u_n[i] <span style="color: #666666">+</span> u_n[i<span style="color: #666666">+1</span>])

<span style="color: #408080; font-style: italic"># Time loop</span>
<span style="color: #008000; font-weight: bold">for</span> n <span style="color: #AA22FF; font-weight: bold">in</span> It[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>]:
    <span style="color: #408080; font-style: italic"># Compute internal points</span>
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> Ix[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>]:
        u[i] <span style="color: #666666">=</span> <span style="color: #666666">-</span> u_nm1[i] <span style="color: #666666">+</span> <span style="color: #666666">2*</span>u_n[i] <span style="color: #666666">+</span> \ 
               C2<span style="color: #666666">*</span>(u_n[i<span style="color: #666666">-1</span>] <span style="color: #666666">-</span> <span style="color: #666666">2*</span>u_n[i] <span style="color: #666666">+</span> u_n[i<span style="color: #666666">+1</span>])
    <span style="color: #408080; font-style: italic"># Compute boundary conditions</span>
    i <span style="color: #666666">=</span> Ix[<span style="color: #666666">0</span>];  u[i] <span style="color: #666666">=</span> <span style="color: #666666">0</span>
    i <span style="color: #666666">=</span> Ix[<span style="color: #666666">-1</span>]; u[i] <span style="color: #666666">=</span> <span style="color: #666666">0</span>
</pre></div>
<p>
<div class="alert alert-block alert-success alert-text-normal"><b>Notice.</b>
The program <a href="http://tinyurl.com/nu656p2/wave/wave1D/wave1D_dn.py" target="_self"><tt>wave1D_dn.py</tt></a>
applies the index set notation and
solves the 1D wave equation \( u_{tt}=c^2u_{xx}+f(x,t) \) with
quite general boundary and initial conditions:

<ul>
  <li> \( x=0 \): \( u=U_0(t) \) or \( u_x=0 \)</li>
  <li> \( x=L \): \( u=U_L(t) \) or \( u_x=0 \)</li>
  <li> \( t=0 \): \( u=I(x) \)</li>
  <li> \( t=0 \): \( u_t=V(x) \)</li>
</ul>

The program combines Dirichlet and Neumann conditions, scalar and vectorized
implementation of schemes, and the index set notation into one piece of code.
A lot of test examples are also included in the program:

<ul>
 <li> A rectangular plug-shaped initial condition. (For \( C=1 \) the solution
   will be a rectangle that jumps one cell per time step, making the case
   well suited for verification.)</li>
 <li> A Gaussian function as initial condition.</li>
 <li> A triangular profile as initial condition, which resembles the
   typical initial shape of a guitar string.</li>
 <li> A sinusoidal variation of \( u \) at \( x=0 \) and either \( u=0 \) or
   \( u_x=0 \) at \( x=L \).</li>
 <li> An exact analytical solution \( u(x,t)=\cos(m\pi t/L)\sin({\half}m\pi x/L) \), which can be used for convergence rate tests.</li>
</ul>
</div>


<p>

<!-- begin inline comment -->
<font color="red">(<b>hpl 13</b>: Should include some experiments here or make exercises. Qualitative behavior of the wave equation can be exemplified.)</font>
<!-- end inline comment -->

<h2 id="wave:pde1:verify" class="anchor">Verifying the implementation of Neumann conditions</h2>

<p>
How can we test that the Neumann conditions are correctly implemented?
The <code>solver</code> function in the <code>wave1D_dn.py</code> program described in the
box above accepts Dirichlet or Neumann conditions at \( x=0 \) and \( x=L \).
It is tempting to apply a quadratic solution as described in
the sections <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:pde2:fd">A slightly generalized model problem</a> and <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:pde1:impl:verify:quadratic">Verification: exact quadratic solution</a>,
but it turns out that this solution is no longer an exact solution
of the discrete equations if a Neumann condition is implemented on
the boundary. A linear solution does not help since we only have
homogeneous Neumann conditions in <code>wave1D_dn.py</code>, and we are
consequently left with testing just a constant solution: \( u=\hbox{const} \).

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_constant</span>():
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    Check the scalar and vectorized versions for</span>
<span style="color: #BA2121; font-style: italic">    a constant u(x,t). We simulate in [0, L] and apply</span>
<span style="color: #BA2121; font-style: italic">    Neumann and Dirichlet conditions at both ends.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    u_const <span style="color: #666666">=</span> <span style="color: #666666">0.45</span>
    u_exact <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> x, t: u_const
    I <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> x: u_exact(x, <span style="color: #666666">0</span>)
    V <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> x: <span style="color: #666666">0</span>
    f <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> x, t: <span style="color: #666666">0</span>

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">assert_no_error</span>(u, x, t, n):
        u_e <span style="color: #666666">=</span> u_exact(x, t[n])
        diff <span style="color: #666666">=</span> np<span style="color: #666666">.</span>abs(u <span style="color: #666666">-</span> u_e)<span style="color: #666666">.</span>max()
        msg <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;diff=</span><span style="color: #BB6688; font-weight: bold">%E</span><span style="color: #BA2121">, t_</span><span style="color: #BB6688; font-weight: bold">%d</span><span style="color: #BA2121">=</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> (diff, n, t[n])
        tol <span style="color: #666666">=</span> <span style="color: #666666">1E-13</span>
        <span style="color: #008000; font-weight: bold">assert</span> diff <span style="color: #666666">&lt;</span> tol, msg

    <span style="color: #008000; font-weight: bold">for</span> U_0 <span style="color: #AA22FF; font-weight: bold">in</span> (<span style="color: #008000">None</span>, <span style="color: #008000; font-weight: bold">lambda</span> t: u_const):
        <span style="color: #008000; font-weight: bold">for</span> U_L <span style="color: #AA22FF; font-weight: bold">in</span> (<span style="color: #008000">None</span>, <span style="color: #008000; font-weight: bold">lambda</span> t: u_const):
            L <span style="color: #666666">=</span> <span style="color: #666666">2.5</span>
            c <span style="color: #666666">=</span> <span style="color: #666666">1.5</span>
            C <span style="color: #666666">=</span> <span style="color: #666666">0.75</span>
            Nx <span style="color: #666666">=</span> <span style="color: #666666">3</span>  <span style="color: #408080; font-style: italic"># Very coarse mesh for this exact test</span>
            dt <span style="color: #666666">=</span> C<span style="color: #666666">*</span>(L<span style="color: #666666">/</span>Nx)<span style="color: #666666">/</span>c
            T <span style="color: #666666">=</span> <span style="color: #666666">18</span>  <span style="color: #408080; font-style: italic"># long time integration</span>

            solver(I, V, f, c, U_0, U_L, L, dt, C, T,
                   user_action<span style="color: #666666">=</span>assert_no_error,
                   version<span style="color: #666666">=</span><span style="color: #BA2121">&#39;scalar&#39;</span>)
            solver(I, V, f, c, U_0, U_L, L, dt, C, T,
                   user_action<span style="color: #666666">=</span>assert_no_error,
                   version<span style="color: #666666">=</span><span style="color: #BA2121">&#39;vectorized&#39;</span>)
            <span style="color: #008000; font-weight: bold">print</span> U_0, U_L
</pre></div>
<p>
The quadratic solution is very useful for testing, but it requires
Dirichlet conditions at both ends.

<p>
Another test may utilize the fact that the approximation error vanishes
when the Courant number is unity. We can, for example, start with a
plug profile as initial condition, let this wave split into two plug waves,
one in each direction, and check that the two plug waves come back and
form the initial condition again after &quot;one period&quot; of the solution
process. Neumann conditions can be applied at both ends. A proper
test function reads

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_plug</span>():
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Check that an initial plug is correct back after one period.&quot;&quot;&quot;</span>
    L <span style="color: #666666">=</span> <span style="color: #666666">1.0</span>
    c <span style="color: #666666">=</span> <span style="color: #666666">0.5</span>
    dt <span style="color: #666666">=</span> (L<span style="color: #666666">/10</span>)<span style="color: #666666">/</span>c  <span style="color: #408080; font-style: italic"># Nx=10</span>
    I <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> x: <span style="color: #666666">0</span> <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">abs</span>(x<span style="color: #666666">-</span>L<span style="color: #666666">/2.0</span>) <span style="color: #666666">&gt;</span> <span style="color: #666666">0.1</span> <span style="color: #008000; font-weight: bold">else</span> <span style="color: #666666">1</span>

    u_s, x, t, cpu <span style="color: #666666">=</span> solver(
        I<span style="color: #666666">=</span>I,
        V<span style="color: #666666">=</span><span style="color: #008000">None</span>, f<span style="color: #666666">=</span><span style="color: #008000">None</span>, c<span style="color: #666666">=0.5</span>, U_0<span style="color: #666666">=</span><span style="color: #008000">None</span>, U_L<span style="color: #666666">=</span><span style="color: #008000">None</span>, L<span style="color: #666666">=</span>L,
        dt<span style="color: #666666">=</span>dt, C<span style="color: #666666">=1</span>, T<span style="color: #666666">=4</span>, user_action<span style="color: #666666">=</span><span style="color: #008000">None</span>, version<span style="color: #666666">=</span><span style="color: #BA2121">&#39;scalar&#39;</span>)
    u_v, x, t, cpu <span style="color: #666666">=</span> solver(
        I<span style="color: #666666">=</span>I,
        V<span style="color: #666666">=</span><span style="color: #008000">None</span>, f<span style="color: #666666">=</span><span style="color: #008000">None</span>, c<span style="color: #666666">=0.5</span>, U_0<span style="color: #666666">=</span><span style="color: #008000">None</span>, U_L<span style="color: #666666">=</span><span style="color: #008000">None</span>, L<span style="color: #666666">=</span>L,
        dt<span style="color: #666666">=</span>dt, C<span style="color: #666666">=1</span>, T<span style="color: #666666">=4</span>, user_action<span style="color: #666666">=</span><span style="color: #008000">None</span>, version<span style="color: #666666">=</span><span style="color: #BA2121">&#39;vectorized&#39;</span>)
    tol <span style="color: #666666">=</span> <span style="color: #666666">1E-13</span>
    diff <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(u_s <span style="color: #666666">-</span> u_v)<span style="color: #666666">.</span>max()
    <span style="color: #008000; font-weight: bold">assert</span> diff <span style="color: #666666">&lt;</span> tol
    u_0 <span style="color: #666666">=</span> np<span style="color: #666666">.</span>array([I(x_) <span style="color: #008000; font-weight: bold">for</span> x_ <span style="color: #AA22FF; font-weight: bold">in</span> x])
    diff <span style="color: #666666">=</span> np<span style="color: #666666">.</span>abs(u_s <span style="color: #666666">-</span> u_0)<span style="color: #666666">.</span>max()
    <span style="color: #008000; font-weight: bold">assert</span> diff <span style="color: #666666">&lt;</span> tol
</pre></div>
<p>
Other tests must rely on an unknown approximation error, so effectively
we are left with tests on the convergence rate.

<h2 id="wave:pde1:Neumann:ghost" class="anchor">Alternative implementation via ghost cells</h2>

<h3 id="___sec213" class="anchor">Idea </h3>

<p>
Instead of modifying the scheme at the boundary, we can introduce
extra points outside the domain such that the fictitious values
\( u_{-1}^n \) and \( u_{N_x+1}^n \) are defined in the mesh.  Adding the
intervals \( [-\Delta x,0] \) and \( [L, L+\Delta x] \), known as <em>ghost
cells</em>, to the mesh gives us all the needed mesh points, corresponding
to \( i=-1,0,\ldots,N_x,N_x+1 \).  The extra points with \( i=-1 \) and
\( i=N_x+1 \) are known as <em>ghost points</em>, and values at these points,
\( u_{-1}^n \) and \( u_{N_x+1}^n \), are called <em>ghost values</em>.

<p>
The important idea is
to ensure that we always have
$$ u_{-1}^n = u_{1}^n\hbox{ and } u_{N_x+1}^n = u_{N_x-1}^n,$$

because then
the application of the standard scheme at a boundary point \( i=0 \) or \( i=N_x \)
will be correct and guarantee that the solution is compatible with the
boundary condition \( u_x=0 \).

<p>
Some readers may find it strange to just extend the domain with ghost
cells as a general technique, because in some problems there is a
completely different medium with different physics and equations right
outside of a boundary. Nevertheless, one should view the ghost cell
technique as a purely mathematical technique, which is valid in the
limit \( \Delta xrightarrow 0 \) and helps us to implement derivatives.

<h3 id="___sec214" class="anchor">Implementation </h3>

<p>
The <code>u</code> array now needs extra elements corresponding to the ghost
points. Two new point values are needed:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>u   <span style="color: #666666">=</span> zeros(Nx<span style="color: #666666">+3</span>)
</pre></div>
<p>
The arrays <code>u_n</code> and <code>u_nm1</code> must be defined accordingly.

<p>
Unfortunately, a major indexing problem arises with ghost cells.
The reason is that Python indices <em>must</em> start
at 0 and <code>u[-1]</code> will always mean the last element in <code>u</code>.
This fact gives, apparently, a mismatch between the mathematical
indices \( i=-1,0,\ldots,N_x+1 \) and the Python indices running over
<code>u</code>: <code>0,..,Nx+2</code>. One remedy is to change the mathematical indexing
of \( i \) in the scheme and write

$$ u^{n+1}_i = \cdots,\quad i=1,\ldots,N_x+1,$$

instead of \( i=0,\ldots,N_x \) as we have previously used. The ghost
points now correspond to \( i=0 \) and \( i=N_x+1 \).
A better solution is to use the ideas of the section <a href="#wave:indexset">Index set notation</a>:
we hide the specific index value in an index set and operate with
inner and boundary points using the index set notation.

<p>
To this end, we define <code>u</code> with proper length and <code>Ix</code> to be the corresponding
indices for the real physical mesh points (\( 1,2,\ldots,N_x+1 \)):

<p>

<!-- code=text (!bc cod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>u = zeros(Nx+3)
Ix = range(1, u.shape[0]-1)
</pre></div>
<p>
That is, the boundary points have indices <code>Ix[0]</code> and <code>Ix[-1]</code> (as before).
We first update the solution at all physical mesh points (i.e., interior
points in the mesh):

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> Ix:
    u[i] <span style="color: #666666">=</span> <span style="color: #666666">-</span> u_nm1[i] <span style="color: #666666">+</span> <span style="color: #666666">2*</span>u_n[i] <span style="color: #666666">+</span> \ 
           C2<span style="color: #666666">*</span>(u_n[i<span style="color: #666666">-1</span>] <span style="color: #666666">-</span> <span style="color: #666666">2*</span>u_n[i] <span style="color: #666666">+</span> u_n[i<span style="color: #666666">+1</span>])
</pre></div>
<p>
The indexing becomes a bit more complicated when we call functions like
<code>V(x)</code> and <code>f(x, t)</code>, as we must remember that the appropriate
\( x \) coordinate is given as <code>x[i-Ix[0]]</code>:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> Ix:
    u[i] <span style="color: #666666">=</span> u_n[i] <span style="color: #666666">+</span> dt<span style="color: #666666">*</span>V(x[i<span style="color: #666666">-</span>Ix[<span style="color: #666666">0</span>]]) <span style="color: #666666">+</span> \ 
           <span style="color: #666666">0.5*</span>C2<span style="color: #666666">*</span>(u_n[i<span style="color: #666666">-1</span>] <span style="color: #666666">-</span> <span style="color: #666666">2*</span>u_n[i] <span style="color: #666666">+</span> u_n[i<span style="color: #666666">+1</span>]) <span style="color: #666666">+</span> \ 
           <span style="color: #666666">0.5*</span>dt2<span style="color: #666666">*</span>f(x[i<span style="color: #666666">-</span>Ix[<span style="color: #666666">0</span>]], t[<span style="color: #666666">0</span>])
</pre></div>
<p>
It remains to update the solution at ghost points, i.e, <code>u[0]</code>
and <code>u[-1]</code> (or <code>u[Nx+2]</code>). For a boundary condition \( u_x=0 \),
the ghost value must equal the value at the associated inner mesh
point. Computer code makes this statement precise:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>i <span style="color: #666666">=</span> Ix[<span style="color: #666666">0</span>]          <span style="color: #408080; font-style: italic"># x=0 boundary</span>
u[i<span style="color: #666666">-1</span>] <span style="color: #666666">=</span> u[i<span style="color: #666666">+1</span>]
i <span style="color: #666666">=</span> Ix[<span style="color: #666666">-1</span>]         <span style="color: #408080; font-style: italic"># x=L boundary</span>
u[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> u[i<span style="color: #666666">-1</span>]
</pre></div>
<p>
The physical solution to be plotted is now in <code>u[1:-1]</code>, or
equivalently <code>u[Ix[0]:Ix[-1]+1]</code>, so this slice is
the quantity to be returned from a solver function.
A complete implementation appears in the program
<a href="http://tinyurl.com/nu656p2/wave/wave1D/wave1D_n0_ghost.py" target="_self"><tt>wave1D_n0_ghost.py</tt></a>.

<p>
<div class="alert alert-block alert-danger alert-text-normal"><b>Warning.</b>
We have to be careful with how the spatial and temporal mesh
points are stored. Say we let <code>x</code> be the physical mesh points,

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span>x <span style="color: #666666">=</span> linspace(<span style="color: #666666">0</span>, L, Nx<span style="color: #666666">+1</span>)
</pre></div>
<p>
"Standard coding" of the initial condition,

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> Ix:
    u_n[i] <span style="color: #666666">=</span> I(x[i])
</pre></div>
<p>
becomes wrong, since <code>u_n</code> and <code>x</code> have different lengths and the index <code>i</code>
corresponds to two different mesh points. In fact, <code>x[i]</code> corresponds
to <code>u[1+i]</code>. A correct implementation is

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> Ix:
    u_n[i] <span style="color: #666666">=</span> I(x[i<span style="color: #666666">-</span>Ix[<span style="color: #666666">0</span>]])
</pre></div>
<p>
Similarly, a source term usually coded as <code>f(x[i], t[n])</code> is incorrect
if <code>x</code> is defined to be the physical points, so <code>x[i]</code> must be
replaced by <code>x[i-Ix[0]]</code>.

<p>
An alternative remedy is to let <code>x</code> also cover the ghost points such that
<code>u[i]</code> is the value at <code>x[i]</code>.
</div>


<p>
The ghost cell is only added to the boundary where we have a Neumann
condition. Suppose we have a Dirichlet condition at \( x=L \) and
a homogeneous Neumann condition at \( x=0 \). One ghost cell \( [-\Delta x,0] \)
is added to the mesh, so the index set for the physical points
becomes \( \{1,\ldots,N_x+1\} \). A relevant implementation
is

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>u <span style="color: #666666">=</span> zeros(Nx<span style="color: #666666">+2</span>)
Ix <span style="color: #666666">=</span> <span style="color: #008000">range</span>(<span style="color: #666666">1</span>, u<span style="color: #666666">.</span>shape[<span style="color: #666666">0</span>])
<span style="color: #666666">...</span>
<span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> Ix[:<span style="color: #666666">-1</span>]:
    u[i] <span style="color: #666666">=</span> <span style="color: #666666">-</span> u_nm1[i] <span style="color: #666666">+</span> <span style="color: #666666">2*</span>u_n[i] <span style="color: #666666">+</span> \ 
           C2<span style="color: #666666">*</span>(u_n[i<span style="color: #666666">-1</span>] <span style="color: #666666">-</span> <span style="color: #666666">2*</span>u_n[i] <span style="color: #666666">+</span> u_n[i<span style="color: #666666">+1</span>]) <span style="color: #666666">+</span> \ 
           dt2<span style="color: #666666">*</span>f(x[i<span style="color: #666666">-</span>Ix[<span style="color: #666666">0</span>]], t[n])
i <span style="color: #666666">=</span> Ix[<span style="color: #666666">-1</span>]
u[i] <span style="color: #666666">=</span> U_0       <span style="color: #408080; font-style: italic"># set Dirichlet value</span>
i <span style="color: #666666">=</span> Ix[<span style="color: #666666">0</span>]
u[i<span style="color: #666666">-1</span>] <span style="color: #666666">=</span> u[i<span style="color: #666666">+1</span>]  <span style="color: #408080; font-style: italic"># update ghost value</span>
</pre></div>
<p>
The physical solution to be plotted is now in <code>u[1:]</code>
or (as always) <code>u[Ix[0]:Ix[-1]+1]</code>.

<h1 id="wave:pde2:var:c" class="anchor">Generalization: variable wave velocity</h1>

<p>
Our next generalization of the 1D wave equation <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#mjx-eqn-2.1">(2.1)</a> or
<a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#mjx-eqn-2.17">(2.17)</a> is to allow for a variable wave velocity \( c \):
\( c=c(x) \), usually motivated by wave motion in a domain composed of
different physical media. When the media differ in physical properties
like density or porosity, the wave velocity \( c \) is affected and
will depend on the position in space.
Figure <a href="#wave:pde1:fig:pulse1:two:media">28</a> shows a wave
propagating in one medium \( [0, 0.7]\cup [0.9,1] \) with wave
velocity \( c_1 \) (left) before it enters a second medium \( (0.7,0.9) \)
with wave velocity \( c_2 \) (right). When the wave passes the boundary
where \( c \) jumps from \( c_1 \) to \( c_2 \), a part of the wave is reflected back
into the first medium (the <em>reflected</em> wave), while one part is
transmitted through the second medium (the <em>transmitted</em> wave).

<p>
<center> <!-- figure label: --> <div id="wave:pde1:fig:pulse1:two:media"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 28:  Left: wave entering another medium; right: transmitted and reflected wave.  <!-- caption label: wave:pde1:fig:pulse1:two:media --> </p></center>
<p><img src="fig-wave/pulse1_in_two_media.png" align="bottom" width=800></p>
</center>

<h2 id="___sec216" class="anchor">The model PDE with a variable coefficient </h2>

<p>
Instead of working with the squared quantity \( c^2(x) \), we
shall for notational convenience introduce \( q(x) = c^2(x) \).
A 1D wave equation with variable wave velocity often takes the form

$$
\begin{equation}
\frac{\partial^2 u}{\partial t^2} =
\frac{\partial}{\partial x}\left( q(x)
\frac{\partial u}{\partial x}\right) + f(x,t)
\tag{2.42}
\tp
\end{equation}
$$

This is the most frequent form of a wave
equation with variable wave velocity,
but other forms also appear, see the section <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#wave:app:string">Waves on a string</a>
and equation <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#mjx-eqn-2.141">(2.141)</a>.

<p>
As usual, we sample <a href="#mjx-eqn-2.42">(2.42)</a> at a mesh point,

$$
\frac{\partial^2 }{\partial t^2} u(x_i,t_n) =
\frac{\partial}{\partial x}\left( q(x_i)
\frac{\partial}{\partial x} u(x_i,t_n)\right) + f(x_i,t_n),
$$

where the only new term to discretize is

$$
\frac{\partial}{\partial x}\left( q(x_i)
\frac{\partial}{\partial x} u(x_i,t_n)\right) = \left[
\frac{\partial}{\partial x}\left( q(x)
\frac{\partial u}{\partial x}\right)\right]^n_i
\tp
$$

<h2 id="wave:pde2:var:c:ideas" class="anchor">Discretizing the variable coefficient</h2>

<p>
The principal idea is to first discretize the outer derivative.
Define
$$ \phi = q(x)
\frac{\partial u}{\partial x},
$$

and use a centered derivative around \( x=x_i \) for the derivative of \( \phi \):
$$
\left[\frac{\partial\phi}{\partial x}\right]^n_i
\approx \frac{\phi_{i+\half} - \phi_{i-\half}}{\Delta x}
= [D_x\phi]^n_i
\tp
$$

Then discretize
$$
\phi_{i+\half}  = q_{i+\half}
\left[\frac{\partial u}{\partial x}\right]^n_{i+\half}
\approx q_{i+\half} \frac{u^n_{i+1} - u^n_{i}}{\Delta x}
= [q D_x u]_{i+\half}^n
\tp
$$

Similarly,
$$
\phi_{i-\half}  = q_{i-\half}
\left[\frac{\partial u}{\partial x}\right]^n_{i-\half}
\approx q_{i-\half} \frac{u^n_{i} - u^n_{i-1}}{\Delta x}
= [q D_x u]_{i-\half}^n
\tp
$$

These intermediate results are now combined to
$$
\begin{equation}
\left[
\frac{\partial}{\partial x}\left( q(x)
\frac{\partial u}{\partial x}\right)\right]^n_i
\approx \frac{1}{\Delta x^2}
\left( q_{i+\half} \left({u^n_{i+1} - u^n_{i}}\right)
- q_{i-\half} \left({u^n_{i} - u^n_{i-1}}\right)\right)
\tag{2.43}
\tp
\end{equation}
$$

With operator notation we can write the discretization as
$$
\begin{equation}
\left[
\frac{\partial}{\partial x}\left( q(x)
\frac{\partial u}{\partial x}\right)\right]^n_i
\approx [D_x (\overline{q}^{x} D_x u)]^n_i
\tag{2.44}
\tp
\end{equation}
$$

<p>
<div class="alert alert-block alert-danger alert-text-normal"><b>Do not use the chain rule on the spatial derivative term!</b>
Many are tempted to use the chain rule on the
term \( \frac{\partial}{\partial x}\left( q(x)
\frac{\partial u}{\partial x}\right) \), but this is not a good idea
when discretizing such a term.

<p>
The term with a variable coefficient expresses the net flux
\( qu_x \) into a small volume (i.e., interval in 1D):

$$ \frac{\partial}{\partial x}\left( q(x)
\frac{\partial u}{\partial x}\right) \approx
\frac{1}{\Delta x}(q(x+\Delta x)u_x(x+\Delta x) - q(x)u_x(x))\tp$$

Our discretization reflects this
principle directly: \( qu_x \) at the right end of the cell minus \( qu_x \)
at the left end, because this follows from the formula
<a href="#mjx-eqn-2.43">(2.43)</a> or \( [D_x(q D_x u)]^n_i \).

<p>
When using the chain rule, we get two
terms \( qu_{xx} + q_xu_x \). The typical discretization is

$$
\begin{equation}
D_x q D_x u + D_{2x}q D_{2x} u]_i^n,
\tag{2.45}
\end{equation}
$$

Writing this out shows that it is different from
\( [D_x(q D_x u)]^n_i \) and lacks the physical interpretation of
net flux into a cell. With a smooth and slowly varying \( q(x) \) the
differences between the two discretizations are not substantial.
However, when \( q \) exhibits (potentially large) jumps,
\( [D_x(q D_x u)]^n_i \) with harmonic averaging of \( q \) yields
a better solution than arithmetic averaging or
<a href="#mjx-eqn-2.45">(2.45)</a>.
In the literature, the discretization \( [D_x(q D_x u)]^n_i \) totally
dominates and very few mention the possibility of
<a href="#mjx-eqn-2.45">(2.45)</a>.
</div>


<p>
<!-- Needs some better explanation here - maybe the exact solution of a -->
<!-- poisson type problem (piecewise linear solution) failes if we use -->
<!-- the chain rule? Wesserling has an example, but it is tedious to -->
<!-- work out. -->

<h2 id="wave:pde2:var:c:means" class="anchor">Computing the coefficient between mesh points</h2>

<p>
If \( q \) is a known function of \( x \), we can easily evaluate
\( q_{i+\half} \) simply as \( q(x_{i+\half}) \) with \( x_{i+\half} = x_i +
\half\Delta x \).  However, in many cases \( c \), and hence \( q \), is only
known as a discrete function, often at the mesh points \( x_i \).
Evaluating \( q \) between two mesh points \( x_i \) and \( x_{i+1} \) must then
be done by <em>interpolation</em> techniques, of which three are of
particular interest in this context:

$$
\begin{alignat}{2}
q_{i+\half} &\approx
\half\left( q_{i} + q_{i+1}\right) =
[\overline{q}^{x}]_i
\quad &\hbox{(arithmetic mean)}
\tag{2.46}\\ 
q_{i+\half} &\approx
2\left( \frac{1}{q_{i}} + \frac{1}{q_{i+1}}\right)^{-1}
\quad &\hbox{(harmonic mean)}
\tag{2.47}\\ 
q_{i+\half} &\approx
\left(q_{i}q_{i+1}\right)^{1/2}
\quad &\hbox{(geometric mean)}
\tag{2.48}
\end{alignat}
$$

The arithmetic mean in <a href="#mjx-eqn-2.46">(2.46)</a> is by
far the most commonly used averaging technique and is well suited
for smooth \( q(x) \) functions.
The harmonic mean is often preferred when \( q(x) \) exhibits large
jumps (which is typical for geological media).
The geometric mean is less used, but popular in
discretizations to linearize quadratic
nonlinearities (see the section <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#vib:ode2:fdm:fquad">A centered scheme for quadratic damping</a> for an example).

<p>
With the operator notation from <a href="#mjx-eqn-2.46">(2.46)</a>
we can specify the discretization of the complete variable-coefficient
wave equation in a compact way:
$$
\begin{equation}
\lbrack D_tD_t u = D_x\overline{q}^{x}D_x u + f\rbrack^{n}_i
\tp
\tag{2.49}
\end{equation}
$$

Strictly speaking, \( \lbrack D_x\overline{q}^{x}D_x u\rbrack^{n}_i
= \lbrack D_x (\overline{q}^{x}D_x u)\rbrack^{n}_i \).

<p>
From the compact difference notation we immediately see what kind of differences that
each term is approximated with. The notation \( \overline{q}^{x} \)
also specifies that the variable coefficient is approximated by
an arithmetic mean, the definition being
\( [\overline{q}^{x}]_{i+\half}=(q_i+q_{i+1})/2 \).

<p>
Before implementing, it remains to solve
<a href="#mjx-eqn-2.49">(2.49)</a> with respect to \( u_i^{n+1} \):

$$
\begin{align}
u^{n+1}_i &= - u_i^{n-1}  + 2u_i^n + \nonumber\\ 
&\quad \left(\frac{\Delta t}{\Delta x}\right)^2 \left(
\half(q_{i} + q_{i+1})(u_{i+1}^n - u_{i}^n) -
\half(q_{i} + q_{i-1})(u_{i}^n - u_{i-1}^n)\right)
+ \nonumber\\ 
& \quad \Delta t^2 f^n_i
\tp
\tag{2.50}
\end{align}
$$

<h2 id="wave:pde2:var:c:stability" class="anchor">How a variable coefficient affects the stability</h2>

<p>
The stability criterion derived in the section <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#wave:pde1:stability">Stability</a>
reads \( \Delta t\leq \Delta x/c \). If \( c=c(x) \), the criterion will depend
on the spatial location. We must therefore choose a \( \Delta t \) that
is small enough such that no mesh cell has \( \Delta x/c(x) >\Delta t \).
That is, we must use the largest \( c \) value in the criterion:

$$
\begin{equation}
\Delta t \leq \beta \frac{\Delta x}{\max_{x\in [0,L]}c(x)}
\tp
\tag{2.51}
\end{equation}
$$

The parameter \( \beta \) is included as a safety factor: in some problems with a
significantly varying \( c \) it turns out that one must choose \( \beta < 1 \) to
have stable solutions (\( \beta =0.9 \) may act as an all-round value).

<p>
A different strategy to handle the stability criterion with variable
wave velocity is to use a spatially varying \( \Delta t \). While the idea
is mathematically attractive at first sight, the implementation
quickly becomes very complicated, so we stick to a constant \( \Delta t \)
and a worst case value of \( c(x) \) (with a safety factor \( \beta \)).

<h2 id="wave:pde2:var:c:Neumann" class="anchor">Neumann condition and a variable coefficient</h2>

<p>
Consider a Neumann condition \( \partial u/\partial x=0 \) at \( x=L=N_x\Delta x \),
discretized as

$$ [D_{2x} u]^n_i =
\frac{u_{i+1}^{n} - u_{i-1}^n}{2\Delta x} = 0\quad\Rightarrow\quad
u_{i+1}^n = u_{i-1}^n,
$$

for \( i=N_x \). Using the scheme <a href="#mjx-eqn-2.50">(2.50)</a>
at the end point \( i=N_x \) with \( u_{i+1}^n=u_{i-1}^n \) results in

$$
\begin{align}
u^{n+1}_i &= - u_i^{n-1}  + 2u_i^n + \nonumber\\ 
&\quad \left(\frac{\Delta t}{\Delta x}\right)^2 \left(
q_{i+\half}(u_{i-1}^n - u_{i}^n) -
q_{i-\half}(u_{i}^n - u_{i-1}^n)\right)
+ \Delta t^2 f^n_i
\tag{2.52}\\ 
&= - u_i^{n-1}  + 2u_i^n + \left(\frac{\Delta t}{\Delta x}\right)^2
(q_{i+\half} + q_{i-\half})(u_{i-1}^n - u_{i}^n) +
\Delta t^2 f^n_i
\tag{2.53}\\ 
&\approx - u_i^{n-1}  + 2u_i^n + \left(\frac{\Delta t}{\Delta x}\right)^2
2q_{i}(u_{i-1}^n - u_{i}^n) + \Delta t^2 f^n_i
\tp
\tag{2.54}
\end{align}
$$

Here we used the approximation

$$
\begin{align}
q_{i+\half} + q_{i-\half} &=
q_i + \left(\frac{dq}{dx}\right)_i \Delta x
+ \left(\frac{d^2q}{dx^2}\right)_i \Delta x^2 + \cdots
+\nonumber\\ 
&\quad q_i - \left(\frac{dq}{dx}\right)_i \Delta x
+ \left(\frac{d^2q}{dx^2}\right)_i \Delta x^2 + \cdots\nonumber\\ 
&= 2q_i + 2\left(\frac{d^2q}{dx^2}\right)_i \Delta x^2 + {\cal O}(\Delta x^4)
\nonumber\\ 
&\approx 2q_i
\tp
\tag{2.55}
\end{align}
$$

<p>
An alternative derivation may apply the arithmetic mean of
\( q_{n-\half} \) and \( q_{n+\half} \) in
<a href="#mjx-eqn-2.53">(2.53)</a>, leading to the term

$$ (q_i + \half(q_{i+1}+q_{i-1}))(u_{i-1}^n-u_i^n)\tp$$

Since \( \half(q_{i+1}+q_{i-1}) = q_i + {\cal O}(\Delta x^2) \),
we can approximate with \( 2q_i(u_{i-1}^n-u_i^n) \) for \( i=N_x \) and
get the same term as we did above.

<p>
A common technique when implementing \( \partial u/\partial x=0 \)
boundary conditions, is to assume \( dq/dx=0 \) as well. This implies
\( q_{i+1}=q_{i-1} \) and \( q_{i+1/2}=q_{i-1/2} \) for \( i=N_x \).
The implications for the scheme are

$$
\begin{align}
u^{n+1}_i &= - u_i^{n-1}  + 2u_i^n + \nonumber\\ 
&\quad \left(\frac{\Delta t}{\Delta x}\right)^2 \left(
q_{i+\half}(u_{i-1}^n - u_{i}^n) -
q_{i-\half}(u_{i}^n - u_{i-1}^n)\right)
+ \nonumber\\ 
& \quad \Delta t^2 f^n_i
\tag{2.56}\\ 
&= - u_i^{n-1}  + 2u_i^n + \left(\frac{\Delta t}{\Delta x}\right)^2
2q_{i-\half}(u_{i-1}^n - u_{i}^n) +
\Delta t^2 f^n_i
\tp
\tag{2.57}
\end{align}
$$

<h2 id="wave:pde2:var:c:impl" class="anchor">Implementation of variable coefficients</h2>

<p>
The implementation of the scheme with a variable wave velocity \( q(x)=c^2(x) \)
may assume that \( q \) is available as an array <code>q[i]</code> at
the spatial mesh points. The following loop is a straightforward
implementation of the scheme <a href="#mjx-eqn-2.50">(2.50)</a>:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">1</span>, Nx):
    u[i] <span style="color: #666666">=</span> <span style="color: #666666">-</span> u_nm1[i] <span style="color: #666666">+</span> <span style="color: #666666">2*</span>u_n[i] <span style="color: #666666">+</span> \ 
           C2<span style="color: #666666">*</span>(<span style="color: #666666">0.5*</span>(q[i] <span style="color: #666666">+</span> q[i<span style="color: #666666">+1</span>])<span style="color: #666666">*</span>(u_n[i<span style="color: #666666">+1</span>] <span style="color: #666666">-</span> u_n[i])  <span style="color: #666666">-</span> \ 
               <span style="color: #666666">0.5*</span>(q[i] <span style="color: #666666">+</span> q[i<span style="color: #666666">-1</span>])<span style="color: #666666">*</span>(u_n[i] <span style="color: #666666">-</span> u_n[i<span style="color: #666666">-1</span>])) <span style="color: #666666">+</span> \ 
           dt2<span style="color: #666666">*</span>f(x[i], t[n])
</pre></div>
<p>
The coefficient <code>C2</code> is now defined as <code>(dt/dx)**2</code>, i.e., <em>not</em> as the
squared Courant number, since the wave velocity is variable and appears
inside the parenthesis.

<p>
With Neumann conditions \( u_x=0 \) at the
boundary, we need to combine this scheme with the discrete
version of the boundary condition, as shown in the section <a href="#wave:pde2:var:c:Neumann">Neumann condition and a variable coefficient</a>.
Nevertheless, it would be convenient to reuse the formula for the
interior points and just modify the indices <code>ip1=i+1</code> and <code>im1=i-1</code>
as we did in the section <a href="#wave:pde2:Neumann:impl">Implementation of Neumann conditions</a>. Assuming
\( dq/dx=0 \) at the boundaries, we can implement the scheme at
the boundary with the following code.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>i <span style="color: #666666">=</span> <span style="color: #666666">0</span>
ip1 <span style="color: #666666">=</span> i<span style="color: #666666">+1</span>
im1 <span style="color: #666666">=</span> ip1
u[i] <span style="color: #666666">=</span> <span style="color: #666666">-</span> u_nm1[i] <span style="color: #666666">+</span> <span style="color: #666666">2*</span>u_n[i] <span style="color: #666666">+</span> \ 
       C2<span style="color: #666666">*</span>(<span style="color: #666666">0.5*</span>(q[i] <span style="color: #666666">+</span> q[ip1])<span style="color: #666666">*</span>(u_n[ip1] <span style="color: #666666">-</span> u_n[i])  <span style="color: #666666">-</span> \ 
           <span style="color: #666666">0.5*</span>(q[i] <span style="color: #666666">+</span> q[im1])<span style="color: #666666">*</span>(u_n[i] <span style="color: #666666">-</span> u_n[im1])) <span style="color: #666666">+</span> \ 
       dt2<span style="color: #666666">*</span>f(x[i], t[n])
</pre></div>
<p>
With ghost cells we can just reuse the formula for the interior
points also at the boundary, provided that the ghost values of both
\( u \) and \( q \) are correctly updated to ensure \( u_x=0 \) and \( q_x=0 \).

<p>
A vectorized version of the scheme with a variable coefficient
at internal mesh points becomes

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>u[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>] <span style="color: #666666">=</span> <span style="color: #666666">-</span> u_nm1[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>] <span style="color: #666666">+</span> <span style="color: #666666">2*</span>u_n[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>] <span style="color: #666666">+</span> \ 
          C2<span style="color: #666666">*</span>(<span style="color: #666666">0.5*</span>(q[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>] <span style="color: #666666">+</span> q[<span style="color: #666666">2</span>:])<span style="color: #666666">*</span>(u_n[<span style="color: #666666">2</span>:] <span style="color: #666666">-</span> u_n[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>]) <span style="color: #666666">-</span>
              <span style="color: #666666">0.5*</span>(q[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>] <span style="color: #666666">+</span> q[:<span style="color: #666666">-2</span>])<span style="color: #666666">*</span>(u_n[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>] <span style="color: #666666">-</span> u_n[:<span style="color: #666666">-2</span>])) <span style="color: #666666">+</span> \ 
          dt2<span style="color: #666666">*</span>f(x[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>], t[n])
</pre></div>

<h2 id="___sec222" class="anchor">A more general PDE model with variable coefficients </h2>

<p>
Sometimes a wave PDE has a variable coefficient in front of
the time-derivative term:

$$
\begin{equation}
\varrho(x)\frac{\partial^2 u}{\partial t^2} =
\frac{\partial}{\partial x}\left( q(x)
\frac{\partial u}{\partial x}\right) + f(x,t)
\tag{2.58}
\tp
\end{equation}
$$

One example appears when modeling elastic waves in a rod
with varying density, cf.&nbsp;(<a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#wave:app:string">Waves on a string</a>) with \( \varrho (x) \).

<p>
A natural scheme for <a href="#mjx-eqn-2.58">(2.58)</a> is

$$
\begin{equation}
[\varrho D_tD_t u = D_x\overline{q}^xD_x u + f]^n_i
\tp
\tag{2.59}
\end{equation}
$$

We realize that the \( \varrho \) coefficient poses no particular
difficulty, since \( \varrho \) enters the formula just as a simple factor
in front of a derivative. There is hence no need for any averaging
of \( \varrho \). Often, \( \varrho \) will be moved to the right-hand side,
also without any difficulty:

$$
\begin{equation}
[D_tD_t u = \varrho^{-1}D_x\overline{q}^xD_x u + f]^n_i
\tp
\tag{2.60}
\end{equation}
$$

<h2 id="___sec223" class="anchor">Generalization: damping </h2>

<p>
Waves die out by two mechanisms. In 2D and 3D the energy of the wave
spreads out in space, and energy conservation then requires
the amplitude to decrease. This effect is not present in 1D.
Damping is another cause of amplitude reduction. For example,
the vibrations of a string die out because of damping due to
air resistance and non-elastic effects in the string.

<p>
The simplest way of including damping is to add a first-order derivative
to the equation (in the same way as friction forces enter a vibrating
mechanical system):
$$
\begin{equation}
\frac{\partial^2 u}{\partial t^2} + b\frac{\partial u}{\partial t} =
c^2\frac{\partial^2 u}{\partial x^2}
 + f(x,t),
\tag{2.61}
\end{equation}
$$

where \( b \geq 0 \) is a prescribed damping coefficient.

<p>
A typical discretization of <a href="#mjx-eqn-2.61">(2.61)</a> in terms of centered
differences reads

$$
\begin{equation}
[D_tD_t u + bD_{2t}u = c^2D_xD_x u + f]^n_i
\tp
\tag{2.62}
\end{equation}
$$

Writing out the equation and solving for the unknown \( u^{n+1}_i \)
gives the scheme

$$
\begin{equation}
u^{n+1}_i = (1 + {\half}b\Delta t)^{-1}(({\half}b\Delta t -1)
u^{n-1}_i + 2u^n_i + C^2
\left(u^{n}_{i+1}-2u^{n}_{i} + u^{n}_{i-1}\right) + \Delta t^2 f^n_i),
\tag{2.63}
\end{equation}
$$

for \( i\in\seti{\Ix} \) and \( n\geq 1 \).
New equations must be derived for \( u^1_i \), and for boundary points in case
of Neumann conditions.

<p>
The damping is very small in many wave phenomena and thus only evident
for very long time simulations. This makes the standard wave equation
without damping relevant for a lot of applications.

<h1 id="wave:pde2:software" class="anchor">Building a general 1D wave equation solver</h1>

<p>
The program <a href="http://tinyurl.com/nu656p2/wave/wave1D/wave1D_dn_vc.py" target="_self"><tt>wave1D_dn_vc.py</tt></a>
is a fairly general code for 1D wave propagation problems that
targets the following initial-boundary value problem

$$
\begin{align}
u_{tt} &= (c^2(x)u_x)_x + f(x,t),\quad &x\in (0,L),\ t\in (0,T]
\tag{2.64}\\ 
u(x,0) &= I(x),\quad &x\in [0,L]
\tag{2.65}\\ 
u_t(x,0) &= V(t),\quad &x\in [0,L]
\tag{2.66}\\ 
u(0,t) &= U_0(t)\hbox{ or } u_x(0,t)=0,\quad &t\in (0,T]
\tag{2.67}\\ 
u(L,t) &= U_L(t)\hbox{ or } u_x(L,t)=0,\quad &t\in (0,T]
\tag{2.68}
\end{align}
$$

<p>
The only new feature here is the time-dependent Dirichlet conditions.
These are trivial to implement:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>i <span style="color: #666666">=</span> Ix[<span style="color: #666666">0</span>]  <span style="color: #408080; font-style: italic"># x=0</span>
u[i] <span style="color: #666666">=</span> U_0(t[n<span style="color: #666666">+1</span>])

i <span style="color: #666666">=</span> Ix[<span style="color: #666666">-1</span>] <span style="color: #408080; font-style: italic"># x=L</span>
u[i] <span style="color: #666666">=</span> U_L(t[n<span style="color: #666666">+1</span>])
</pre></div>
<p>
The <code>solver</code> function is a natural extension of the simplest
<code>solver</code> function in the initial <code>wave1D_u0.py</code> program,
extended with Neumann boundary conditions (\( u_x=0 \)),
time-varying Dirichlet conditions, as well as
a variable wave velocity. The different code segments needed
to make these extensions have been shown and commented upon in the
preceding text. We refer to the <code>solver</code> function in the
<code>wave1D_dn_vc.py</code> file for all the details. Note in that
 <code>solver</code> function, however, that the technique of &quot;hashing&quot; is
used to check whether a certain simulation has been run before, or not.
This technique is further explained in the section <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#softeng2:wave1D:filestorage:hash">Using a hash to create a file or directory name</a>.

<p>
The vectorization is only applied inside the time loop, not for the
initial condition or the first time steps, since this initial work
is negligible for long time simulations in 1D problems.

<p>
The following sections explain various more advanced programming
techniques applied in the general 1D wave equation solver.

<h2 id="___sec225" class="anchor">User action function as a class </h2>

<p>
A useful feature in the <code>wave1D_dn_vc.py</code> program is the specification
of the <code>user_action</code> function as a class. This part of the program may
need some motivation and explanation. Although the <code>plot_u_st</code>
function (and the <code>PlotMatplotlib</code> class) in the <code>wave1D_u0.viz</code>
function remembers the local variables in the <code>viz</code> function, it is a
cleaner solution to store the needed variables together with the
function, which is exactly what a class offers.

<h3 id="___sec226" class="anchor">The code </h3>

<p>
A class for flexible plotting, cleaning up files, making movie
files, like the function <code>wave1D_u0.viz</code> did, can be coded as follows:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">PlotAndStoreSolution</span>:
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    Class for the user_action function in solver.</span>
<span style="color: #BA2121; font-style: italic">    Visualizes the solution only.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(
        <span style="color: #008000">self</span>,
        casename<span style="color: #666666">=</span><span style="color: #BA2121">&#39;tmp&#39;</span>,    <span style="color: #408080; font-style: italic"># Prefix in filenames</span>
        umin<span style="color: #666666">=-1</span>, umax<span style="color: #666666">=1</span>,   <span style="color: #408080; font-style: italic"># Fixed range of y axis</span>
        pause_between_frames<span style="color: #666666">=</span><span style="color: #008000">None</span>,  <span style="color: #408080; font-style: italic"># Movie speed</span>
        backend<span style="color: #666666">=</span><span style="color: #BA2121">&#39;matplotlib&#39;</span>,       <span style="color: #408080; font-style: italic"># or &#39;gnuplot&#39; or None</span>
        screen_movie<span style="color: #666666">=</span><span style="color: #008000">True</span>, <span style="color: #408080; font-style: italic"># Show movie on screen?</span>
        title<span style="color: #666666">=</span><span style="color: #BA2121">&#39;&#39;</span>,          <span style="color: #408080; font-style: italic"># Extra message in title</span>
        skip_frame<span style="color: #666666">=1</span>,      <span style="color: #408080; font-style: italic"># Skip every skip_frame frame</span>
        filename<span style="color: #666666">=</span><span style="color: #008000">None</span>):    <span style="color: #408080; font-style: italic"># Name of file with solutions</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>casename <span style="color: #666666">=</span> casename
        <span style="color: #008000">self</span><span style="color: #666666">.</span>yaxis <span style="color: #666666">=</span> [umin, umax]
        <span style="color: #008000">self</span><span style="color: #666666">.</span>pause <span style="color: #666666">=</span> pause_between_frames
        <span style="color: #008000">self</span><span style="color: #666666">.</span>backend <span style="color: #666666">=</span> backend
        <span style="color: #008000; font-weight: bold">if</span> backend <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000">None</span>:
            <span style="color: #408080; font-style: italic"># Use native matplotlib</span>
            <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span>
        <span style="color: #008000; font-weight: bold">elif</span> backend <span style="color: #AA22FF; font-weight: bold">in</span> (<span style="color: #BA2121">&#39;matplotlib&#39;</span>, <span style="color: #BA2121">&#39;gnuplot&#39;</span>):
            module <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;scitools.easyviz.&#39;</span> <span style="color: #666666">+</span> backend <span style="color: #666666">+</span> <span style="color: #BA2121">&#39;_&#39;</span>
            <span style="color: #008000; font-weight: bold">exec</span>(<span style="color: #BA2121">&#39;import </span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121"> as plt&#39;</span> <span style="color: #666666">%</span> module)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>plt <span style="color: #666666">=</span> plt
        <span style="color: #008000">self</span><span style="color: #666666">.</span>screen_movie <span style="color: #666666">=</span> screen_movie
        <span style="color: #008000">self</span><span style="color: #666666">.</span>title <span style="color: #666666">=</span> title
        <span style="color: #008000">self</span><span style="color: #666666">.</span>skip_frame <span style="color: #666666">=</span> skip_frame
        <span style="color: #008000">self</span><span style="color: #666666">.</span>filename <span style="color: #666666">=</span> filename
        <span style="color: #008000; font-weight: bold">if</span> filename <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">None</span>:
            <span style="color: #408080; font-style: italic"># Store time points when u is written to file</span>
            <span style="color: #008000">self</span><span style="color: #666666">.</span>t <span style="color: #666666">=</span> []
            filenames <span style="color: #666666">=</span> glob<span style="color: #666666">.</span>glob(<span style="color: #BA2121">&#39;.&#39;</span> <span style="color: #666666">+</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>filename <span style="color: #666666">+</span> <span style="color: #BA2121">&#39;*.dat.npz&#39;</span>)
            <span style="color: #008000; font-weight: bold">for</span> filename <span style="color: #AA22FF; font-weight: bold">in</span> filenames:
                os<span style="color: #666666">.</span>remove(filename)

        <span style="color: #408080; font-style: italic"># Clean up old movie frames</span>
        <span style="color: #008000; font-weight: bold">for</span> filename <span style="color: #AA22FF; font-weight: bold">in</span> glob<span style="color: #666666">.</span>glob(<span style="color: #BA2121">&#39;frame_*.png&#39;</span>):
            os<span style="color: #666666">.</span>remove(filename)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__call__</span>(<span style="color: #008000">self</span>, u, x, t, n):
        <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">        Callback function user_action, call by solver:</span>
<span style="color: #BA2121; font-style: italic">        Store solution, plot on screen and save to file.</span>
<span style="color: #BA2121; font-style: italic">        &quot;&quot;&quot;</span>
        <span style="color: #408080; font-style: italic"># Save solution u to a file using numpy.savez</span>
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>filename <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">None</span>:
            name <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;u</span><span style="color: #BB6688; font-weight: bold">%04d</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> n  <span style="color: #408080; font-style: italic"># array name</span>
            kwargs <span style="color: #666666">=</span> {name: u}
            fname <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;.&#39;</span> <span style="color: #666666">+</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>filename <span style="color: #666666">+</span> <span style="color: #BA2121">&#39;_&#39;</span> <span style="color: #666666">+</span> name <span style="color: #666666">+</span> <span style="color: #BA2121">&#39;.dat&#39;</span>
            np<span style="color: #666666">.</span>savez(fname, <span style="color: #666666">**</span>kwargs)
            <span style="color: #008000">self</span><span style="color: #666666">.</span>t<span style="color: #666666">.</span>append(t[n])  <span style="color: #408080; font-style: italic"># store corresponding time value</span>
            <span style="color: #008000; font-weight: bold">if</span> n <span style="color: #666666">==</span> <span style="color: #666666">0</span>:           <span style="color: #408080; font-style: italic"># save x once</span>
                np<span style="color: #666666">.</span>savez(<span style="color: #BA2121">&#39;.&#39;</span> <span style="color: #666666">+</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>filename <span style="color: #666666">+</span> <span style="color: #BA2121">&#39;_x.dat&#39;</span>, x<span style="color: #666666">=</span>x)

        <span style="color: #408080; font-style: italic"># Animate</span>
        <span style="color: #008000; font-weight: bold">if</span> n <span style="color: #666666">%</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>skip_frame <span style="color: #666666">!=</span> <span style="color: #666666">0</span>:
            <span style="color: #008000; font-weight: bold">return</span>
        title <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;t=</span><span style="color: #BB6688; font-weight: bold">%.3f</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> t[n]
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>title:
            title <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>title <span style="color: #666666">+</span> <span style="color: #BA2121">&#39; &#39;</span> <span style="color: #666666">+</span> title
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>backend <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000">None</span>:
            <span style="color: #408080; font-style: italic"># native matplotlib animation</span>
            <span style="color: #008000; font-weight: bold">if</span> n <span style="color: #666666">==</span> <span style="color: #666666">0</span>:
                <span style="color: #008000">self</span><span style="color: #666666">.</span>plt<span style="color: #666666">.</span>ion()
                <span style="color: #008000">self</span><span style="color: #666666">.</span>lines <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>plt<span style="color: #666666">.</span>plot(x, u, <span style="color: #BA2121">&#39;r-&#39;</span>)
                <span style="color: #008000">self</span><span style="color: #666666">.</span>plt<span style="color: #666666">.</span>axis([x[<span style="color: #666666">0</span>], x[<span style="color: #666666">-1</span>],
                               <span style="color: #008000">self</span><span style="color: #666666">.</span>yaxis[<span style="color: #666666">0</span>], <span style="color: #008000">self</span><span style="color: #666666">.</span>yaxis[<span style="color: #666666">1</span>]])
                <span style="color: #008000">self</span><span style="color: #666666">.</span>plt<span style="color: #666666">.</span>xlabel(<span style="color: #BA2121">&#39;x&#39;</span>)
                <span style="color: #008000">self</span><span style="color: #666666">.</span>plt<span style="color: #666666">.</span>ylabel(<span style="color: #BA2121">&#39;u&#39;</span>)
                <span style="color: #008000">self</span><span style="color: #666666">.</span>plt<span style="color: #666666">.</span>title(title)
                <span style="color: #008000">self</span><span style="color: #666666">.</span>plt<span style="color: #666666">.</span>legend([<span style="color: #BA2121">&#39;t=</span><span style="color: #BB6688; font-weight: bold">%.3f</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> t[n]])
            <span style="color: #008000; font-weight: bold">else</span>:
                <span style="color: #408080; font-style: italic"># Update new solution</span>
                <span style="color: #008000">self</span><span style="color: #666666">.</span>lines[<span style="color: #666666">0</span>]<span style="color: #666666">.</span>set_ydata(u)
                <span style="color: #008000">self</span><span style="color: #666666">.</span>plt<span style="color: #666666">.</span>legend([<span style="color: #BA2121">&#39;t=</span><span style="color: #BB6688; font-weight: bold">%.3f</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> t[n]])
                <span style="color: #008000">self</span><span style="color: #666666">.</span>plt<span style="color: #666666">.</span>draw()
        <span style="color: #008000; font-weight: bold">else</span>:
            <span style="color: #408080; font-style: italic"># scitools.easyviz animation</span>
            <span style="color: #008000">self</span><span style="color: #666666">.</span>plt<span style="color: #666666">.</span>plot(x, u, <span style="color: #BA2121">&#39;r-&#39;</span>,
                          xlabel<span style="color: #666666">=</span><span style="color: #BA2121">&#39;x&#39;</span>, ylabel<span style="color: #666666">=</span><span style="color: #BA2121">&#39;u&#39;</span>,
                          axis<span style="color: #666666">=</span>[x[<span style="color: #666666">0</span>], x[<span style="color: #666666">-1</span>],
                                <span style="color: #008000">self</span><span style="color: #666666">.</span>yaxis[<span style="color: #666666">0</span>], <span style="color: #008000">self</span><span style="color: #666666">.</span>yaxis[<span style="color: #666666">1</span>]],
                          title<span style="color: #666666">=</span>title,
                          show<span style="color: #666666">=</span><span style="color: #008000">self</span><span style="color: #666666">.</span>screen_movie)
        <span style="color: #408080; font-style: italic"># pause</span>
        <span style="color: #008000; font-weight: bold">if</span> t[n] <span style="color: #666666">==</span> <span style="color: #666666">0</span>:
            time<span style="color: #666666">.</span>sleep(<span style="color: #666666">2</span>)  <span style="color: #408080; font-style: italic"># let initial condition stay 2 s</span>
        <span style="color: #008000; font-weight: bold">else</span>:
            <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>pause <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000">None</span>:
                pause <span style="color: #666666">=</span> <span style="color: #666666">0.2</span> <span style="color: #008000; font-weight: bold">if</span> u<span style="color: #666666">.</span>size <span style="color: #666666">&lt;</span> <span style="color: #666666">100</span> <span style="color: #008000; font-weight: bold">else</span> <span style="color: #666666">0</span>
            time<span style="color: #666666">.</span>sleep(pause)

        <span style="color: #008000">self</span><span style="color: #666666">.</span>plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;frame_</span><span style="color: #BB6688; font-weight: bold">%04d</span><span style="color: #BA2121">.png&#39;</span> <span style="color: #666666">%</span> (n))
</pre></div>

<h3 id="___sec227" class="anchor">Dissection </h3>

<p>
Understanding this class requires quite some familiarity with Python
in general and class programming in particular.
The class supports plotting with Matplotlib (<code>backend=None</code>) or
SciTools (<code>backend=matplotlib</code> or <code>backend=gnuplot</code>) for maximum
flexibility.

<p>
<!-- Since all the plot frames are to be collected in a separate subdirectory, -->
<!-- we demand a (logical) "casename" from the user that is used as -->
<!-- subdirectory name in the <code>make_movie_file</code> method. The statements -->
<!-- in this method perform actions normally done in the operating -->
<!-- system, but the Python interface via <code>shutil.rmtree</code>, <code>os.mkdir</code>, -->
<!-- <code>os.chdir</code>, etc., works on all platforms where Python works. -->

<p>
The constructor shows how we can flexibly import the plotting engine
as (typically) <code>scitools.easyviz.gnuplot_</code> or
<code>scitools.easyviz.matplotlib_</code> (note the trailing underscore - it is required).
With the <code>screen_movie</code> parameter
we can suppress displaying each movie frame on the screen.
Alternatively, for slow movies associated with
fine meshes, one can set
<code>skip_frame=10</code>, causing every 10 frames to be shown.

<p>
The <code>__call__</code> method makes <code>PlotAndStoreSolution</code> instances behave like
functions, so we can just pass an instance, say <code>p</code>, as the
<code>user_action</code> argument in the <code>solver</code> function, and any call to
<code>user_action</code> will be a call to <code>p.__call__</code>. The <code>__call__</code>
method plots the solution on the screen,
saves the plot to file, and stores the solution in a file for
later retrieval.

<p>
More details on storing the solution in files appear in
the section <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86027.html#softeng2:wave1D:filestorage">Saving large arrays in files</a>.

<h2 id="___sec228" class="anchor">Pulse propagation in two media </h2>

<p>
The function <code>pulse</code> in <code>wave1D_dn_vc.py</code> demonstrates wave motion in
heterogeneous media where \( c \) varies. One can specify an interval
where the wave velocity is decreased by a factor <code>slowness_factor</code>
(or increased by making this factor less than one).
Figure <a href="#wave:pde1:fig:pulse1:two:media">28</a> shows a typical simulation
scenario.

<p>
Four types of initial conditions are available:

<ol>
<li> a rectangular pulse (<code>plug</code>),</li>
<li> a Gaussian function (<code>gaussian</code>),</li>
<li> a &quot;cosine hat&quot; consisting of one period of the cosine function
   (<code>cosinehat</code>),</li>
<li> half a period of a &quot;cosine hat&quot; (<code>half-cosinehat</code>)</li>
</ol>

These peak-shaped initial conditions can be placed in the middle
(<code>loc='center'</code>) or at the left end (<code>loc='left'</code>) of the domain.
With the pulse in the middle, it splits in two parts, each with half
the initial amplitude, traveling in opposite directions. With the
pulse at the left end, centered at \( x=0 \), and using the symmetry
condition \( \partial u/\partial x=0 \), only a right-going pulse is
generated. There is also a left-going pulse, but it travels from \( x=0 \)
in negative \( x \) direction and is not visible in the domain \( [0,L] \).

<p>
The <code>pulse</code> function is a flexible tool for playing around with
various wave shapes and jumps in the wave velocity (i.e.,
discontinuous media).  The code is shown to demonstrate how easy it is
to reach this flexibility with the building blocks we have already
developed:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pulse</span>(
    C<span style="color: #666666">=1</span>,            <span style="color: #408080; font-style: italic"># Maximum Courant number</span>
    Nx<span style="color: #666666">=200</span>,         <span style="color: #408080; font-style: italic"># spatial resolution</span>
    animate<span style="color: #666666">=</span><span style="color: #008000">True</span>,
    version<span style="color: #666666">=</span><span style="color: #BA2121">&#39;vectorized&#39;</span>,
    T<span style="color: #666666">=2</span>,            <span style="color: #408080; font-style: italic"># end time</span>
    loc<span style="color: #666666">=</span><span style="color: #BA2121">&#39;left&#39;</span>,     <span style="color: #408080; font-style: italic"># location of initial condition</span>
    pulse_tp<span style="color: #666666">=</span><span style="color: #BA2121">&#39;gaussian&#39;</span>,  <span style="color: #408080; font-style: italic"># pulse/init.cond. type</span>
    slowness_factor<span style="color: #666666">=2</span>, <span style="color: #408080; font-style: italic"># inverse of wave vel. in right medium</span>
    medium<span style="color: #666666">=</span>[<span style="color: #666666">0.7</span>, <span style="color: #666666">0.9</span>], <span style="color: #408080; font-style: italic"># interval for right medium</span>
    skip_frame<span style="color: #666666">=1</span>,      <span style="color: #408080; font-style: italic"># skip frames in animations</span>
    sigma<span style="color: #666666">=0.05</span>         <span style="color: #408080; font-style: italic"># width measure of the pulse</span>
    ):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    Various peaked-shaped initial conditions on [0,1].</span>
<span style="color: #BA2121; font-style: italic">    Wave velocity is decreased by the slowness_factor inside</span>
<span style="color: #BA2121; font-style: italic">    medium. The loc parameter can be &#39;center&#39; or &#39;left&#39;,</span>
<span style="color: #BA2121; font-style: italic">    depending on where the initial pulse is to be located.</span>
<span style="color: #BA2121; font-style: italic">    The sigma parameter governs the width of the pulse.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #408080; font-style: italic"># Use scaled parameters: L=1 for domain length, c_0=1</span>
    <span style="color: #408080; font-style: italic"># for wave velocity outside the domain.</span>
    L <span style="color: #666666">=</span> <span style="color: #666666">1.0</span>
    c_0 <span style="color: #666666">=</span> <span style="color: #666666">1.0</span>
    <span style="color: #008000; font-weight: bold">if</span> loc <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;center&#39;</span>:
        xc <span style="color: #666666">=</span> L<span style="color: #666666">/2</span>
    <span style="color: #008000; font-weight: bold">elif</span> loc <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;left&#39;</span>:
        xc <span style="color: #666666">=</span> <span style="color: #666666">0</span>

    <span style="color: #008000; font-weight: bold">if</span> pulse_tp <span style="color: #AA22FF; font-weight: bold">in</span> (<span style="color: #BA2121">&#39;gaussian&#39;</span>,<span style="color: #BA2121">&#39;Gaussian&#39;</span>):
        <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">I</span>(x):
            <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>exp(<span style="color: #666666">-0.5*</span>((x<span style="color: #666666">-</span>xc)<span style="color: #666666">/</span>sigma)<span style="color: #666666">**2</span>)
    <span style="color: #008000; font-weight: bold">elif</span> pulse_tp <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;plug&#39;</span>:
        <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">I</span>(x):
            <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">0</span> <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">abs</span>(x<span style="color: #666666">-</span>xc) <span style="color: #666666">&gt;</span> sigma <span style="color: #008000; font-weight: bold">else</span> <span style="color: #666666">1</span>
    <span style="color: #008000; font-weight: bold">elif</span> pulse_tp <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;cosinehat&#39;</span>:
        <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">I</span>(x):
            <span style="color: #408080; font-style: italic"># One period of a cosine</span>
            w <span style="color: #666666">=</span> <span style="color: #666666">2</span>
            a <span style="color: #666666">=</span> w<span style="color: #666666">*</span>sigma
            <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">0.5*</span>(<span style="color: #666666">1</span> <span style="color: #666666">+</span> np<span style="color: #666666">.</span>cos(np<span style="color: #666666">.</span>pi<span style="color: #666666">*</span>(x<span style="color: #666666">-</span>xc)<span style="color: #666666">/</span>a)) \ 
                   <span style="color: #008000; font-weight: bold">if</span> xc <span style="color: #666666">-</span> a <span style="color: #666666">&lt;=</span> x <span style="color: #666666">&lt;=</span> xc <span style="color: #666666">+</span> a <span style="color: #008000; font-weight: bold">else</span> <span style="color: #666666">0</span>

    <span style="color: #008000; font-weight: bold">elif</span> pulse_tp <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;half-cosinehat&#39;</span>:
        <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">I</span>(x):
            <span style="color: #408080; font-style: italic"># Half a period of a cosine</span>
            w <span style="color: #666666">=</span> <span style="color: #666666">4</span>
            a <span style="color: #666666">=</span> w<span style="color: #666666">*</span>sigma
            <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>cos(np<span style="color: #666666">.</span>pi<span style="color: #666666">*</span>(x<span style="color: #666666">-</span>xc)<span style="color: #666666">/</span>a) \ 
                   <span style="color: #008000; font-weight: bold">if</span> xc <span style="color: #666666">-</span> <span style="color: #666666">0.5*</span>a <span style="color: #666666">&lt;=</span> x <span style="color: #666666">&lt;=</span> xc <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>a <span style="color: #008000; font-weight: bold">else</span> <span style="color: #666666">0</span>
    <span style="color: #008000; font-weight: bold">else</span>:
        <span style="color: #008000; font-weight: bold">raise</span> <span style="color: #D2413A; font-weight: bold">ValueError</span>(<span style="color: #BA2121">&#39;Wrong pulse_tp=&quot;</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">&quot;&#39;</span> <span style="color: #666666">%</span> pulse_tp)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">c</span>(x):
        <span style="color: #008000; font-weight: bold">return</span> c_0<span style="color: #666666">/</span>slowness_factor \ 
               <span style="color: #008000; font-weight: bold">if</span> medium[<span style="color: #666666">0</span>] <span style="color: #666666">&lt;=</span> x <span style="color: #666666">&lt;=</span> medium[<span style="color: #666666">1</span>] <span style="color: #008000; font-weight: bold">else</span> c_0

    umin<span style="color: #666666">=-0.5</span>; umax<span style="color: #666666">=1.5*</span>I(xc)
    casename <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">_Nx</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">_sf</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> \ 
               (pulse_tp, Nx, slowness_factor)
    action <span style="color: #666666">=</span> PlotMediumAndSolution(
        medium, casename<span style="color: #666666">=</span>casename, umin<span style="color: #666666">=</span>umin, umax<span style="color: #666666">=</span>umax,
        skip_frame<span style="color: #666666">=</span>skip_frame, screen_movie<span style="color: #666666">=</span>animate,
        backend<span style="color: #666666">=</span><span style="color: #008000">None</span>, filename<span style="color: #666666">=</span><span style="color: #BA2121">&#39;tmpdata&#39;</span>)

    <span style="color: #408080; font-style: italic"># Choose the stability limit with given Nx, worst case c</span>
    <span style="color: #408080; font-style: italic"># (lower C will then use this dt, but smaller Nx)</span>
    dt <span style="color: #666666">=</span> (L<span style="color: #666666">/</span>Nx)<span style="color: #666666">/</span>c_0
    cpu, hashed_input <span style="color: #666666">=</span> solver(
        I<span style="color: #666666">=</span>I, V<span style="color: #666666">=</span><span style="color: #008000">None</span>, f<span style="color: #666666">=</span><span style="color: #008000">None</span>, c<span style="color: #666666">=</span>c,
        U_0<span style="color: #666666">=</span><span style="color: #008000">None</span>, U_L<span style="color: #666666">=</span><span style="color: #008000">None</span>,
        L<span style="color: #666666">=</span>L, dt<span style="color: #666666">=</span>dt, C<span style="color: #666666">=</span>C, T<span style="color: #666666">=</span>T,
        user_action<span style="color: #666666">=</span>action,
        version<span style="color: #666666">=</span>version,
        stability_safety_factor<span style="color: #666666">=1</span>)

    <span style="color: #008000; font-weight: bold">if</span> cpu <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>:  <span style="color: #408080; font-style: italic"># did we generate new data?</span>
        action<span style="color: #666666">.</span>close_file(hashed_input)
        action<span style="color: #666666">.</span>make_movie_file()
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;cpu (-1 means no new data generated):&#39;</span>, cpu

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">convergence_rates</span>(
    u_exact,
    I, V, f, c, U_0, U_L, L,
    dt0, num_meshes,
    C, T, version<span style="color: #666666">=</span><span style="color: #BA2121">&#39;scalar&#39;</span>,
    stability_safety_factor<span style="color: #666666">=1.0</span>):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    Half the time step and estimate convergence rates for</span>
<span style="color: #BA2121; font-style: italic">    for num_meshes simulations.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">ComputeError</span>:
        <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, norm_type):
            <span style="color: #008000">self</span><span style="color: #666666">.</span>error <span style="color: #666666">=</span> <span style="color: #666666">0</span>

        <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__call__</span>(<span style="color: #008000">self</span>, u, x, t, n):
            <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Store norm of the error in self.E.&quot;&quot;&quot;</span>
            error <span style="color: #666666">=</span> np<span style="color: #666666">.</span>abs(u <span style="color: #666666">-</span> u_exact(x, t[n]))<span style="color: #666666">.</span>max()
            <span style="color: #008000">self</span><span style="color: #666666">.</span>error <span style="color: #666666">=</span> <span style="color: #008000">max</span>(<span style="color: #008000">self</span><span style="color: #666666">.</span>error, error)

    E <span style="color: #666666">=</span> []
    h <span style="color: #666666">=</span> []  <span style="color: #408080; font-style: italic"># dt, solver adjusts dx such that C=dt*c/dx</span>
    dt <span style="color: #666666">=</span> dt0
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(num_meshes):
        error_calculator <span style="color: #666666">=</span> ComputeError(<span style="color: #BA2121">&#39;Linf&#39;</span>)
        solver(I, V, f, c, U_0, U_L, L, dt, C, T,
               user_action<span style="color: #666666">=</span>error_calculator,
               version<span style="color: #666666">=</span><span style="color: #BA2121">&#39;scalar&#39;</span>,
               stability_safety_factor<span style="color: #666666">=1.0</span>)
        E<span style="color: #666666">.</span>append(error_calculator<span style="color: #666666">.</span>error)
        h<span style="color: #666666">.</span>append(dt)
        dt <span style="color: #666666">/=</span> <span style="color: #666666">2</span>  <span style="color: #408080; font-style: italic"># halve the time step for next simulation</span>
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;E:&#39;</span>, E
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;h:&#39;</span>, h
    r <span style="color: #666666">=</span> [np<span style="color: #666666">.</span>log(E[i]<span style="color: #666666">/</span>E[i<span style="color: #666666">-1</span>])<span style="color: #666666">/</span>np<span style="color: #666666">.</span>log(h[i]<span style="color: #666666">/</span>h[i<span style="color: #666666">-1</span>])
         <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">1</span>,num_meshes)]
    <span style="color: #008000; font-weight: bold">return</span> r

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_convrate_sincos</span>():
    n <span style="color: #666666">=</span> m <span style="color: #666666">=</span> <span style="color: #666666">2</span>
    L <span style="color: #666666">=</span> <span style="color: #666666">1.0</span>
    u_exact <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> x, t: np<span style="color: #666666">.</span>cos(m<span style="color: #666666">*</span>np<span style="color: #666666">.</span>pi<span style="color: #666666">/</span>L<span style="color: #666666">*</span>t)<span style="color: #666666">*</span>np<span style="color: #666666">.</span>sin(m<span style="color: #666666">*</span>np<span style="color: #666666">.</span>pi<span style="color: #666666">/</span>L<span style="color: #666666">*</span>x)

    r <span style="color: #666666">=</span> convergence_rates(
        u_exact<span style="color: #666666">=</span>u_exact,
        I<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">lambda</span> x: u_exact(x, <span style="color: #666666">0</span>),
        V<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">lambda</span> x: <span style="color: #666666">0</span>,
        f<span style="color: #666666">=0</span>,
        c<span style="color: #666666">=1</span>,
        U_0<span style="color: #666666">=0</span>,
        U_L<span style="color: #666666">=0</span>,
        L<span style="color: #666666">=</span>L,
        dt0<span style="color: #666666">=0.1</span>,
        num_meshes<span style="color: #666666">=6</span>,
        C<span style="color: #666666">=0.9</span>,
        T<span style="color: #666666">=1</span>,
        version<span style="color: #666666">=</span><span style="color: #BA2121">&#39;scalar&#39;</span>,
        stability_safety_factor<span style="color: #666666">=1.0</span>)
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;rates sin(x)*cos(t) solution:&#39;</span>, \ 
          [<span style="color: #008000">round</span>(r_,<span style="color: #666666">2</span>) <span style="color: #008000; font-weight: bold">for</span> r_ <span style="color: #AA22FF; font-weight: bold">in</span> r]
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">abs</span>(r[<span style="color: #666666">-1</span>] <span style="color: #666666">-</span> <span style="color: #666666">2</span>) <span style="color: #666666">&lt;</span> <span style="color: #666666">0.002</span>
</pre></div>
<p>
The <code>PlotMediumAndSolution</code> class used here is a subclass of
<code>PlotAndStoreSolution</code> where the medium with reduced \( c \) value,
as specified by the <code>medium</code> interval,
is visualized in the plots.

<p>
<div class="alert alert-block alert-success alert-text-normal"><b>Comment on the choices of discretization parameters.</b>
The argument \( N_x \) in the <code>pulse</code> function does not correspond to
the actual spatial resolution of \( C < 1 \), since the <code>solver</code>
function takes a fixed \( \Delta t \) and \( C \), and adjusts \( \Delta x \)
accordingly. As seen in the <code>pulse</code> function,
the specified \( \Delta t \) is chosen according to the
limit \( C=1 \), so if \( C < 1 \), \( \Delta t \) remains the same, but the
<code>solver</code> function operates with a larger \( \Delta x \) and smaller
\( N_x \) than was specified in the call to <code>pulse</code>. The practical reason
is that we always want to keep \( \Delta t \) fixed such that
plot frames and movies are synchronized in time regardless of the
value of \( C \) (i.e., \( \Delta x \) is varied when the
Courant number varies).
</div>


<p>
The reader is encouraged to play around with the <code>pulse</code> function:

<p>

<!-- code=ipy (!bc ipy) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">wave1D_dn_vc</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">w</span>
<span style="color: #666666">&gt;&gt;&gt;</span> w<span style="color: #666666">.</span>pulse(Nx<span style="color: #666666">=50</span>, loc<span style="color: #666666">=</span><span style="color: #BA2121">&#39;left&#39;</span>, pulse_tp<span style="color: #666666">=</span><span style="color: #BA2121">&#39;cosinehat&#39;</span>, slowness_factor<span style="color: #666666">=2</span>)
</pre></div>
<p>
To easily kill the graphics by Ctrl-C and restart a new simulation it might be
easier to run the above two statements from the command line
with

<p>

<!-- code=text (!bc sys) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>Terminal&gt; python -c &#39;import wave1D_dn_vc as w; w.pulse(...)&#39;
</pre></div>

<h1 id="___sec229" class="anchor">Exercises </h1>

<p>
<!-- --- begin exercise --- -->

<h2 id="wave:exer:standingwave:damped:uex" class="anchor">Exercise 2.7: Find the analytical solution to a damped wave equation</h2>

<p>
Consider the wave equation with damping <a href="#mjx-eqn-2.61">(2.61)</a>.
The goal is to find an exact solution to a wave problem with damping and zero source term.
A starting point is the standing wave solution from
<a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#wave:exer:standingwave">Exercise 2.1: Simulate a standing wave</a>. It becomes necessary to
include a damping term \( e^{-\beta t} \) and also have both a sine and cosine
component in time:

$$ \uex(x,t) =  e^{-\beta t}
\sin kx \left( A\cos\omega t
+ B\sin\omega t\right)
\tp
$$

Find \( k \) from the boundary conditions
\( u(0,t)=u(L,t)=0 \). Then use the PDE to find constraints on
\( \beta \), \( \omega \), \( A \), and \( B \).
Set up a complete initial-boundary value problem
and its solution.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_35_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_35_1">

<p>
Mathematical model:

$$
\begin{equation*}
\frac{\partial^2 u}{\partial t^2} + b\frac{\partial u}{\partial t} =
c^2\frac{\partial^2 u}{\partial x^2},
\nonumber
\end{equation*}
$$

\( b \geq 0 \) is a prescribed damping coefficient.

<p>
Ansatz:

$$ u(x,t) =  e^{-\beta t}
\sin kx \left( A\cos\omega t
+ B\sin\omega t\right)
$$

<p>
Boundary condition: \( u=0 \) for \( x=0,L \). Fulfilled for \( x=0 \). Requirement
at \( x=L \) gives

$$ kL = m\pi,$$

for an arbitrary integer \( m \). Hence, \( k=m\pi/L \).

<p>
Inserting the ansatz in the PDE and dividing by \( e^{-\beta t} \) results in

$$
\begin{align*}
(\beta^2 sin kx -\omega^2 sin kx - b\beta sin kx) (A\cos\omega t + B\sin\omega t) &+ \nonumber \\ 
(b\omega sin kx - 2\beta\omega sin kx) (-A\sin\omega t + B\cos\omega t) &= -(A\cos\omega t + B\sin\omega t)k^2c^2 \nonumber
\end{align*}
$$

<p>
This gives us two requirements:
$$ \beta^2 - \omega^2 + b\beta + k^2c^2 = 0 $$

and
$$ -2\beta\omega + b\omega = 0 $$

Since \( b \), \( c \) and \( k \) are to be given in advance, we may solve these two equations to get
$$
\begin{align*}
\beta &= \frac{b}{2}     \nonumber \\ 
\omega &= \sqrt{c^2k^2 - \frac{b^2}{4}}    \nonumber
\end{align*}
$$

From the initial condition on the derivative, i.e. \( \frac{\partial u_e}{\partial t} = 0 \), we find that
$$ B\omega = \beta A $$

Inserting the expression for \( \omega \), we find that
$$ B = \frac{b}{2\sqrt{c^2k^2 - \frac{b^2}{4}}} A $$

for \( A \) prescribed.

<p>
Using \( t = 0 \) in the expression for \( u_e \) gives us the initial condition as
$$ I(x) = A sin kx$$

<p>
Summarizing, the PDE problem can then be states as

$$
\begin{align}
\frac{\partial^2 u}{\partial t^2} + b\frac{\partial u}{\partial t} &=
c^2 \frac{\partial^2 u}{\partial x^2}, \quad &x\in (0,L),\ t\in (0,T]
\nonumber\\ 
u(x,0) &= I(x), \quad &x\in [0,L]
\nonumber\\ 
\frac{\partial}{\partial t}u(x,0) &= 0, \quad &x\in [0,L]
\nonumber\\ 
u(0,t) & = 0, \quad  &t\in (0,T]
\nonumber\\ 
u(L,t) & = 0, \quad  &t\in (0,T]
\nonumber
\end{align}
$$

where constants \( c \), \( A \), \( b \) and \( k \), as well as \( I(x) \), are prescribed.

<p>
The solution to the problem is then given as

$$ \uex(x,t) =  e^{-\beta t}
\sin kx \left( A\cos\omega t
+ B\sin\omega t\right)
\tp
$$

with \( k=m\pi/L \) for arbitrary integer \( m \), \( \beta = \frac{b}{2} \),
\( \omega = \sqrt{c^2k^2 - \frac{b^2}{4}} \), \( B = \frac{b}{2\sqrt{c^2k^2 - \frac{b^2}{4}}} A \)
and \( I(x) = A sin kx \).

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>damped_waves</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="wave:exer:symmetry:bc" class="anchor">Problem 2.8: Explore symmetry boundary conditions</h2>

<p>
Consider the simple "plug" wave where \( \Omega = [-L,L] \) and

$$
\begin{equation*} I(x) = \left\lbrace\begin{array}{ll}
1, & x\in [-\delta, \delta],\\ 
0, & \hbox{otherwise}
\end{array}\right.
\end{equation*}
$$

for some number \( 0 < \delta < L \). The other initial condition is
\( u_t(x,0)=0 \) and there is no source term \( f \).
The boundary conditions can be set to \( u=0 \).
The solution to this problem is symmetric around \( x=0 \).
This means that we can simulate the wave process in only the half
of the domain \( [0,L] \).

<p>
<b>a)</b>
Argue why the symmetry boundary condition
is \( u_x=0 \) at \( x=0 \).

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_36_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_36_1">

<p>
Symmetry of a function about \( x=x_0 \) means that
\( f(x_0+h) = f(x_0-h) \).

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_36_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_36_2">

<p>
A symmetric \( u \) around \( x=0 \) means that \( u(-x,t)=u(x,t) \).
Let \( x_0=0 \) and \( x=x_0+h \). Then we can use a <em>centered</em> finite difference
definition of the derivative:

$$ \frac{\partial}{\partial x}u(x_0,t) =
\lim_{h\rightarrow 0}\frac{u(x_0+h,t)- u(x_0-h)}{2h} =
\lim_{h\rightarrow 0}\frac{u(h,t)- u(-h,t)}{2h} = 0,$$

since \( u(h,t)=u(-h,t) \) for any \( h \). Symmetry around a point \( x=x_0 \)
therefore always implies \( u_x(x_0,t)=0 \).

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
Perform simulations of the complete wave problem
on \( [-L,L] \). Thereafter, utilize the
symmetry of the solution and run a simulation
in half of the domain \( [0,L] \), using a boundary condition
at \( x=0 \). Compare plots from the two solutions and
confirm that they are the same.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_36_3" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_36_3">

<p>
We can utilize the <code>wave1D_dn.py</code> code which allows Dirichlet and
Neumann conditions. The <code>solver</code> and <code>viz</code> functions must take \( x_0 \)
and \( x_L \) as parameters instead of just \( L \) such that we can solve the
wave equation in \( [x_0, x_L] \). The we can call up <code>solver</code> for the two
problems on \( [-L,L] \) and \( [0,L] \) with boundary conditions
\( u(-L,t)=u(L,t)=0 \) and \( u_x(0,t)=u(L,t)=0 \), respectively.

<p>
The original <code>wave1D_dn.py</code> code makes a movie by playing all the
<code>.png</code> files in a browser.  It can then be wise to let the <code>viz</code>
function create a movie directory and place all the frames and HTML
player file in that directory.  Alternatively, one can just make
some ordinary movie file (Ogg, WebM, MP4, Flash) with <code>ffmpeg</code> or
<code>ffmpeg</code> and give it a name. It is a point that the name is
transferred to <code>viz</code> so it is easy to call <code>viz</code> twice and get two
separate movie files or movie directories.

<p>
The plots produced by the code (below) shows that the solutions indeed
are the same.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>c)</b>
Prove the symmetry property of the solution
by setting up the complete initial-boundary value problem
and showing that if \( u(x,t) \) is a solution, then also \( u(-x,t) \)
is a solution.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_36_4" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_36_4">

<p>
The plan in this proof is to introduce \( v(x,t)=u(-x,t) \)
and show that \( v \) fulfills the same
initial-boundary value problem as \( u \). If the problem has a unique
solution, then \( v=u \). Or, in other words, the solution is
symmetric: \( u(-x,t)=u(x,t) \).

<p>
We can work with a general initial-boundary value problem on the form

$$
\begin{align}
u_tt(x,t) &= c^2u_{xx}(x,t) + f(x,t)
\tag{2.69}\\ 
u(x,0) &= I(x)
\tag{2.70}\\ 
u_t(x,0) &= V(x)
\tag{2.71}\\ 
u(-L,0) &= 0
\tag{2.72}\\ 
u(L,0) &= 0
\tag{2.73}
\end{align}
$$

Introduce a new coordinate \( \bar x = -x \). We have that

$$ \frac{\partial^2 u}{\partial x^2} = \frac{\partial}{\partial x}
\left(
\frac{\partial u}{\partial\bar x}
\frac{\partial\bar x}{\partial x}
\right)
= \frac{\partial}{\partial x}
\left(
\frac{\partial u}{\partial\bar x} (-1)\right)
= (-1)^2 \frac{\partial^2 u}{\partial \bar x^2}
$$

The derivatives in time are unchanged.

<p>
Substituting \( x \) by \( -\bar x \) leads to

$$
\begin{align}
u_{tt}(-\bar x,t) &= c^2u_{\bar x\bar x}(-\bar x,t) + f(-\bar x,t)
\tag{2.74}\\ 
u(-\bar x,0) &= I(-\bar x)
\tag{2.75}\\ 
u_t(-\bar x,0) &= V(-\bar x)
\tag{2.76}\\ 
u(L,0) &= 0
\tag{2.77}\\ 
u(-L,0) &= 0
\tag{2.78}
\end{align}
$$

Now, dropping the bars and introducing \( v(x,t)=u(-x,t) \), we find that

$$
\begin{align}
v_{tt}(x,t) &= c^2v_{xx}(x,t) + f(-x,t)
\tag{2.79}\\ 
v(x,0) &= I(-x)
\tag{2.80}\\ 
v_t(x ,0) &= V(-x)
\tag{2.81}\\ 
v(-L,0) &= 0
\tag{2.82}\\ 
v(L,0) &= 0
\tag{2.83}
\end{align}
$$

<em>Provided that \( I \), \( f \), and \( V \) are all symmetric</em> around \( x=0 \)
such that \( I(x)=I(-x) \), \( V(x)=V(-x) \), and \( f(x,t)=f(-x,t) \), we
can express the initial-boundary value problem as

$$
\begin{align}
v_{tt}(x,t) &= c^2v_{xx}(x,t) + f(x,t)
\tag{2.84}\\ 
v(x,0) &= I(x)
\tag{2.85}\\ 
v_t(x ,0) &= V(x)
\tag{2.86}\\ 
v(-L,0) &= 0
\tag{2.87}\\ 
v(L,0) &= 0
\tag{2.88}
\end{align}
$$

This is the same problem as the one that \( u \) fulfills. If the solution
is unique, which can be proven, then \( v=u \), and \( u(-x,t)=u(x,t) \).

<p>
To summarize, the necessary conditions for symmetry are that

<ul>
  <li> all involved functions \( I \), \( V \), and \( f \) must be symmetric, and</li>
  <li> the boundary conditions are symmetric in the sense that they
    can be flipped (the condition at \( x=-L \) can be applied
    at \( x=L \) and vice versa).</li>
</ul>

</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>d)</b>
If the code works correctly, the solution \( u(x,t) = x(L-x)(1+\frac{t}{2}) \)
should be reproduced exactly. Write a test function <code>test_quadratic</code> that
checks whether this is the case. Simulate for \( x \) in \( [0, \frac{L}{2}] \) with
a symmetry condition at the end \( x = \frac{L}{2} \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_36_5" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_36_5">

<p>
Running the code below, shows that the test case indeed is reproduced exactly.

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #408080; font-style: italic">#!/usr/bin/env python</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">scitools.std</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>

<span style="color: #408080; font-style: italic"># Add an x0 coordinate for solving the wave equation on [x0, xL]</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">solver</span>(I, V, f, c, U_0, U_L, x0, xL, Nx, C, T,
           user_action<span style="color: #666666">=</span><span style="color: #008000">None</span>, version<span style="color: #666666">=</span><span style="color: #BA2121">&#39;scalar&#39;</span>):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    Solve u_tt=c^2*u_xx + f on (0,L)x(0,T].</span>
<span style="color: #BA2121; font-style: italic">    u(0,t)=U_0(t) or du/dn=0 (U_0=None), u(L,t)=U_L(t) or du/dn=0 (u_L=None).</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    x <span style="color: #666666">=</span> linspace(x0, xL, Nx<span style="color: #666666">+1</span>)       <span style="color: #408080; font-style: italic"># Mesh points in space</span>
    dx <span style="color: #666666">=</span> x[<span style="color: #666666">1</span>] <span style="color: #666666">-</span> x[<span style="color: #666666">0</span>]
    dt <span style="color: #666666">=</span> C<span style="color: #666666">*</span>dx<span style="color: #666666">/</span>c
    Nt <span style="color: #666666">=</span> <span style="color: #008000">int</span>(<span style="color: #008000">round</span>(T<span style="color: #666666">/</span>dt))
    t <span style="color: #666666">=</span> linspace(<span style="color: #666666">0</span>, Nt<span style="color: #666666">*</span>dt, Nt<span style="color: #666666">+1</span>)   <span style="color: #408080; font-style: italic"># Mesh points in time</span>
    C2 <span style="color: #666666">=</span> C<span style="color: #666666">**2</span>; dt2 <span style="color: #666666">=</span> dt<span style="color: #666666">*</span>dt         <span style="color: #408080; font-style: italic"># Help variables in the scheme</span>

    <span style="color: #408080; font-style: italic"># Wrap user-given f, V, U_0, U_L</span>
    <span style="color: #008000; font-weight: bold">if</span> f <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000">None</span> <span style="color: #AA22FF; font-weight: bold">or</span> f <span style="color: #666666">==</span> <span style="color: #666666">0</span>:
        f <span style="color: #666666">=</span> (<span style="color: #008000; font-weight: bold">lambda</span> x, t: <span style="color: #666666">0</span>) <span style="color: #008000; font-weight: bold">if</span> version <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;scalar&#39;</span> <span style="color: #008000; font-weight: bold">else</span> \
            <span style="color: #008000; font-weight: bold">lambda</span> x, t: zeros(x<span style="color: #666666">.</span>shape)
    <span style="color: #008000; font-weight: bold">if</span> V <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000">None</span> <span style="color: #AA22FF; font-weight: bold">or</span> V <span style="color: #666666">==</span> <span style="color: #666666">0</span>:
        V <span style="color: #666666">=</span> (<span style="color: #008000; font-weight: bold">lambda</span> x: <span style="color: #666666">0</span>) <span style="color: #008000; font-weight: bold">if</span> version <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;scalar&#39;</span> <span style="color: #008000; font-weight: bold">else</span> \
            <span style="color: #008000; font-weight: bold">lambda</span> x: zeros(x<span style="color: #666666">.</span>shape)
    <span style="color: #008000; font-weight: bold">if</span> U_0 <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">None</span>:
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">isinstance</span>(U_0, (<span style="color: #008000">float</span>,<span style="color: #008000">int</span>)) <span style="color: #AA22FF; font-weight: bold">and</span> U_0 <span style="color: #666666">==</span> <span style="color: #666666">0</span>:
            U_0 <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> t: <span style="color: #666666">0</span>
    <span style="color: #008000; font-weight: bold">if</span> U_L <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">None</span>:
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">isinstance</span>(U_L, (<span style="color: #008000">float</span>,<span style="color: #008000">int</span>)) <span style="color: #AA22FF; font-weight: bold">and</span> U_L <span style="color: #666666">==</span> <span style="color: #666666">0</span>:
            U_L <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> t: <span style="color: #666666">0</span>

    u   <span style="color: #666666">=</span> zeros(Nx<span style="color: #666666">+1</span>)   <span style="color: #408080; font-style: italic"># Solution array at new time level</span>
    u_1 <span style="color: #666666">=</span> zeros(Nx<span style="color: #666666">+1</span>)   <span style="color: #408080; font-style: italic"># Solution at 1 time level back</span>
    u_2 <span style="color: #666666">=</span> zeros(Nx<span style="color: #666666">+1</span>)   <span style="color: #408080; font-style: italic"># Solution at 2 time levels back</span>

    Ix <span style="color: #666666">=</span> <span style="color: #008000">range</span>(<span style="color: #666666">0</span>, Nx<span style="color: #666666">+1</span>)
    It <span style="color: #666666">=</span> <span style="color: #008000">range</span>(<span style="color: #666666">0</span>, Nt<span style="color: #666666">+1</span>)

    <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">time</span>;  t0 <span style="color: #666666">=</span> time<span style="color: #666666">.</span>clock()  <span style="color: #408080; font-style: italic"># CPU time measurement</span>

    <span style="color: #408080; font-style: italic"># Load initial condition into u_1</span>
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> Ix:
        u_1[i] <span style="color: #666666">=</span> I(x[i])

    <span style="color: #008000; font-weight: bold">if</span> user_action <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">None</span>:
        user_action(u_1, x, t, <span style="color: #666666">0</span>)

    <span style="color: #408080; font-style: italic"># Special formula for the first step</span>
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> Ix[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>]:
        u[i] <span style="color: #666666">=</span> u_1[i] <span style="color: #666666">+</span> dt<span style="color: #666666">*</span>V(x[i]) <span style="color: #666666">+</span> \
               <span style="color: #666666">0.5*</span>C2<span style="color: #666666">*</span>(u_1[i<span style="color: #666666">-1</span>] <span style="color: #666666">-</span> <span style="color: #666666">2*</span>u_1[i] <span style="color: #666666">+</span> u_1[i<span style="color: #666666">+1</span>]) <span style="color: #666666">+</span> \
               <span style="color: #666666">0.5*</span>dt2<span style="color: #666666">*</span>f(x[i], t[<span style="color: #666666">0</span>])

    i <span style="color: #666666">=</span> Ix[<span style="color: #666666">0</span>]
    <span style="color: #008000; font-weight: bold">if</span> U_0 <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000">None</span>:
        <span style="color: #408080; font-style: italic"># Set boundary values du/dn = 0</span>
        <span style="color: #408080; font-style: italic"># x=0: i-1 -&gt; i+1 since u[i-1]=u[i+1]</span>
        <span style="color: #408080; font-style: italic"># x=L: i+1 -&gt; i-1 since u[i+1]=u[i-1])</span>
        ip1 <span style="color: #666666">=</span> i<span style="color: #666666">+1</span>
        im1 <span style="color: #666666">=</span> ip1  <span style="color: #408080; font-style: italic"># i-1 -&gt; i+1</span>
        u[i] <span style="color: #666666">=</span> u_1[i] <span style="color: #666666">+</span> dt<span style="color: #666666">*</span>V(x[i]) <span style="color: #666666">+</span> \
               <span style="color: #666666">0.5*</span>C2<span style="color: #666666">*</span>(u_1[im1] <span style="color: #666666">-</span> <span style="color: #666666">2*</span>u_1[i] <span style="color: #666666">+</span> u_1[ip1]) <span style="color: #666666">+</span> \
               <span style="color: #666666">0.5*</span>dt2<span style="color: #666666">*</span>f(x[i], t[<span style="color: #666666">0</span>])
    <span style="color: #008000; font-weight: bold">else</span>:
        u[<span style="color: #666666">0</span>] <span style="color: #666666">=</span> U_0(dt)

    i <span style="color: #666666">=</span> Ix[<span style="color: #666666">-1</span>]
    <span style="color: #008000; font-weight: bold">if</span> U_L <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000">None</span>:
        im1 <span style="color: #666666">=</span> i<span style="color: #666666">-1</span>
        ip1 <span style="color: #666666">=</span> im1  <span style="color: #408080; font-style: italic"># i+1 -&gt; i-1</span>
        u[i] <span style="color: #666666">=</span> u_1[i] <span style="color: #666666">+</span> dt<span style="color: #666666">*</span>V(x[i]) <span style="color: #666666">+</span> \
               <span style="color: #666666">0.5*</span>C2<span style="color: #666666">*</span>(u_1[im1] <span style="color: #666666">-</span> <span style="color: #666666">2*</span>u_1[i] <span style="color: #666666">+</span> u_1[ip1]) <span style="color: #666666">+</span> \
               <span style="color: #666666">0.5*</span>dt2<span style="color: #666666">*</span>f(x[i], t[<span style="color: #666666">0</span>])
    <span style="color: #008000; font-weight: bold">else</span>:
        u[i] <span style="color: #666666">=</span> U_L(dt)

    <span style="color: #008000; font-weight: bold">if</span> user_action <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">None</span>:
        user_action(u, x, t, <span style="color: #666666">1</span>)

    <span style="color: #408080; font-style: italic"># Update data structures for next step</span>
    u_2[:], u_1[:] <span style="color: #666666">=</span> u_1, u

    <span style="color: #008000; font-weight: bold">for</span> n <span style="color: #AA22FF; font-weight: bold">in</span> It[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>]:
        <span style="color: #408080; font-style: italic"># Update all inner points</span>
        <span style="color: #008000; font-weight: bold">if</span> version <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;scalar&#39;</span>:
            <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> Ix[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>]:
                u[i] <span style="color: #666666">=</span> <span style="color: #666666">-</span> u_2[i] <span style="color: #666666">+</span> <span style="color: #666666">2*</span>u_1[i] <span style="color: #666666">+</span> \
                       C2<span style="color: #666666">*</span>(u_1[i<span style="color: #666666">-1</span>] <span style="color: #666666">-</span> <span style="color: #666666">2*</span>u_1[i] <span style="color: #666666">+</span> u_1[i<span style="color: #666666">+1</span>]) <span style="color: #666666">+</span> \
                       dt2<span style="color: #666666">*</span>f(x[i], t[n])

        <span style="color: #008000; font-weight: bold">elif</span> version <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;vectorized&#39;</span>:
            u[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>] <span style="color: #666666">=</span> <span style="color: #666666">-</span> u_2[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>] <span style="color: #666666">+</span> <span style="color: #666666">2*</span>u_1[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>] <span style="color: #666666">+</span> \
                      C2<span style="color: #666666">*</span>(u_1[<span style="color: #666666">0</span>:<span style="color: #666666">-2</span>] <span style="color: #666666">-</span> <span style="color: #666666">2*</span>u_1[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>] <span style="color: #666666">+</span> u_1[<span style="color: #666666">2</span>:]) <span style="color: #666666">+</span> \
                      dt2<span style="color: #666666">*</span>f(x[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>], t[n])
        <span style="color: #008000; font-weight: bold">else</span>:
            <span style="color: #008000; font-weight: bold">raise</span> <span style="color: #D2413A; font-weight: bold">ValueError</span>(<span style="color: #BA2121">&#39;version=</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> version)

        <span style="color: #408080; font-style: italic"># Insert boundary conditions</span>
        i <span style="color: #666666">=</span> Ix[<span style="color: #666666">0</span>]
        <span style="color: #008000; font-weight: bold">if</span> U_0 <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000">None</span>:
            <span style="color: #408080; font-style: italic"># Set boundary values</span>
            <span style="color: #408080; font-style: italic"># x=0: i-1 -&gt; i+1 since u[i-1]=u[i+1] when du/dn=0</span>
            <span style="color: #408080; font-style: italic"># x=L: i+1 -&gt; i-1 since u[i+1]=u[i-1] when du/dn=0</span>
            ip1 <span style="color: #666666">=</span> i<span style="color: #666666">+1</span>
            im1 <span style="color: #666666">=</span> ip1
            u[i] <span style="color: #666666">=</span> <span style="color: #666666">-</span> u_2[i] <span style="color: #666666">+</span> <span style="color: #666666">2*</span>u_1[i] <span style="color: #666666">+</span> \
                   C2<span style="color: #666666">*</span>(u_1[im1] <span style="color: #666666">-</span> <span style="color: #666666">2*</span>u_1[i] <span style="color: #666666">+</span> u_1[ip1]) <span style="color: #666666">+</span> \
                   dt2<span style="color: #666666">*</span>f(x[i], t[n])
        <span style="color: #008000; font-weight: bold">else</span>:
            u[<span style="color: #666666">0</span>] <span style="color: #666666">=</span> U_0(t[n<span style="color: #666666">+1</span>])

        i <span style="color: #666666">=</span> Ix[<span style="color: #666666">-1</span>]
        <span style="color: #008000; font-weight: bold">if</span> U_L <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000">None</span>:
            im1 <span style="color: #666666">=</span> i<span style="color: #666666">-1</span>
            ip1 <span style="color: #666666">=</span> im1
            u[i] <span style="color: #666666">=</span> <span style="color: #666666">-</span> u_2[i] <span style="color: #666666">+</span> <span style="color: #666666">2*</span>u_1[i] <span style="color: #666666">+</span> \
                   C2<span style="color: #666666">*</span>(u_1[im1] <span style="color: #666666">-</span> <span style="color: #666666">2*</span>u_1[i] <span style="color: #666666">+</span> u_1[ip1]) <span style="color: #666666">+</span> \
                   dt2<span style="color: #666666">*</span>f(x[i], t[n])
        <span style="color: #008000; font-weight: bold">else</span>:
            u[i] <span style="color: #666666">=</span> U_L(t[n<span style="color: #666666">+1</span>])

        <span style="color: #008000; font-weight: bold">if</span> user_action <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">None</span>:
            <span style="color: #008000; font-weight: bold">if</span> user_action(u, x, t, n<span style="color: #666666">+1</span>):
                <span style="color: #008000; font-weight: bold">break</span>

        <span style="color: #408080; font-style: italic"># Update data structures for next step</span>
        u_2[:], u_1[:] <span style="color: #666666">=</span> u_1, u

    cpu_time <span style="color: #666666">=</span> t0 <span style="color: #666666">-</span> time<span style="color: #666666">.</span>clock()
    <span style="color: #008000; font-weight: bold">return</span> u, x, t, cpu_time


<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">viz</span>(I, V, f, c, U_0, U_L, x0, xL, Nx, C, T, umin, umax,
        version<span style="color: #666666">=</span><span style="color: #BA2121">&#39;scalar&#39;</span>, animate<span style="color: #666666">=</span><span style="color: #008000">True</span>,
        movie_dir<span style="color: #666666">=</span><span style="color: #BA2121">&#39;tmp&#39;</span>):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Run solver and visualize u at each time level.&quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">scitools.std</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span><span style="color: #666666">,</span> <span style="color: #0000FF; font-weight: bold">time</span><span style="color: #666666">,</span> <span style="color: #0000FF; font-weight: bold">glob</span><span style="color: #666666">,</span> <span style="color: #0000FF; font-weight: bold">os</span>

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">plot_u</span>(u, x, t, n):
        <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;user_action function for solver.&quot;&quot;&quot;</span>
        plt<span style="color: #666666">.</span>plot(x, u, <span style="color: #BA2121">&#39;r-&#39;</span>,
                 xlabel<span style="color: #666666">=</span><span style="color: #BA2121">&#39;x&#39;</span>, ylabel<span style="color: #666666">=</span><span style="color: #BA2121">&#39;u&#39;</span>,
                 axis<span style="color: #666666">=</span>[x0, xL, umin, umax],
                 title<span style="color: #666666">=</span><span style="color: #BA2121">&#39;t=</span><span style="color: #BB6688; font-weight: bold">%f</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> t[n])
        <span style="color: #408080; font-style: italic"># Let the initial condition stay on the screen for 2</span>
        <span style="color: #408080; font-style: italic"># seconds, else insert a pause of 0.2 s between each plot</span>
        time<span style="color: #666666">.</span>sleep(<span style="color: #666666">2</span>) <span style="color: #008000; font-weight: bold">if</span> t[n] <span style="color: #666666">==</span> <span style="color: #666666">0</span> <span style="color: #008000; font-weight: bold">else</span> time<span style="color: #666666">.</span>sleep(<span style="color: #666666">0.2</span>)
        plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;frame_</span><span style="color: #BB6688; font-weight: bold">%04d</span><span style="color: #BA2121">.png&#39;</span> <span style="color: #666666">%</span> n)  <span style="color: #408080; font-style: italic"># for movie making</span>

    <span style="color: #408080; font-style: italic"># Clean up old movie frames</span>
    <span style="color: #008000; font-weight: bold">for</span> filename <span style="color: #AA22FF; font-weight: bold">in</span> glob<span style="color: #666666">.</span>glob(<span style="color: #BA2121">&#39;frame_*.png&#39;</span>):
        os<span style="color: #666666">.</span>remove(filename)

    user_action <span style="color: #666666">=</span> plot_u <span style="color: #008000; font-weight: bold">if</span> animate <span style="color: #008000; font-weight: bold">else</span> <span style="color: #008000">None</span>
    u, x, t, cpu <span style="color: #666666">=</span> solver(I, V, f, c, U_0, U_L, L, Nx, C, T,
                          user_action, version)
    <span style="color: #008000; font-weight: bold">if</span> animate:
        <span style="color: #408080; font-style: italic"># Make a directory with the frames</span>
        <span style="color: #008000; font-weight: bold">if</span> os<span style="color: #666666">.</span>path<span style="color: #666666">.</span>isdir(movie_dir):
            shutil<span style="color: #666666">.</span>rmtree(movie_dir)
        os<span style="color: #666666">.</span>mkdir(movie_dir)
        os<span style="color: #666666">.</span>chdir(movie_dir)
        <span style="color: #408080; font-style: italic"># Move all frame_*.png files to this subdirectory</span>
        <span style="color: #008000; font-weight: bold">for</span> filename <span style="color: #AA22FF; font-weight: bold">in</span> glob<span style="color: #666666">.</span>glob(os<span style="color: #666666">.</span>path<span style="color: #666666">.</span>join(os<span style="color: #666666">.</span>pardir, <span style="color: #BA2121">&#39;frame_*.png&#39;</span>)):
            os<span style="color: #666666">.</span>renamve(os<span style="color: #666666">.</span>path<span style="color: #666666">.</span>join(os<span style="color: #666666">.</span>pardir, filename), filename)
        plt<span style="color: #666666">.</span>movie(<span style="color: #BA2121">&#39;frame_*.png&#39;</span>, encoder<span style="color: #666666">=</span><span style="color: #BA2121">&#39;html&#39;</span>, fps<span style="color: #666666">=4</span>,
                  output_file<span style="color: #666666">=</span><span style="color: #BA2121">&#39;movie.html&#39;</span>)
        <span style="color: #408080; font-style: italic"># Invoke movie.html in a browser to steer the movie</span>

    <span style="color: #008000; font-weight: bold">return</span> cpu

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">nose.tools</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">nt</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_quadratic</span>():
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    Check the scalar and vectorized versions work for</span>
<span style="color: #BA2121; font-style: italic">    a quadratic u(x,t)=x(L-x)(1+t/2) that is exactly reproduced.</span>
<span style="color: #BA2121; font-style: italic">    We simulate in [0, L/2] and apply a symmetry condition</span>
<span style="color: #BA2121; font-style: italic">    at the end x=L/2.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    exact_solution <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> x, t: x<span style="color: #666666">*</span>(L<span style="color: #666666">-</span>x)<span style="color: #666666">*</span>(<span style="color: #666666">1+0.5*</span>t)
    I <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> x: exact_solution(x, <span style="color: #666666">0</span>)
    V <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> x: <span style="color: #666666">0.5*</span>exact_solution(x, <span style="color: #666666">0</span>)
    f <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> x, t: <span style="color: #666666">2*</span>(<span style="color: #666666">1+0.5*</span>t)<span style="color: #666666">*</span>c<span style="color: #666666">**2</span>
    U_0 <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> t: exact_solution(<span style="color: #666666">0</span>, t)
    U_L <span style="color: #666666">=</span> <span style="color: #008000">None</span>
    L <span style="color: #666666">=</span> <span style="color: #666666">2.5</span>
    c <span style="color: #666666">=</span> <span style="color: #666666">1.5</span>
    Nx <span style="color: #666666">=</span> <span style="color: #666666">3</span>  <span style="color: #408080; font-style: italic"># very coarse mesh</span>
    C <span style="color: #666666">=</span> <span style="color: #666666">1</span>
    T <span style="color: #666666">=</span> <span style="color: #666666">18</span>  <span style="color: #408080; font-style: italic"># long time integration</span>

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">assert_no_error</span>(u, x, t, n):
        u_e <span style="color: #666666">=</span> exact_solution(x, t[n])
        diff <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(u <span style="color: #666666">-</span> u_e)<span style="color: #666666">.</span>max()
        nt<span style="color: #666666">.</span>assert_almost_equal(diff, <span style="color: #666666">0</span>, places<span style="color: #666666">=13</span>)

    solver(I, V, f, c, U_0, U_L, <span style="color: #666666">0</span>, L<span style="color: #666666">/2</span>, Nx, C, T,
           user_action<span style="color: #666666">=</span>assert_no_error, version<span style="color: #666666">=</span><span style="color: #BA2121">&#39;scalar&#39;</span>)
    solver(I, V, f, c, U_0, U_L, <span style="color: #666666">0</span>, L<span style="color: #666666">/2</span>, Nx, C, T,
           user_action<span style="color: #666666">=</span>assert_no_error, version<span style="color: #666666">=</span><span style="color: #BA2121">&#39;vectorized&#39;</span>)


<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">plug</span>(C<span style="color: #666666">=1</span>, Nx<span style="color: #666666">=50</span>, animate<span style="color: #666666">=</span><span style="color: #008000">True</span>, version<span style="color: #666666">=</span><span style="color: #BA2121">&#39;scalar&#39;</span>, T<span style="color: #666666">=2</span>):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Plug profile as initial condition.&quot;&quot;&quot;</span>
    L <span style="color: #666666">=</span> <span style="color: #666666">1.</span>
    c <span style="color: #666666">=</span> <span style="color: #666666">1</span>
    delta <span style="color: #666666">=</span> <span style="color: #666666">0.1</span>

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">I</span>(x):
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">abs</span>(x) <span style="color: #666666">&gt;</span> delta:
            <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">0</span>
        <span style="color: #008000; font-weight: bold">else</span>:
            <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">1</span>

    <span style="color: #408080; font-style: italic"># Solution on [-L,L]</span>
    cpu <span style="color: #666666">=</span> viz(I<span style="color: #666666">=</span>I, V<span style="color: #666666">=0</span>, f<span style="color: #666666">=0</span>, c, U_0<span style="color: #666666">=0</span>, U_L<span style="color: #666666">=0</span>, <span style="color: #666666">-</span>L, L, <span style="color: #666666">2*</span>Nx, C, T,
              umin<span style="color: #666666">=-1.1</span>, umax<span style="color: #666666">=1.1</span>, version<span style="color: #666666">=</span>version, animate<span style="color: #666666">=</span>animate,
              movie_dir<span style="color: #666666">=</span><span style="color: #BA2121">&#39;full&#39;</span>)

    <span style="color: #408080; font-style: italic"># Solution on [0,L]</span>
    cpu <span style="color: #666666">=</span> viz(I<span style="color: #666666">=</span>I, V<span style="color: #666666">=0</span>, f<span style="color: #666666">=0</span>, c, U_0<span style="color: #666666">=</span><span style="color: #008000">None</span>, U_L<span style="color: #666666">=0</span>, <span style="color: #666666">0</span>, L, Nx, C, T,
              umin<span style="color: #666666">=-1.1</span>, umax<span style="color: #666666">=1.1</span>, version<span style="color: #666666">=</span>version, animate<span style="color: #666666">=</span>animate,
              movie_dir<span style="color: #666666">=</span><span style="color: #BA2121">&#39;half&#39;</span>)


<span style="color: #008000; font-weight: bold">if</span> __name__ <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;__main__&#39;</span>:
    plug()
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
Filename: <code>wave1D_symmetric</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="wave:app:exer:pulse1D" class="anchor">Exercise 2.9: Send pulse waves through a layered medium</h2>

<p>
Use the <code>pulse</code> function in <code>wave1D_dn_vc.py</code> to investigate
sending a pulse, located with its peak at \( x=0 \), through two
media with different wave velocities. The (scaled) velocity in
the left medium is 1 while it is \( \frac{1}{s_f} \) in the right medium.
Report what happens with a Gaussian pulse, a &quot;cosine hat&quot; pulse,
half a &quot;cosine hat&quot; pulse, and a plug pulse for resolutions
\( N_x=40,80,160 \), and \( s_f=2,4 \). Simulate until \( T=2 \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_37_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_37_1">

<p>
In all cases, the change in velocity causes some of the wave to
be reflected back (while the rest is let through). When the waves
go from higher to lower velocity, the amplitude builds, and vice versa.

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">wave1D_dn_vc</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">wave</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">os</span><span style="color: #666666">,</span> <span style="color: #0000FF; font-weight: bold">sys</span><span style="color: #666666">,</span> <span style="color: #0000FF; font-weight: bold">shutil</span><span style="color: #666666">,</span> <span style="color: #0000FF; font-weight: bold">glob</span>

<span style="color: #008000; font-weight: bold">for</span> pulse_tp <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #BA2121">&#39;gaussian&#39;</span>, <span style="color: #BA2121">&#39;cosinehat&#39;</span>, <span style="color: #BA2121">&#39;half-cosinehat&#39;</span>, <span style="color: #BA2121">&#39;plug&#39;</span>:
    <span style="color: #008000; font-weight: bold">for</span> Nx <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #666666">40</span>, <span style="color: #666666">80</span>, <span style="color: #666666">160</span>:
        <span style="color: #008000; font-weight: bold">for</span> sf <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #666666">2</span>, <span style="color: #666666">4</span>:
            <span style="color: #008000; font-weight: bold">if</span> sf <span style="color: #666666">==</span> <span style="color: #666666">1</span> <span style="color: #AA22FF; font-weight: bold">and</span> Nx <span style="color: #666666">&gt;</span> <span style="color: #666666">40</span>:
                <span style="color: #008000; font-weight: bold">continue</span>  <span style="color: #408080; font-style: italic"># homogeneous medium with C=1: Nx=40 enough</span>
            <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;wave1D.pulse:&#39;</span>, pulse_tp, Nx, sf

            wave<span style="color: #666666">.</span>pulse(C<span style="color: #666666">=1</span>, Nx<span style="color: #666666">=</span>Nx, animate<span style="color: #666666">=</span><span style="color: #008000">False</span>, <span style="color: #408080; font-style: italic"># just hardcopies</span>
                       version<span style="color: #666666">=</span><span style="color: #BA2121">&#39;vectorized&#39;</span>,
                       T<span style="color: #666666">=2</span>, loc<span style="color: #666666">=</span><span style="color: #BA2121">&#39;left&#39;</span>, pulse_tp<span style="color: #666666">=</span>pulse_tp,
                       slowness_factor<span style="color: #666666">=</span>sf, medium<span style="color: #666666">=</span>[<span style="color: #666666">0.7</span>, <span style="color: #666666">0.9</span>],
                       skip_frame <span style="color: #666666">=</span> <span style="color: #666666">1</span>,
                       sigma<span style="color: #666666">=0.05</span>)
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>pulse1D</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="wave:app:exer:pulse1D:analysis" class="anchor">Exercise 2.10: Explain why numerical noise occurs</h2>

<p>
The experiments performed in <a href="#wave:app:exer:pulse1D">Exercise 2.9: Send pulse waves through a layered medium</a> shows
considerable numerical noise in the form of non-physical waves,
especially for \( s_f=4 \) and the plug pulse or the half a &quot;cosinehat&quot;
pulse. The noise is much less visible for a Gaussian pulse. Run the
case with the plug and half a &quot;cosinehat&quot; pulses for \( s_f=1 \), \( C=0.9,
0.25 \), and \( N_x=40,80,160 \). Use the numerical dispersion relation to
explain the observations.
Filename: <code>pulse1D_analysis</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="wave:app:exer:pulse1D:harmonic" class="anchor">Exercise 2.11: Investigate harmonic averaging in a 1D model</h2>

<p>
Harmonic means are often used if the wave velocity is non-smooth or
discontinuous.  Will harmonic averaging of the wave velocity give less
numerical noise for the case \( s_f=4 \) in <a href="#wave:app:exer:pulse1D">Exercise 2.9: Send pulse waves through a layered medium</a>?
Filename: <code>pulse1D_harmonic</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="wave:app:exer:radiationBC" class="anchor">Problem 2.12: Implement open boundary conditions</h2>

<p>
<!-- Solution file is actually periodic.py from Exer <a href="#wave:exer:periodic">Exercise 2.13: Implement periodic boundary conditions</a>, -->
<!-- just remove the periodc stuff ;-) -->

<p>
To enable a wave to leave the computational domain and travel
undisturbed through
the boundary \( x=L \), one can in a one-dimensional problem impose the
following condition, called a <em>radiation condition</em> or
<em>open boundary condition</em>:

$$
\begin{equation}
\frac{\partial u}{\partial t} + c\frac{\partial u}{\partial x} = 0\tp
\tag{2.89}
\end{equation}
$$

The parameter \( c \) is the wave velocity.

<p>
Show that <a href="#mjx-eqn-2.89">(2.89)</a> accepts
a solution \( u = g_R(x-ct) \) (right-going wave),
but not \( u = g_L(x+ct) \) (left-going wave). This means
that <a href="#mjx-eqn-2.89">(2.89)</a> will allow any
right-going wave \( g_R(x-ct) \) to pass through the boundary undisturbed.

<p>
A corresponding open boundary condition for a left-going wave
through \( x=0 \) is

$$
\begin{equation}
\frac{\partial u}{\partial t} - c\frac{\partial u}{\partial x} = 0\tp
\tag{2.90}
\end{equation}
$$

<p>
<b>a)</b>
A natural idea for discretizing
the condition <a href="#mjx-eqn-2.89">(2.89)</a>
at the spatial end point \( i=N_x \) is to apply
centered differences in time and space:

$$
\begin{equation}
[D_{2t}u + cD_{2x}u =0]^n_{i},\quad i=N_x\tp
\tag{2.91}
\end{equation}
$$

Eliminate the fictitious value \( u_{N_x+1}^n \) by using
the discrete equation at the same point.

<p>
The equation for the first step, \( u_i^1 \), is in principle also affected,
but we can then use the condition \( u_{N_x}=0 \) since the wave
has not yet reached the right boundary.

<p>
<b>b)</b>
A much more convenient implementation of the open boundary condition
at \( x=L \) can be based on an explicit discretization

$$
\begin{equation}
[D^+_tu + cD_x^- u = 0]_i^n,\quad i=N_x\tp
\tag{2.92}
\end{equation}
$$

From this equation, one can solve for \( u^{n+1}_{N_x} \) and apply the
formula as a Dirichlet condition at the boundary point.
However, the finite difference approximations involved are of
first order.

<p>
Implement this scheme for a wave equation
\( u_{tt}=c^2u_{xx} \) in a domain \( [0,L] \),
where you have \( u_x=0 \) at \( x=0 \), the condition <a href="#mjx-eqn-2.89">(2.89)</a>
at \( x=L \), and an initial disturbance in the middle
of the domain, e.g., a plug profile like

$$ u(x,0) = \left\lbrace\begin{array}{ll} 1,& L/2-\ell \leq x \leq  L/2+\ell,\\ 
0,\hbox{otherwise}\end{array}\right.
$$

Observe that the initial wave is split in two, the left-going wave
is reflected at \( x=0 \), and both waves travel out of \( x=L \),
leaving the solution as \( u=0 \) in \( [0,L] \). Use a unit Courant number
such that the numerical solution is exact.
Make a movie to illustrate what happens.

<p>
Because this simplified
implementation of the open boundary condition works, there is no
need to pursue the more complicated discretization in a).

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_40_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_40_1">

<p>
Modify the solver function in
<a href="http://tinyurl.com/nu656p2/wave/wave1D/wave1D_dn.py" target="_self"><tt>wave1D_dn.py</tt></a>.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->

<p>
<b>c)</b>
Add the possibility to have either \( u_x=0 \) or an open boundary
condition at the left boundary. The latter condition is discretized
as

$$
\begin{equation}
[D^+_tu - cD_x^+ u = 0]_i^n,\quad i=0,
\tag{2.93}
\end{equation}
$$

leading to an explicit update of the boundary value \( u^{n+1}_0 \).

<p>
The implementation can be tested with a Gaussian function as initial condition:

$$ g(x;m,s) = \frac{1}{\sqrt{2\pi}s}e^{-\frac{(x-m)^2}{2s^2}}\tp$$

Run two tests:

<ol>
<li> Disturbance in the middle of the domain, \( I(x)=g(x;L/2,s) \), and
   open boundary condition at the left end.</li>
<li> Disturbance at the left end, \( I(x)=g(x;0,s) \), and \( u_x=0 \)
   as symmetry boundary condition at this end.</li>
</ol>

Make test functions for both cases, testing that the solution is zero
after the waves have left the domain.

<p>
<b>d)</b>
In 2D and 3D it is difficult to compute the correct wave velocity
normal to the boundary, which is needed in generalizations of
the open boundary conditions in higher dimensions. Test the effect
of having a slightly wrong wave velocity in
<a href="#mjx-eqn-2.92">(2.92)</a>.
Make movies to illustrate what happens.

<p>
Filename: <code>wave1D_open_BC</code>.

<p>
<!-- Closing remarks for this Problem -->

<h3 id="___sec236" class="anchor">Remarks </h3>

<p>
The condition <a href="#mjx-eqn-2.89">(2.89)</a>
works perfectly in 1D when \( c \) is known. In 2D and 3D, however, the
condition reads \( u_t + c_x u_x + c_y u_y=0 \), where \( c_x \) and
\( c_y \) are the wave speeds in the \( x \) and \( y \) directions. Estimating
these components (i.e., the direction of the wave) is often
challenging. Other methods are normally used in 2D and 3D to
let waves move out of a computational domain.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="wave:exer:periodic" class="anchor">Exercise 2.13: Implement periodic boundary conditions</h2>

<p>
It is frequently of interest to follow wave motion over large
distances and long times. A straightforward approach is to
work with a very large domain, but that might lead to a lot of
computations in areas of the domain where the waves cannot
be noticed. A more efficient approach is to let a right-going
wave out of the domain and at the same time let it enter
the domain on the left. This is called a <em>periodic boundary
condition</em>.

<p>
The boundary condition at the right end \( x=L \) is an open boundary
condition (see <a href="#wave:app:exer:radiationBC">Problem 2.12: Implement open boundary conditions</a>) to let a
right-going wave out of the domain.  At the left end, \( x=0 \), we apply,
in the beginning of the simulation, either a symmetry boundary
condition (see <a href="#wave:exer:symmetry:bc">Problem 2.8: Explore symmetry boundary conditions</a>) \( u_x=0 \), or an
open boundary condition.

<p>
This initial wave will split in two and either be reflected or
transported out of the domain at \( x=0 \). The purpose of the exercise is
to follow the right-going wave. We can do that with a <em>periodic
boundary condition</em>.  This means that when the right-going wave hits
the boundary \( x=L \), the open boundary condition lets the wave out of
the domain, but at the same time we use a boundary condition on the
left end \( x=0 \) that feeds the outgoing wave into the domain
again. This periodic condition is simply \( u(0)=u(L) \). The switch from
\( u_x=0 \) or an open boundary condition at the left end to a periodic
condition can happen when \( u(L,t)>\epsilon \), where \( \epsilon =10^{-4} \)
might be an appropriate value for determining when the right-going
wave hits the boundary \( x=L \).

<p>
The open boundary conditions can conveniently be discretized as
explained in <a href="#wave:app:exer:radiationBC">Problem 2.12: Implement open boundary conditions</a>.  Implement the
described type of boundary conditions and test them on two different
initial shapes: a plug \( u(x,0)=1 \) for \( x\leq 0.1 \), \( u(x,0)=0 \) for
\( x>0.1 \), and a Gaussian function in the middle of the domain:
\( u(x,0)=\exp{(-\frac{1}{2}(x-0.5)^2/0.05)} \). The domain is the unit
interval \( [0,1] \). Run these two shapes for Courant numbers 1 and
0.5. Assume constant wave velocity.  Make movies of the four cases.
Reason why the solutions are correct.
Filename: <code>periodic</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="___sec238" class="anchor">Exercise 2.14: Compare discretizations of a Neumann condition </h2>

<p>
We have a 1D wave equation with variable wave velocity:
\( u_{tt}=(qu_x)_x \).
A Neumann condition \( u_x \) at \( x=0, L \) can be
discretized as shown in <a href="#mjx-eqn-2.54">(2.54)</a>
and <a href="#mjx-eqn-2.57">(2.57)</a>.

<p>
The aim of this exercise is to examine the rate of the numerical
error when using different ways of discretizing the Neumann condition.

<p>
<b>a)</b>
As a test problem, \( q=1+(x-L/2)^4 \) can be used, with \( f(x,t) \)
adapted such that the solution has a simple form, say
\( u(x,t)=\cos (\pi x/L)\cos (\omega t) \) for, e.g., \( \omega = 1 \).
Perform numerical experiments and find the convergence rate of the
error using the approximation
<a href="#mjx-eqn-2.54">(2.54)</a>.

<p>
<b>b)</b>
Switch to \( q(x)=1+\cos(\pi x/L) \), which is symmetric at \( x=0,L \),
and check the convergence rate
of the scheme
<a href="#mjx-eqn-2.57">(2.57)</a>. Now,
\( q_{i-1/2} \) is a 2nd-order approximation to \( q_i \),
\( q_{i-1/2}=q_i + 0.25q_i''\Delta x^2 + \cdots \), because \( q_i'=0 \)
for \( i=N_x \) (a similar argument can be applied to the case \( i=0 \)).

<p>
<b>c)</b>
A third discretization can be based on a simple and convenient,
but less accurate, one-sided difference:
\( u_{i}-u_{i-1}=0 \) at \( i=N_x \) and \( u_{i+1}-u_i=0 \) at \( i=0 \).
Derive the resulting scheme in detail and implement it.
Run experiments with \( q \) from a) or b) to establish the rate of convergence
of the scheme.

<p>
<b>d)</b>
A fourth technique is to view the scheme as

$$ [D_tD_tu]^n_i = \frac{1}{\Delta x}\left(
[qD_xu]_{i+\half}^n - [qD_xu]_{i-\half}^n\right)
+ [f]_i^n,$$

and place the boundary at \( x_{i+\half} \), \( i=N_x \), instead of
exactly at the physical boundary. With this idea of approximating (moving) the
boundary,
we can just set \( [qD_xu]_{i+\half}^n=0 \).
Derive the complete scheme
using this technique. The implementation of the boundary condition at
\( L-\Delta x/2 \) is \( \Oof{\Delta x^2} \) accurate, but the interesting question
is what impact the movement of the boundary has on the convergence
rate. Compute the errors as usual over the entire mesh and use \( q \) from
a) or b).

<p>
Filename: <code>Neumann_discr</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="wave:fd2:exer:verify:cubic" class="anchor">Exercise 2.15: Verification by a cubic polynomial in space</h2>

<p>
The purpose of this exercise is to verify the implementation of the
<code>solver</code> function in the program <a href="http://tinyurl.com/nu656p2/wave/wave1D/wave1D_n0.py" target="_self"><tt>wave1D_n0.py</tt></a> by using an exact numerical solution
for the wave equation \( u_{tt}=c^2u_{xx} + f \) with Neumann boundary
conditions \( u_x(0,t)=u_x(L,t)=0 \).

<p>
A similar verification is used in the file <a href="http://tinyurl.com/nu656p2/wave/wave1D/wave1D_u0.py" target="_self"><tt>wave1D_u0.py</tt></a>, which solves the same PDE, but with
Dirichlet boundary conditions \( u(0,t)=u(L,t)=0 \).  The idea of the
verification test in function <code>test_quadratic</code> in <code>wave1D_u0.py</code> is to
produce a solution that is a lower-order polynomial such that both the
PDE problem, the boundary conditions, and all the discrete equations
are exactly fulfilled. Then the <code>solver</code> function should reproduce
this exact solution to machine precision.  More precisely, we seek
\( u=X(x)T(t) \), with \( T(t) \) as a linear function and \( X(x) \) as a
parabola that fulfills the boundary conditions.  Inserting this \( u \) in
the PDE determines \( f \).  It turns out that \( u \) also fulfills the
discrete equations, because the truncation error of the discretized
PDE has derivatives in \( x \) and \( t \) of order four and higher. These
derivatives all vanish for a quadratic \( X(x) \) and linear \( T(t) \).

<p>
It would be attractive to use a similar approach in the case of
Neumann conditions. We set \( u=X(x)T(t) \) and seek lower-order
polynomials \( X \) and \( T \).
To force \( u_x \) to vanish at the boundary, we let \( X_x \) be
a parabola. Then \( X \) is a cubic polynomial. The fourth-order
derivative of a cubic polynomial vanishes, so \( u=X(x)T(t) \)
will fulfill the discretized PDE also in this case, if \( f \)
is adjusted such that \( u \) fulfills the PDE.

<p>
However, the discrete boundary condition is not exactly fulfilled
by this choice of \( u \). The reason is that

$$
\begin{equation}
[D_{2x}u]^n_i = u_{x}(x_i,t_n) + \frac{1}{6}u_{xxx}(x_i,t_n)\Delta x^2
+ \Oof{\Delta x^4}\tp
\tag{2.94}
\end{equation}
$$

At the boundary two boundary points, we must demand that
the derivative \( X_x(x)=0 \) such that \( u_x=0 \).
However, \( u_{xxx} \) is a constant and not zero
when \( X(x) \) is a cubic polynomial.
Therefore, our \( u=X(x)T(t) \) fulfills

$$ [D_{2x}u]^n_i = \frac{1}{6}u_{xxx}(x_i,t_n)\Delta x^2,
$$

and not

$$ [D_{2x}u]^n_i =0, \quad i=0,N_x,$$

as it should. (Note that all the higher-order terms \( \Oof{\Delta x^4} \)
also have higher-order derivatives that vanish for a cubic polynomial.)
So to summarize, the fundamental problem is that \( u \) as a product of
a cubic polynomial and a linear or quadratic polynomial in time
is not an exact solution of the discrete boundary conditions.

<p>
To make progress,
we assume that \( u=X(x)T(t) \), where \( T \) for simplicity is taken as a
prescribed linear function \( 1+\frac{1}{2}t \), and \( X(x) \) is taken
as an <em>unknown</em> cubic polynomial \( \sum_{j=0}^3 a_jx^j \).
There are two different ways of determining the coefficients
\( a_0,\ldots,a_3 \) such that both the discretized PDE and the
discretized boundary conditions are fulfilled, under the
constraint that we can specify a function \( f(x,t) \) for the PDE to feed
to the <code>solver</code> function in <code>wave1D_n0.py</code>. Both approaches
are explained in the subexercises.

<p>
<!-- {wave:fd2:exer:verify:cubic:D2x} -->

<p>
<b>a)</b>
One can insert \( u \) in the discretized PDE and find the corresponding \( f \).
Then one can insert \( u \) in the discretized boundary conditions.
This yields two equations for the four coefficients \( a_0,\ldots,a_3 \).
To find the coefficients, one can set \( a_0=0 \) and \( a_1=1 \) for
simplicity and then determine \( a_2 \) and \( a_3 \). This approach will make
\( a_2 \) and \( a_3 \) depend on \( \Delta x \) and \( f \) will depend on both
\( \Delta x \) and \( \Delta t \).

<p>
Use <code>sympy</code> to perform analytical computations.
A starting point is to define \( u \) as follows:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_cubic1</span>():
    <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">sympy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">sm</span>
    x, t, c, L, dx, dt <span style="color: #666666">=</span> sm<span style="color: #666666">.</span>symbols(<span style="color: #BA2121">&#39;x t c L dx dt&#39;</span>)
    i, n <span style="color: #666666">=</span> sm<span style="color: #666666">.</span>symbols(<span style="color: #BA2121">&#39;i n&#39;</span>, integer<span style="color: #666666">=</span><span style="color: #008000">True</span>)

    <span style="color: #408080; font-style: italic"># Assume discrete solution is a polynomial of degree 3 in x</span>
    T <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> t: <span style="color: #666666">1</span> <span style="color: #666666">+</span> sm<span style="color: #666666">.</span>Rational(<span style="color: #666666">1</span>,<span style="color: #666666">2</span>)<span style="color: #666666">*</span>t  <span style="color: #408080; font-style: italic"># Temporal term</span>
    a <span style="color: #666666">=</span> sm<span style="color: #666666">.</span>symbols(<span style="color: #BA2121">&#39;a_0 a_1 a_2 a_3&#39;</span>)
    X <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> x: <span style="color: #008000">sum</span>(a[q]<span style="color: #666666">*</span>x<span style="color: #666666">**</span>q <span style="color: #008000; font-weight: bold">for</span> q <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">4</span>))  <span style="color: #408080; font-style: italic"># Spatial term</span>
    u <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> x, t: X(x)<span style="color: #666666">*</span>T(t)
</pre></div>
<p>
The symbolic expression for \( u \) is reached by calling <code>u(x,t)</code>
with <code>x</code> and <code>t</code> as <code>sympy</code> symbols.

<p>
Define <code>DxDx(u, i, n)</code>, <code>DtDt(u, i, n)</code>, and <code>D2x(u, i, n)</code>
as Python functions for returning the difference
approximations \( [D_xD_x u]^n_i \), \( [D_tD_t u]^n_i \), and
\( [D_{2x}u]^n_i \). The next step is to set up the residuals
for the equations \( [D_{2x}u]^n_0=0 \) and \( [D_{2x}u]^n_{N_x}=0 \),
where \( N_x=L/\Delta x \). Call the residuals <code>R_0</code> and <code>R_L</code>.
Substitute \( a_0 \) and \( a_1 \) by 0 and 1, respectively, in
<code>R_0</code>, <code>R_L</code>, and <code>a</code>:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>R_0 <span style="color: #666666">=</span> R_0<span style="color: #666666">.</span>subs(a[<span style="color: #666666">0</span>], <span style="color: #666666">0</span>)<span style="color: #666666">.</span>subs(a[<span style="color: #666666">1</span>], <span style="color: #666666">1</span>)
R_L <span style="color: #666666">=</span> R_L<span style="color: #666666">.</span>subs(a[<span style="color: #666666">0</span>], <span style="color: #666666">0</span>)<span style="color: #666666">.</span>subs(a[<span style="color: #666666">1</span>], <span style="color: #666666">1</span>)
a <span style="color: #666666">=</span> <span style="color: #008000">list</span>(a)  <span style="color: #408080; font-style: italic"># enable in-place assignment</span>
a[<span style="color: #666666">0</span>:<span style="color: #666666">2</span>] <span style="color: #666666">=</span> <span style="color: #666666">0</span>, <span style="color: #666666">1</span>
</pre></div>
<p>
Determining \( a_2 \) and \( a_3 \) from the discretized boundary conditions
is then about solving two equations with respect to \( a_2 \) and \( a_3 \),
i.e., <code>a[2:]</code>:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>s <span style="color: #666666">=</span> sm<span style="color: #666666">.</span>solve([R_0, R_L], a[<span style="color: #666666">2</span>:])
<span style="color: #408080; font-style: italic"># s is dictionary with the unknowns a[2] and a[3] as keys</span>
a[<span style="color: #666666">2</span>:] <span style="color: #666666">=</span> s[a[<span style="color: #666666">2</span>]], s[a[<span style="color: #666666">3</span>]]
</pre></div>
<p>
Now, <code>a</code> contains computed values and <code>u</code> will automatically use
these new values since <code>X</code> accesses <code>a</code>.

<p>
Compute the source term \( f \) from the discretized PDE:
\( f^n_i = [D_tD_t u - c^2D_xD_x u]^n_i \). Turn \( u \), the time
derivative \( u_t \) (needed for the initial condition \( V(x) \)),
and \( f \) into Python functions. Set numerical values for
\( L \), \( N_x \), \( C \), and \( c \). Prescribe the time interval as
\( \Delta t = CL/(N_xc) \), which imply \( \Delta x = c\Delta t/C = L/N_x \).
Define new functions <code>I(x)</code>, <code>V(x)</code>, and <code>f(x,t)</code> as wrappers of the ones
made above, where fixed values of \( L \), \( c \), \( \Delta x \), and \( \Delta t \)
are inserted, such that <code>I</code>, <code>V</code>, and <code>f</code> can be passed on to the
<code>solver</code> function. Finally, call <code>solver</code> with a <code>user_action</code>
function that compares the numerical solution to this exact
solution \( u \) of the discrete PDE problem.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_43_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_43_1">

<p>
To turn a <code>sympy</code> expression <code>e</code>, depending on a series of
symbols, say <code>x</code>, <code>t</code>, <code>dx</code>, <code>dt</code>, <code>L</code>, and <code>c</code>, into a plain
Python function <code>e_exact(x,t,L,dx,dt,c)</code>, one can write

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>e_exact <span style="color: #666666">=</span> sm<span style="color: #666666">.</span>lambdify([x,t,L,dx,dt,c], e, <span style="color: #BA2121">&#39;numpy&#39;</span>)
</pre></div>
<p>
The <code>'numpy'</code> argument is a good habit as the <code>e_exact</code> function
will then work with array arguments if it contains mathematical
functions (but here we only do plain arithmetics, which automatically
work with arrays).

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->

<p>
<b>b)</b>
An alternative way of determining \( a_0,\ldots,a_3 \) is to reason as
follows. We first construct \( X(x) \) such that the boundary conditions
are fulfilled: \( X=x(L-x) \). However, to compensate for the fact
that this choice of \( X \) does not fulfill the discrete boundary
condition, we seek \( u \) such that

$$ u_x = \frac{\partial}{\partial x}x(L-x)T(t) - \frac{1}{6}u_{xxx}\Delta x^2,$$

since this \( u \) will fit the discrete boundary condition.
Assuming \( u=T(t)\sum_{j=0}^3a_jx^j \), we can use the above equation to
determine the coefficients \( a_1,a_2,a_3 \). A value, e.g., 1 can be used for
\( a_0 \). The following <code>sympy</code> code computes this \( u \):

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_cubic2</span>():
    <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">sympy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">sm</span>
    x, t, c, L, dx <span style="color: #666666">=</span> sm<span style="color: #666666">.</span>symbols(<span style="color: #BA2121">&#39;x t c L dx&#39;</span>)
    T <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> t: <span style="color: #666666">1</span> <span style="color: #666666">+</span> sm<span style="color: #666666">.</span>Rational(<span style="color: #666666">1</span>,<span style="color: #666666">2</span>)<span style="color: #666666">*</span>t  <span style="color: #408080; font-style: italic"># Temporal term</span>
    <span style="color: #408080; font-style: italic"># Set u as a 3rd-degree polynomial in space</span>
    X <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> x: <span style="color: #008000">sum</span>(a[i]<span style="color: #666666">*</span>x<span style="color: #666666">**</span>i <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">4</span>))
    a <span style="color: #666666">=</span> sm<span style="color: #666666">.</span>symbols(<span style="color: #BA2121">&#39;a_0 a_1 a_2 a_3&#39;</span>)
    u <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> x, t: X(x)<span style="color: #666666">*</span>T(t)
    <span style="color: #408080; font-style: italic"># Force discrete boundary condition to be zero by adding</span>
    <span style="color: #408080; font-style: italic"># a correction term the analytical suggestion x*(L-x)*T</span>
    <span style="color: #408080; font-style: italic"># u_x = x*(L-x)*T(t) - 1/6*u_xxx*dx**2</span>
    R <span style="color: #666666">=</span> sm<span style="color: #666666">.</span>diff(u(x,t), x) <span style="color: #666666">-</span> (
        x<span style="color: #666666">*</span>(L<span style="color: #666666">-</span>x) <span style="color: #666666">-</span> sm<span style="color: #666666">.</span>Rational(<span style="color: #666666">1</span>,<span style="color: #666666">6</span>)<span style="color: #666666">*</span>sm<span style="color: #666666">.</span>diff(u(x,t), x, x, x)<span style="color: #666666">*</span>dx<span style="color: #666666">**2</span>)
    <span style="color: #408080; font-style: italic"># R is a polynomial: force all coefficients to vanish.</span>
    <span style="color: #408080; font-style: italic"># Turn R to Poly to extract coefficients:</span>
    R <span style="color: #666666">=</span> sm<span style="color: #666666">.</span>poly(R, x)
    coeff <span style="color: #666666">=</span> R<span style="color: #666666">.</span>all_coeffs()
    s <span style="color: #666666">=</span> sm<span style="color: #666666">.</span>solve(coeff, a[<span style="color: #666666">1</span>:])  <span style="color: #408080; font-style: italic"># a[0] is not present in R</span>
    <span style="color: #408080; font-style: italic"># s is dictionary with a[i] as keys</span>
    <span style="color: #408080; font-style: italic"># Fix a[0] as 1</span>
    s[a[<span style="color: #666666">0</span>]] <span style="color: #666666">=</span> <span style="color: #666666">1</span>
    X <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> x: sm<span style="color: #666666">.</span>simplify(<span style="color: #008000">sum</span>(s[a[i]]<span style="color: #666666">*</span>x<span style="color: #666666">**</span>i <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">4</span>)))
    u <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> x, t: X(x)<span style="color: #666666">*</span>T(t)
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;u:&#39;</span>, u(x,t)
</pre></div>
<p>
The next step is to find the source term <code>f_e</code> by inserting <code>u_e</code>
in the PDE. Thereafter, turn <code>u</code>, <code>f</code>, and the time derivative of <code>u</code>
into plain Python functions as in a), and then wrap these functions
in new functions <code>I</code>, <code>V</code>, and <code>f</code>, with the right signature as
required by the <code>solver</code> function. Set parameters as in a) and
check that the solution is exact to machine precision at each
time level using an appropriate <code>user_action</code> function.

<p>
Filename: <code>wave1D_n0_test_cubic</code>.

<p>
<!-- --- end exercise --- -->

<p>
<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">
  <li class="previous">
    <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html">&larr; Prev</a>
  </li>
  <li class="next">
    <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html">Next &rarr;</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


<center style="font-size:80%">
<!-- copyright only on the titlepage -->
</center>


</body>
</html>
    

